<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Feed for Fight With Tools - Aram&#39;s Dev Blog</title>
	<atom:link href="https://fightwithtools.dev/feed.xml" rel="self" type="application/rss+xml" />
	<link>https://fightwithtools.dev/</link>
	<description></description>
	<lastBuildDate>Wed, 23 Jun 2021 14:14:16 GMT</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://11ty.dev/</generator>
	<managingEditor>
		aramdevblog@aramzs.me (Aram Zucker-Scharff)
	</managingEditor>
	
	<item>
		<title>Hello World Devblog - Pt. 1</title>
		<link>https://fightwithtools.dev/posts/hello-day-1/?source=rss</link>
		<pubDate>Wed, 23 Jun 2021 14:14:04 GMT</pubDate>
		<dc:creator>Aram Zucker-Scharff</dc:creator>
		<guid isPermaLink="true">https://fightwithtools.dev/posts/hello-day-1/</guid>
		<description></description>
		<content:encoded><![CDATA[<h1>Day 1</h1>
<p>I have decided I want a blog to write down some of my decisions as I build various public projects. So, inital requirements:</p>
<ol>
<li>Static Site Generator that can build the blog and let me host it on Github Pages</li>
<li>I want to write posts in Markdown because I'm lazy, it's easy, and it is how I take notes now.</li>
<li>I don't want to spend a ton of time doing design work. I'm doing complicated designs for other projects, so I want to pull a theme I like that I can rely on someone else to keep up.</li>
<li>Once it gets going, I want template changes to be easy.</li>
<li>It should be as easy as Jekyll, so I need to be able to build it using GitHub Actions, where I can just commit a template change or Markdown file and away it goes. If I can't figure this out than fk it, just use Jekyll.</li>
</ol>
<p>So, after being completly put off by the Hugo quickstart page, I decided to go to 11ty. I'd been using 11ty for a very basic build process on another project, so I wanted to see what it would be like for a more complex blog. Everyone I know seems to love 11ty so if I complain about it on Twitter someone will likely give me an answer. This is a requirement I only just realized:</p>
<ol start="6">
<li>I require it to be used by a significant percent of my professional peers so I can get easy answers when something goes wrong.</li>
</ol>
<p>Ok. 11ty it is.</p>
<p>Ok, first things first. New folder. <code>git init</code>.</p>
<p>Oh, it starts new projects with the <code>master</code> branch? I don't like that, I like using <code>main</code>. I can checkout main and delete master right?</p>
<p>Huh... if you don't have anything committed to any branch and you checkout a new branch the <code>master</code> branch ceases to exist. Cool. I guess I don't need to do <a href="https://www.git-tower.com/learn/git/faq/git-rename-master-to-main/" target="_blank">this</a>.</p>
<p>Wait... does 11ty work with GitHub Actions to build? I have no idea. <a href="https://www.linkedin.com/pulse/eleventy-github-pages-lea-tortay/" target="_blank">Looks like yes</a>... let's move forward.</p>
<p><code>npm init -y</code></p>
<p><code>npm install --save-dev @11ty/eleventy</code></p>
<p>Here we go with 11ty! Only...</p>
<p>All the pre-built... ughhh &quot;Themes&quot; or &quot;Starters&quot; (I can't say template here, because searching for &quot;11ty templates&quot;, while a logical thing to do, just gives me a ton of pages about using Nunjucks) suck. They all suck hardcore. I mean, they're all single page sites with no clear navigation or nav bar and look barely worked out beyond the Bootstrap Starter Template phase. I can't stand any of them. Is there a secret location for good 11ty themes or is it just that the type of folks most likely to use 11ty lack design skills?</p>
<p>But... I really like the Jekyll dinky theme. All I really need is the CSS and I can pull a copy of its template into whatever. Easy enough in theory (never in practice).</p>
<p>I'm going to pull it in as a submodule. I forgot how to do submodules. <a href="https://github.blog/2016-02-01-working-with-submodules/" target="_blank">Here we go</a>.</p>
<p><code>git submodule add git@github.com:pages-themes/dinky.git</code></p>
<p><code>git submodule update --init --recursive</code></p>
<p>Alright, what have we got here.</p>
<p>Sass. We've got Sass. That's going to need to be figured out.</p>
<p>Let's go to the 11ty plugins and see what, if anything, can help me here.</p>
<p>Oh and let's grab some cool looking ones.</p>
<p><code>npm install @11ty/eleventy-img</code></p>
<p>Huh, some funkyness on the install... because I forgot that, for various complicated reasons, my Node install defaults to 8.*.</p>
<p>Ok. Create the <code>.nvmrc</code> file and what's the latest version of node these days? Put <code>16</code> in it.</p>
<p>Reboot my console so I take advantage of <a href="https://gist.github.com/AramZS/fda9c04a38908789dccdf78bb94e2b45" target="_blank">the nifty nvm auto-load ZSH script</a>.</p>
<p>Dump package-lock, dump node_modules, <code>npm install</code> again.</p>
<p>Plugin install works now.</p>
<p><code>npm install @11ty/eleventy-plugin-syntaxhighlight --save-dev</code><br />
<code>npm install @11ty/eleventy-navigation --save-dev</code><br />
<code>npm install @11ty/eleventy-plugin-rss --save-dev</code></p>
<p><code>npm install eleventy-plugin-sass --save </code></p>
<p>Ok, that didn't work. And the whole point of looking at plugins was a SASS processor integrated into the 11ty build process. Not great. What's wrong?</p>
<p>Looks like something with <code>node-gyp</code>. Frequently a problem.</p>
<p>Let's check <code>node-gyp</code>.</p>
<p>Ok, a whole thing for problems from an upgrade.</p>
<p>Let's do all of <a href="https://github.com/nodejs/node-gyp/blob/master/macOS_Catalina.md" target="_blank">that</a>. XCode needed an update and for some reason updating to Catalina also wiped out my XCode CLI tools... didn't realize that. Reinstall those:</p>
<p><code>xcode-select --install</code></p>
<p>Ok, cool. Moving on...</p>
<p>Oh, I am looking at the configuration options for <code>gulp-sass</code> which get passed into the 11ty plugin and looks like <code>gulp-sass</code> is depreciated. So this plugin is not one I want to use. And it looks like there isn't an up to date Sass plugin.</p>
<p>lol.</p>
<p>So, let's assume I'm going to have to write my own plugin. I know nothing about 11ty plugins. Find a real basic one and use that as the template to start a new one.</p>
<p>This <a href="https://www.npmjs.com/package/eleventy-plugin-meta-generator" target="_blank">one</a> looks pretty simple! So I'm going to keep that tab open for reference as I build out a Sass processor.</p>
<p>[ ] Also <a href="https://www.npmjs.com/package/@quasibit/eleventy-plugin-sitemap" target="_blank">the sitemap plugin</a> looks cool. Should grab that later.</p>
<p>[ ] So does the <a href="https://www.npmjs.com/package/eleventy-plugin-reading-time" target="_blank">reading time one</a>.</p>
<p>I also saw <a href="https://www.npmjs.com/package/eleventy-load" target="_blank">a Loader plugin</a>... but it looks way more complicated than I need while also <em>not doing what I need</em>, so mark it, move on. Might have something in its code that's useful for later.</p>
<p>[ ] Also <a href="https://github.com/jdsteinbach/eleventy-plugin-toc/blob/master/src/BuildTOC.js" target="_blank">this TOC plugin</a> mby?</p>
<p>Ok, back to Sass. Now, I don't want to fk around with building a whole NPM module for this right now, so let's start with the plugin internal to the project.</p>
<p>There does not seem to be a standard pattern for these like there is for layouts, data, etc... so I'm going to imitate the <code>_{thing}</code> pattern and make a <code>_custom-plugins</code> folder. Maybe someday someone will read this and tell me this is a dumb pattern. Put it in there. Node module structure, <code>index.js</code> at the base, <code>src</code> folder with the files that actually do stuff.</p>
<p>Ok let's get Sass in here. I want the Javascript library, so read through docs <a href="https://sass-lang.com/dart-sass" target="_blank">at their site</a>.</p>
<p><code>npm install sass --save-dev</code><br />
<code>npm install fiber --save-dev</code></p>
<p>That 2nd one didn't work... cool, what is Fiber... let's <a href="https://github.com/laverdet/node-fibers" target="_blank">read about it</a>.</p>
<blockquote>
<p>Update [April 13th, 2021] -- Fibers is not compatible with nodejs v16.0.0 or later. Unfortunately, v8 commit dacc2fee0f is a breaking change and workarounds are non-trivial.</p>
</blockquote>
<p><em>sigh</em></p>
<p>Ok, using latest version of Node, clearly a bad choice.</p>
<p><code>.nvmrc</code> changed to <code>15</code>. I like 15, I've used 15 for other stuff. Hopefully no problem.</p>
<p>You know... reading node-fiber's documentation... I... don't actually need it anyway. I want <code>renderSync</code>, to block the build process of 11ty until the right assets are done.</p>
<p>Whatever... never use latest Node... it always causes problems. I have encountered this time and time again. Clear out package-lock and node_modules.</p>
<p><code>npm install</code></p>
<p>Ok at this point my process has already become more muddled then I'm comfortable with. Better start documenting it actually. Oh wait, this is a dev blog, I should start documenting it AS A BLOG POST.</p>
<p>I forgot the pattern for 11ty posts' folders in a project. <a href="https://github.com/11ty/eleventy-base-blog/tree/master/posts" target="_blank">Here it is</a>.</p>
<p>Started this file.</p>
<p>Forgot the number of dashes for the metadata format for markdown that 11ty likes because it is not 8:30pm and I have not yet had dinner. I was reading about some feature that mentioned it in the context of merging data from templates with markdown files, I should likely note that.</p>
<p>[ ] Use <a href="https://www.11ty.dev/docs/data-deep-merge/" target="_blank">Data Deep Merge</a> in this blog.</p>
<p>Ok now:</p>
<p>[x] Write everything down that I've done to this point before it zeroes out of my head.</p>
<p>God bless CLI and browser history.</p>
<p>Ok, back to the Sass plugin. And also: this would be a good time to do a commit huh?</p>
<p><code>git commit -am &quot;a real 11ty blog... I don't know wtf I'm doing to make this work yet&quot;</code></p>
<p>Ok, <code>dart-sass</code>. I don't know what any of these listed options are...</p>
<p>Annoying, since they are emulating the <code>node-sass</code> API, it's just a link to the <code>node-sass</code> README documentation. Ok, taking a look.</p>
<ol start="7">
<li>I want source maps. This is a dev log site which means whatever I do with it should be easy for other developers to read.</li>
</ol>
<p>I also would like to have smart CSS, where it only loads the CSS files it needs for a template, so we'd have a main CSS file and then per-template CSS files? That would be cool. Or maybe <a href="https://github.com/addyosmani/critical#usage" target="_blank">this thing</a>? You know what... table that... let's just render the damn CSS first.</p>
<p>[ ] Decide if I want to render the CSS fancier than just a base file.</p>
<p>Huh... a thought... can I just run any arbitrary function in 11ty as part of the build?</p>
<p><a href="https://www.11ty.dev/docs/data-js/" target="_blank">Looks like</a> the <code>_data</code> folder can contain functions that output arbitrary files?</p>
<p>Should I do that? I mean... I likely could... but it isn't elegant, it isn't the <em>right</em> way. Skip it.</p>
<p>Ok, set it up with the most basic Sass build rules. Let's hold there, I'm going to want to try it out, but first, let's make sure the normal 11ty build works.</p>
<p>Ok, to do that I need a layout in place. Get it in <a href="https://github.com/11ty/eleventy-base-blog/tree/master/_includes/layouts" target="_blank">the right place</a>.</p>
<p>To make sure my CSS works properly, I should prob set up the dinky layout here. <code>dinky/_layouts</code>. Ok... only one file, easy enough. And the template syntax looks basically identical. Copy it and paste it into the <code>_includes/layouts</code> folder and rename it to <code>default.njk</code>.</p>
<p>NOTE: I'm pretty sure that Nunjucks can process HTML files. Do I want to just add a 11ty alias to just pull default.html from dinky in the style of <code>eleventyConfig.addLayoutAlias(&quot;base&quot;, &quot;dinky/_layouts/default.html&quot;);</code>? Would that work? Put a pin in that:</p>
<p>[ ] Can I use the template inside of dinky that already exists instead of copy/pasting it?</p>
<p>Pull the .eleventy.js return from the <a href="https://github.com/11ty/eleventy-base-blog/blob/master/.eleventy.js" target="_blank">base blog</a> and change output to <code>docs</code> for Github Pages...</p>
<pre class="language-javascript"><code class="language-javascript">		dir<span class="token operator">:</span> <span class="token punctuation">{</span><br />			input<span class="token operator">:</span> <span class="token string">"."</span><span class="token punctuation">,</span><br />			includes<span class="token operator">:</span> <span class="token string">"_includes"</span><span class="token punctuation">,</span><br />			data<span class="token operator">:</span> <span class="token string">"_data"</span><span class="token punctuation">,</span><br />			output<span class="token operator">:</span> <span class="token string">"docs"</span><span class="token punctuation">,</span><br />		<span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre>
<p>Wait... it's pulling njk files from the base of the project? Mixing project files with build configuration files? That's HOT NONSENSE. I did that last time, but it was becaause I wanted to build some real basic pages and only a few of them. Not good for a larger project IMO. Create an <code>src</code> folder.</p>
<p><code>input: &quot;src&quot;,</code></p>
<p>Crap... what of these folders do I need to move in? I guess <code>posts</code>? That is likely it. I'll find out later!</p>
<p>Ok, theoretically should be able to make a build. Moment of truth.</p>
<p><code>npx @11ty/eleventy</code></p>
<p>It did not pick up the template</p>
<p>Let's try altering the .eleventy.js returned data to include, and I'll move the folder accordingly:</p>
<p><code>layouts: &quot;_layouts&quot;,</code></p>
<p>Still didn't pick it up.</p>
<p>Ok, gotta play around, but good time to commit</p>
<p><code>git commit -am &quot;First render, didn't work&quot;</code></p>
<p>Time to take a break for dinner.</p>
]]></content:encoded>
	</item>
	
	<item>
		<title>Hello World Devblog - Pt. 2</title>
		<link>https://fightwithtools.dev/posts/hello-day-2/?source=rss</link>
		<pubDate>Wed, 23 Jun 2021 14:14:04 GMT</pubDate>
		<dc:creator>Aram Zucker-Scharff</dc:creator>
		<guid isPermaLink="true">https://fightwithtools.dev/posts/hello-day-2/</guid>
		<description></description>
		<content:encoded><![CDATA[<h1>Day 2</h1>
<p>Ok, day 2. Let's restate the requirements and todos!</p>
<ol>
<li>Static Site Generator that can build the blog and let me host it on Github Pages</li>
<li>I want to write posts in Markdown because I'm lazy, it's easy, and it is how I take notes now.</li>
<li>I don't want to spend a ton of time doing design work. I'm doing complicated designs for other projects, so I want to pull a theme I like that I can rely on someone else to keep up.</li>
<li>Once it gets going, I want template changes to be easy.</li>
<li>It should be as easy as Jekyll, so I need to be able to build it using GitHub Actions, where I can just commit a template change or Markdown file and away it goes. If I can't figure this out than fk it, just use Jekyll.</li>
<li>I require it to be used by a significant percent of my professional peers so I can get easy answers when something goes wrong.</li>
<li>I want source maps. This is a dev log site which means whatever I do with it should be easy for other developers to read.</li>
</ol>
<p>[ ] Also <a href="https://www.npmjs.com/package/@quasibit/eleventy-plugin-sitemap" target="_blank">the sitemap plugin</a> looks cool. Should grab that later.</p>
<p>[ ] So does the <a href="https://www.npmjs.com/package/eleventy-plugin-reading-time" target="_blank">reading time one</a>.</p>
<p>[ ] Also <a href="https://github.com/jdsteinbach/eleventy-plugin-toc/blob/master/src/BuildTOC.js" target="_blank">this TOC plugin</a> mby?</p>
<p>[ ] Use <a href="https://www.11ty.dev/docs/data-deep-merge/" target="_blank">Data Deep Merge</a> in this blog.</p>
<p>[ ] Decide if I want to render the CSS fancier than just a base file.</p>
<p>[ ] Can I use the template inside of dinky that already exists instead of copy/pasting it?</p>
<p>Ok, so why isn't it picking up the layout from either <code>_layouts/post.njk</code> or <code>_layouts/default.njk</code>? Maybe I need to define a default <a href="https://www.11ty.dev/docs/data-template-dir/" target="_blank">at the data level</a>? Or do I need to move it to <code>src</code> even if I define the location in the returned configuration?</p>
<p>Moving it into <code>src</code> doesn't seem to do anything. But it looks like all the files I configure into 11ty in the returned object do need to be in there, so apparently I can't set a default layout in the <code>data</code> folder?</p>
<p>Adding a template to <code>src/posts/posts.json</code></p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span> <span class="token property">"layout"</span><span class="token operator">:</span> <span class="token string">"layouts/post.njk"</span> <span class="token punctuation">}</span></code></pre>
<p>Ok, yay, an error!</p>
<p><code>Error Youâ€™re trying to use a layout that does not exist layouts/post.njk (undefined)</code></p>
<p>Because I defined a path to layouts in the config, I don't need to include it?</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span> <span class="token property">"layout"</span><span class="token operator">:</span> <span class="token string">"post.njk"</span> <span class="token punctuation">}</span></code></pre>
<p>Yup, now I have an error in the template!</p>
<p>Ok, looks like I can't use this structure:</p>
<p><code>{{ site.lang | default: &quot;en-US&quot; }}&quot;</code></p>
<p>So, default values, how should I do them? It <a href="https://www.11ty.dev/docs/data-cascade/" target="_blank">looks like</a> the answer is to define it as <a href="https://www.11ty.dev/docs/data-global/" target="_blank">a data global</a>. Ok let's try it, place the default in <code>src/_data/site.json</code>.</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br />	<span class="token property">"lang"</span><span class="token operator">:</span> <span class="token string">"en-US"</span><br /><span class="token punctuation">}</span></code></pre>
<p>Huh... render error on <em>this</em> file:</p>
<p><code>TemplateContentRenderError ... expected variable end</code></p>
<p>Going to remove <code>{% seo %}</code> from the template. I assume it is a template fragment without looking it up but I'm not prepared to figure it out. Still no solve. Good time to commit!</p>
<p><code>git commit -am &quot;Template still not working but getting closer&quot;</code></p>
<p>Ok, let's start stripping out stuff from the template. The error indicates the problem is in my markdown, but that doesn't make sense, so simpler template. Ok, first, I want the dinky assets folder so it works properly in the template. There are <a href="https://www.11ty.dev/docs/copy/#change-the-output-directory" target="_blank">more ways to configure the passthrough rules</a> to make this work for me.</p>
<p><code>eleventyConfig.addPassthroughCopy({ &quot;dinky/assets&quot;: &quot;assets&quot; });</code></p>
<p>Ok, passthrough works! But the template still won't render. The error is still in my markdown! At <code>[Line 49, Column 67]</code>. What is going on?! That line is empty, it doesn't have columns.</p>
<p>Wait... the line number is likely being calculated after the metadata is removed from the head of the <code>md</code> file. Ok... my metadata takes up 10 lines so it is really line <em>59</em>. Oh! It's a code sample <em>from</em> the template. It's trying to render an njk variable from the markdown file?! That's very dumb.</p>
<p>To Google! &quot;njk picking up code sample of njk code&quot; &gt; <a href="https://github.com/11ty/eleventy/issues/791" target="_blank">result</a>.</p>
<p>Raw tag huh? How does that work exactly? Oh... like <a href="https://github.com/11ty/11ty-website/blob/master/src/docs/languages/nunjucks.md" target="_blank">this</a>.</p>
<p>Ok, works both for blocks and inline, good!</p>
<p>Ok, defaults for posts <em>have</em> to be in the <code>posts</code> folder's <code>posts.json</code>. I cannot seem to set any defaults for posts in the <code>_data</code> folder. Or at least I haven't figured out how. But ok, things are rendering now in the right template. Also the assets are being passed out of the <code>dinky</code> submodule! This is good. The process works, so now I can start to build in my weirdness.</p>
<p>I still really want to figure out the defaults thing first. How do I make this work?</p>
<p>Ok, <a href="https://github.com/11ty/eleventy/issues/380#issuecomment-568033456" target="_blank">here we go</a>.</p>
<p>So to get a default <code>description</code> value in my template I can set it up with a file at <code>src/_data/description.js</code> and have the content of that file be <code>module.exports = &quot;Talking about code&quot;;</code>. Ok, that works!</p>
<p>Yay, 11ty defaults work now! Good place to commit.</p>
<p><code>git commit -am &quot;Ok, renders and defaults are working now&quot;</code></p>
<p>Hmmm... ok I guess that I picked a bad example plugin, because the one I used <a href="https://www.npmjs.com/package/eleventy-plugin-meta-generator#usage" target="_blank">doesn't have a typical footprint</a>. Well, I'm not going to have a typical footprint I guess. Let's start without that. It runs sync, so I can just call the function during setup mby? Just add <code>sassBuild();</code> to the inside of my .eleventy.js function inside of <code>module.exports = function (eleventyConfig) {</code>?</p>
<p>Ok... renderSync from <code>dart-sass</code> threw an error:</p>
<pre class="language-bash"><code class="language-bash">Receiver: Closure <span class="token string">'_renderSync'</span><br />Arguments: <span class="token punctuation">[</span>Instance of <span class="token string">'PlainJavaScriptObject'</span>, Instance of <span class="token string">'JavaScriptFunction'</span><span class="token punctuation">]</span><br /><br />`` was thrown:<br />    NoSuchMethodError: method not found: <span class="token string">'call'</span></code></pre>
<p>Lol <a href="https://github.com/sass/dart-sass/issues/23#issuecomment-259011350" target="_blank">documentation error in dart-sass</a> apparently. Don't pass two functions, because that's an async pattern, instead return the result.</p>
<p>Cool. New error!</p>
<p><code>Invalid argument(s): Either options.data or options.file must be set.</code></p>
<p>Can I not use multiple files? I guess I need a single file that calls the others <a href="https://sass-lang.com/documentation/at-rules/use" target="_blank">using @use</a>. Last time I used Sass it was @import, but according to docs, that method is out now. Good to know!</p>
<p>Oh, gotta remember paths are relative to execution, so I have to set up paths in both the Sass plugin AND the <code>@use</code> relative to the base of the project, where I'm executing the 11ty build process.</p>
<p>Still no css file.</p>
<p>Oh, <a href="https://sass-lang.com/documentation/js-api#outfile" target="_blank">lol</a></p>
<blockquote>
<p>Despite the name, Sass does not write the CSS output to this file. The caller must do that themselves.</p>
</blockquote>
<p>Ok, gotta do that.</p>
<p>Ok, I want to use <code>fs</code> to write the resulting file into <code>docs/styles/styles.css</code>. Only, the <code>styles</code> directory does not predictably exist so <code>fs</code> fails because I have to make that folder. Of course, forgot. Easy enough.</p>
<p>Ok, it works! This is a good place to stop because it is almost midnight.</p>
<p><code>git commit -am &quot;Compile that sass&quot;</code></p>
<p>And this is pretty far along, huh? Time to push it to Github.</p>
]]></content:encoded>
	</item>
	
	<item>
		<title>Hello World Devblog - Pt. 3</title>
		<link>https://fightwithtools.dev/posts/hello-day-3/?source=rss</link>
		<pubDate>Wed, 23 Jun 2021 14:14:04 GMT</pubDate>
		<dc:creator>Aram Zucker-Scharff</dc:creator>
		<guid isPermaLink="true">https://fightwithtools.dev/posts/hello-day-3/</guid>
		<description></description>
		<content:encoded><![CDATA[<ol>
<li>Static Site Generator that can build the blog and let me host it on Github Pages</li>
<li>I want to write posts in Markdown because I'm lazy, it's easy, and it is how I take notes now.</li>
<li>I don't want to spend a ton of time doing design work. I'm doing complicated designs for other projects, so I want to pull a theme I like that I can rely on someone else to keep up.</li>
<li>Once it gets going, I want template changes to be easy.</li>
<li>It should be as easy as Jekyll, so I need to be able to build it using GitHub Actions, where I can just commit a template change or Markdown file and away it goes. If I can't figure this out than fk it, just use Jekyll.</li>
<li>I require it to be used by a significant percent of my professional peers so I can get easy answers when something goes wrong.</li>
<li>I want source maps. This is a dev log site which means whatever I do with it should be easy for other developers to read.</li>
</ol>
<p>[ ] Also <a href="https://www.npmjs.com/package/@quasibit/eleventy-plugin-sitemap" target="_blank">the sitemap plugin</a> looks cool. Should grab that later.</p>
<p>[ ] So does the <a href="https://www.npmjs.com/package/eleventy-plugin-reading-time" target="_blank">reading time one</a>.</p>
<p>[ ] Also <a href="https://github.com/jdsteinbach/eleventy-plugin-toc/blob/master/src/BuildTOC.js" target="_blank">this TOC plugin</a> mby?</p>
<p>[ ] Use <a href="https://www.11ty.dev/docs/data-deep-merge/" target="_blank">Data Deep Merge</a> in this blog.</p>
<p>[ ] Decide if I want to render the CSS fancier than just a base file and do per-template splitting.</p>
<p>[ ] Can I use the template inside of dinky that already exists instead of copy/pasting it?</p>
<h2>Day 3</h2>
<p>Ok, so I'm at day 3 and everything is working at a basic level. I need an index/entry page and some ways to present posts in lists. I also am not a huge fan of the <code>site/posts/post-name</code> structure.</p>
<p>[ ] Is there a way to have permalinks to posts contain metadata without organizing them into subfolders?</p>
<p>There's also an open question of Why Nunjucks? I'm not the biggest fan of Nunjucks, outside of the 11ty community that seems to be heavily invested into it, not many people seem to be using it. Documentation is (as we've already seen) sorta iffy and its relatively low adoption makes it harder to get questions answered.</p>
<p>I also haven't quite gotten syntax highlighting to work for <code>njk</code> files in VS Code, which is <em>very</em> frustrating and often turns me off from using something.</p>
<p>I could, at this point, switch to Mustache, which I'm <a href="https://glitch.com/edit/#!/thespin?path=server.js" target="_blank">already pretty familiar</a> with. Mustache also has the advantage of having template tags that are more similar to Jekyll and more familiar to Javascript users. But, unless I hit a real bad obstacle I don't think I will, for two reasons. First, the point of this is to learn something new! Second, when I last tried 11ty to basically generate a few quick pages from a common template, it had terrible trouble rendering with Mustache, even with the instructions from their site. I've got other things to complicate first, can save that for later. If I get everything working, I might come back to this issue.</p>
<p>Ok, <a href="https://marketplace.visualstudio.com/items?itemName=ronnidc.nunjucks" target="_blank">got Nunjucks syntax highlighting to properly work</a> for now!</p>
<p>Stepping back it looks like the rendered site in the <code>docs</code> folder is generally looking ok. There's one issue, my passthrough of assets includes an <code>assets/css</code> folder with an entirely useless sass file that would be public-facing. So I'm going to have to do subdirectories of assets instead. Should be easy enough.</p>
<p>Huh... it doesn't clean up the now defunct <code>css</code> folder. Is there a build tool to clean things up?</p>
<p><a href="https://github.com/11ty/eleventy/issues/19" target="_blank">Looks like it doesn't ship with 11ty</a>. But there <a href="https://github.com/11ty/eleventy/issues/744" target="_blank">are other solutions that people have done</a>.</p>
<p>I like <a href="https://github.com/11ty/eleventy/issues/744#issuecomment-800323968" target="_blank">the solution that defines the site configuration earlier</a>, it seems generally useful. I'll give it a try.</p>
<p>That works! Deleting the whole folder and building it all new seems super inefficient, but there doesn't seem to be another way to handle things.</p>
<p>One other throught now occurs. I saw that the dinky template uses some sort of build version number passed by github on build to cachebreak. I'm not sure how that works or if it can work the same way for 11ty. Perhaps I need to pass a datetime stamp for each build instead? Something to figure out later.</p>
<p>[ ] How do I cachebreak files on the basis of new build events? Datetime? <code>site.github.build_revision</code> is how Jekyll accomplishes this, but is there a way to push that into the build process for 11ty?</p>
<p><code>git commit -am &quot;Self-cleaning builds&quot;</code></p>
<p>11ty build is now stable enough that I might be able to develop with <code>npx @11ty/eleventy --serve</code> and check in on it. Let's see what it looks like.</p>
<p>Gotta adjust my CSS output path to match the template file's.</p>
<p>Ok, content is rendering as escaped HTML. That's not right at all.</p>
<p>Ahhh, apparently (here we are at poorly documented Nunjucks again...) my content tag needs to be <code>{{ content | safe }}</code>.</p>
<p>Ok, it's working now! Good signs! Hmmm. I was hoping that 1-space empty brackets would be rendered as a checkbox, as in Github-flavored markdown. But apparently not. How difficult would that be to fix?</p>
<p>Hmmm also some other problems:</p>
<p>[ ] Make link text look less shitty. It looks like it is a whole, lighter, font.<br />
[ ] Code blocks do not have good syntax highlighting. I want good syntax highlighting.</p>
<p>I <a href="https://github.com/AramZS/aramzs.github.io/blob/master/_sass/_syntax-highlighting.scss" target="_blank">have syntax highlighting styles</a> I like on my Github user Pages site. Let's just reuse it.</p>
<p>Huh... why doesn't the plugin for building Sass re-trigger on watch? <a href="https://www.11ty.dev/docs/events/#beforewatch" target="_blank">Looks like there's a way to fix that</a>.</p>
<p>Ugh... apparently the Sass syntax has changed significantly since the last time I used it and also since it was set up in my other site. I'll need to correct.</p>
<p><em>sigh</em></p>
<p>Ok <a href="https://stackoverflow.com/questions/56858150/i-am-gettiing-an-error-expected-new-line-while-compiling-sass" target="_blank">it's changed a lot</a>. And the Sass build tools are dickishly specific about spaces over tabs. Need to add a new section to my <code>.editorconfig</code>.</p>
<pre><code>
[*.sass]
indent_style = space

</code></pre>
<p>Ok, I tried building the extendable <a href="https://sass-lang.com/documentation/style-rules/placeholder-selectors" target="_blank">placeholder</a> into a standalone Sass file and a standalone Scss file and <a href="https://sass-lang.com/documentation/at-rules/extend#placeholder-selectors" target="_blank">it looks right</a>. But <code>@extend %vertical-rhythm</code> still isn't working.</p>
<p>My ordering looks correct!</p>
<pre class="language-sass"><code class="language-sass"><span class="token atrule-line"><span class="token atrule">@use</span> '_sass/base-syntax-highlighting'</span><br /><span class="token atrule-line"><span class="token atrule">@use</span> '_sass/syntax-highlighting'</span></code></pre>
<p>What's going on?</p>
<p>First error is a depreciation error. It <em>shouldn't</em> be a problem, but let's just get rid of it.</p>
<pre class="language-bash"><code class="language-bash">DEPRECATION WARNING: Using / <span class="token keyword">for</span> division is deprecated and will be removed <span class="token keyword">in</span> Dart Sass <span class="token number">2.0</span>.0.<br /><br />Recommendation: math.div<span class="token punctuation">(</span><span class="token variable">$spacing</span>-unit, <span class="token number">2</span><span class="token punctuation">)</span><br /><br />More info and automated migrator: https://sass-lang.com/d/slash-div</code></pre>
<p>Alrighty. <a href="https://sass-lang.com/documentation/breaking-changes/slash-div" target="_blank">Go to the docs and do what it says</a>. Side comment... this is dumb. Why is it <em>easier</em> to do this type of math with standard CSS (where it would be <code>calc()</code>) than it is with Sass. Why is Sass harder to use now than it was when I got deep into it years ago? Grrrrr.</p>
<p>OMG why does this documentation start off with <code>// Future Sass, doesn't work yet!</code>?!?! Why would you start off a documentation file with a suggested solution that <strong>doesn't work</strong>?!</p>
<p>Ok. Down to one error. Still not importing the placeholder, why not?</p>
<p>Oh no. This is <a href="https://github.com/sass/dart-sass/issues/1042#issuecomment-656338728" target="_blank">A Problem</a>. Apparently the move to @use has not synced well with the old ways of using mixins, imports and placeholders?</p>
<p>The answer seems to be that you can't have a master file import a variables and expect them to be picked up by downstream files <code>@use</code>ed by that master file, instead you have to import them directly into the file you inted to use? I could have sworn that worked differently before? That isn't how it seems to work in my Jekyll site, perhaps there is a better way to do this?</p>
<p>[ ] Why is the logic around <code>@use</code> not working how I expect it to? Is there a better way?</p>
<p>Ok, I'm... not sure the styles are applying. Let's replicate a markdown block from my other site and see if it looks good.</p>
<pre class="language-markdown"><code class="language-markdown"><span class="token frontmatter"><span class="token punctuation">---</span><br /><span class="token key atrule">layout</span><span class="token punctuation">:</span> page<br /><span class="token punctuation">---</span></span></code></pre>
<p>It doesn't look good, but looking at the HTML markup... it looks like the problem is 11ty's processing and output of the actual markup.</p>
<p>:/</p>
<p>What does Jekyll use?</p>
<blockquote>
<p>Confusingly, GitHub Pages renders Markdown differently than GitHub does. GitHub uses its own Markdown processor; GitHub Pages uses jekyll-commonmark.</p>
</blockquote>
<p>lol <a href="https://www.markdownguide.org/tools/github-pages/" target="_blank">thanks</a>.</p>
<p>Looks like <a href="https://www.npmjs.com/package/markdown-it" target="_blank">Markdown-It</a> is <a href="https://www.11ty.dev/docs/languages/markdown/" target="_blank">a popular choice</a> on 11ty to switch to commonmark.</p>
<p>Oh no, <a href="https://www.npmjs.com/package/markdown-it#syntax-highlighting" target="_blank">it doesn't ship with syntax highlighting</a>.</p>
<p>Ok, <code>highlight.js</code> is still not applying good tags. Is it an 11ty issue, or is it that I need to use Pygments, which is apparently the code syntax highlighting engine that Github Pages uses? Ok, how does that work in Node? There <a href="https://www.npmjs.com/package/pygments" target="_blank">is a package, let's read up</a>!</p>
<p>I am concerned that it hasn't been update in 5 years. You know what? let's try <a href="https://highlightjs.org/" target="_blank">https://highlightjs.org/</a> and see if I can force it to build better styles.</p>
<p>Oh no... white text on bright red background. This is a bad sign.</p>
<p>Ok, this looks like it actually should work ok though, what is going on? I'm going to add some <code>console.log</code> statements.</p>
<pre class="language-javascript"><code class="language-javascript">	<span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><br />		html<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br />		breaks<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br />		linkify<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br />		langPrefix<span class="token operator">:</span> <span class="token string">"language-"</span><span class="token punctuation">,</span><br />		<span class="token function-variable function">highlight</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">str<span class="token punctuation">,</span> lang</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br />			<span class="token keyword">if</span> <span class="token punctuation">(</span>lang <span class="token operator">&amp;&amp;</span> hljs<span class="token punctuation">.</span><span class="token function">getLanguage</span><span class="token punctuation">(</span>lang<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br />				<span class="token keyword">try</span> <span class="token punctuation">{</span><br />					console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Syntax highlight good"</span><span class="token punctuation">,</span> lang<span class="token punctuation">)</span><span class="token punctuation">;</span><br />					<span class="token keyword">return</span> hljs<span class="token punctuation">.</span><span class="token function">highlight</span><span class="token punctuation">(</span>lang<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span><br />				<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>__<span class="token punctuation">)</span> <span class="token punctuation">{</span><br />					console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Syntax highlight fail"</span><span class="token punctuation">,</span> lang<span class="token punctuation">)</span><span class="token punctuation">;</span><br />				<span class="token punctuation">}</span><br />			<span class="token punctuation">}</span><br /><br />			<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span> <span class="token comment">// use external default escaping</span><br />		<span class="token punctuation">}</span><span class="token punctuation">,</span><br />	<span class="token punctuation">}</span><span class="token punctuation">;</span><br />	eleventyConfig<span class="token punctuation">.</span><span class="token function">setLibrary</span><span class="token punctuation">(</span><span class="token string">"md"</span><span class="token punctuation">,</span> <span class="token function">markdownIt</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />	eleventyConfig<span class="token punctuation">.</span><span class="token function">setLibrary</span><span class="token punctuation">(</span><span class="token string">"markdown"</span><span class="token punctuation">,</span> <span class="token function">markdownIt</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Ok, they aren't triggering. No logging, this isn't working.</p>
<p>The eleventy website has good syntax highlighting. <a href="https://github.com/11ty/11ty-website/blob/master/.eleventy.js" target="_blank">How are they doing it</a>?</p>
<p>Ok, there's a lot going on there and I need a break. Break time.</p>
<p><code>git commit -am &quot;Trying to get better syntax highlighting&quot; </code></p>
]]></content:encoded>
	</item>
	
	<item>
		<title>Hello World Devblog - Pt. 4</title>
		<link>https://fightwithtools.dev/posts/hello-day-4/?source=rss</link>
		<pubDate>Wed, 23 Jun 2021 14:14:04 GMT</pubDate>
		<dc:creator>Aram Zucker-Scharff</dc:creator>
		<guid isPermaLink="true">https://fightwithtools.dev/posts/hello-day-4/</guid>
		<description></description>
		<content:encoded><![CDATA[<ol>
<li>Static Site Generator that can build the blog and let me host it on Github Pages</li>
<li>I want to write posts in Markdown because I'm lazy, it's easy, and it is how I take notes now.</li>
<li>I don't want to spend a ton of time doing design work. I'm doing complicated designs for other projects, so I want to pull a theme I like that I can rely on someone else to keep up.</li>
<li>Once it gets going, I want template changes to be easy.</li>
<li>It should be as easy as Jekyll, so I need to be able to build it using GitHub Actions, where I can just commit a template change or Markdown file and away it goes. If I can't figure this out than fk it, just use Jekyll.</li>
<li>I require it to be used by a significant percent of my professional peers so I can get easy answers when something goes wrong.</li>
<li>I want source maps. This is a dev log site which means whatever I do with it should be easy for other developers to read.</li>
</ol>
<p>[ ] Also <a href="https://www.npmjs.com/package/@quasibit/eleventy-plugin-sitemap" target="_blank">the sitemap plugin</a> looks cool. Should grab that later.</p>
<p>[ ] So does the <a href="https://www.npmjs.com/package/eleventy-plugin-reading-time" target="_blank">reading time one</a>.</p>
<p>[ ] Also <a href="https://github.com/jdsteinbach/eleventy-plugin-toc/blob/master/src/BuildTOC.js" target="_blank">this TOC plugin</a> mby?</p>
<p>[ ] Use <a href="https://www.11ty.dev/docs/data-deep-merge/" target="_blank">Data Deep Merge</a> in this blog.</p>
<p>[ ] Decide if I want to render the CSS fancier than just a base file and do per-template splitting.</p>
<p>[ ] Can I use the template inside of dinky that already exists instead of copy/pasting it?</p>
<p>[ ] Is there a way to have permalinks to posts contain metadata without organizing them into subfolders?</p>
<p>[ ] How do I cachebreak files on the basis of new build events? Datetime? <code>site.github.build_revision</code> is how Jekyll accomplishes this, but is there a way to push that into the build process for 11ty?</p>
<p>[ ] Make link text look less shitty. It looks like it is a whole, lighter, font.</p>
<p>[ ] Code blocks do not have good syntax highlighting. I want good syntax highlighting.</p>
<h1>Day 4</h1>
<p>Ok, don't have a ton of time to work today, but I've been thinking more about the shitty code blocks.</p>
<p>The core of the problem is that I can't even apply styles the way I want because the code is not being broken down properly.</p>
<p>Here's what I'm getting:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pre</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>language-markdown<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br />	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>language-markdown<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br />		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>token front-matter-block<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br />		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>token punctuation<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>---<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><br />		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>token font-matter yaml language-yaml<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>layout: page<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><br />		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>token punctuation<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>---<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><br />	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">></span></span><br /><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pre</span><span class="token punctuation">></span></span></code></pre>
<p>What I want would look like this:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pre</span><span class="token punctuation">></span></span><br />	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>language-markdown<span class="token punctuation">"</span></span> <span class="token attr-name">data-lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>markdown<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br />		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>---<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><br />		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>na<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>layout<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pi<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>s<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>post<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><br />		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>---<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><br />	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">></span></span><br /><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pre</span><span class="token punctuation">></span></span></code></pre>
<p>See the greater level of styling detail available via the additional span tags?</p>
<p>Ok. So, like I said, surely a lot of people are using 11ty to demo code. Why not take a step back?</p>
<p>Instead of trying to get some increasingly complex markdown processor in play to do this, let's see if there is a code block plugin instead? If anyone uses it I bet 11ty's website does?</p>
<p><a href="https://github.com/11ty/11ty-website/blob/master/.eleventy.js#L14" target="_blank">Yup</a>!</p>
<p><a href="https://www.11ty.dev/docs/plugins/syntaxhighlight/" target="_blank">Reading the docs</a>. Looks like it uses Prism, which I'm also familiar with. I'll try to implement like the 11ty site does.</p>
<p>Ok, that looks a LOT better! I'll have to walk through some examples to make sure it works.</p>
<p>git commit -am &quot;Syntax highlighting actually working now?&quot;</p>
]]></content:encoded>
	</item>
	
	<item>
		<title>Hello World Devblog - Pt. 5</title>
		<link>https://fightwithtools.dev/posts/hello-day-5/?source=rss</link>
		<pubDate>Wed, 23 Jun 2021 14:14:04 GMT</pubDate>
		<dc:creator>Aram Zucker-Scharff</dc:creator>
		<guid isPermaLink="true">https://fightwithtools.dev/posts/hello-day-5/</guid>
		<description></description>
		<content:encoded><![CDATA[<ol>
<li>Static Site Generator that can build the blog and let me host it on Github Pages</li>
<li>I want to write posts in Markdown because I'm lazy, it's easy, and it is how I take notes now.</li>
<li>I don't want to spend a ton of time doing design work. I'm doing complicated designs for other projects, so I want to pull a theme I like that I can rely on someone else to keep up.</li>
<li>Once it gets going, I want template changes to be easy.</li>
<li>It should be as easy as Jekyll, so I need to be able to build it using GitHub Actions, where I can just commit a template change or Markdown file and away it goes. If I can't figure this out than fk it, just use Jekyll.</li>
<li>I require it to be used by a significant percent of my professional peers so I can get easy answers when something goes wrong.</li>
<li>I want source maps. This is a dev log site which means whatever I do with it should be easy for other developers to read.</li>
</ol>
<ul class="task-list">
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Also <a href="https://www.npmjs.com/package/@quasibit/eleventy-plugin-sitemap" target="_blank">the sitemap plugin</a> looks cool. Should grab that later.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> So does the <a href="https://www.npmjs.com/package/eleventy-plugin-reading-time" target="_blank">reading time one</a>.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Also <a href="https://github.com/jdsteinbach/eleventy-plugin-toc/blob/master/src/BuildTOC.js" target="_blank">this TOC plugin</a> mby?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Use <a href="https://www.11ty.dev/docs/data-deep-merge/" target="_blank">Data Deep Merge</a> in this blog.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Decide if I want to render the CSS fancier than just a base file and do per-template splitting.</p>
</li>
</ul>
<s>
<ul class="task-list">
<li class="task-list-item"><input disabled="true" type="checkbox" class="markdown-todo" /> Can I use the template inside of dinky that already exists instead of copy/pasting it?</li>
</ul>
</s>
<ul class="task-list">
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Is there a way to have permalinks to posts contain metadata without organizing them into subfolders?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> How do I cachebreak files on the basis of new build events? Datetime? <code>site.github.build_revision</code> is how Jekyll accomplishes this, but is there a way to push that into the build process for 11ty?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Make link text look less shitty. It looks like it is a whole, lighter, font.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo" /> Code blocks do not have good syntax highlighting. I want good syntax highlighting.</p>
</li>
</ul>
<h1>Day 5</h1>
<p>Ok, yesterday I didn't have that much time to work, but today I'm feeling as good as I can after having my main battery and a whole bunch of USB sticks, a Yubi key, and my main external Anker power battery robbed out of the back of a rental car in San Antonio yesterday.</p>
<p>Good news, finally a check mark on my ever-expanding scope list. Some bad news for the task list as well, in that I'm now 99% sure I can't just pull the template from the dinky submodule. I think there are just too significant a set of differences between Jekyll and Nunjucks. I could explore more similar templating languages, but getting better at Nunjucks is part of the point of all this, so I'm going to dismiss that from my work scope for now.</p>
<p>So, since it hasn't been a great 24hs IRL, let's see if I can harvest a few more easy wins.</p>
<p>How do the GitHub variables work for cachebreaking? That seems like a potentially non-obvious but relatively easy win. A-searching we do go.</p>
<p>Interesting to see someone <a href="https://snook.ca/archives/servers/deploying-11ty-to-gh-pages" target="_blank">handling their build via Travis</a>, good to remember.</p>
<p>Ok, that was unexpected. No one seems to have asked this question? Maybe it just works? I guess I'll have to wait to deploy in order to see. Moving on to something entirely in my hands, let's make the links look less shitty.</p>
<p>Let me show you the problem.</p>
<p>Oh, wait, need to get the image folder working first...</p>
<p>Ok, following the pattern of posts the <code>img</code> folder should be inside of <code>src</code>. Gotta fix the passthrough <code>eleventyConfig.addPassthroughCopy(&quot;src/img&quot;, &quot;img&quot;);</code>.</p>
<p>Oh, I actually <a href="https://www.11ty.dev/docs/copy/#how-passthrough-file-copy-handles-input-directories" target="_blank">don't need to be that explicit</a>. <code>eleventyConfig.addPassthroughCopy(&quot;src/img&quot;, &quot;img&quot;);</code> works just fine.</p>
<p>Hmmm, I could do full URLs, but this is actually one of the things I hate about Jekyll.</p>
<p>Ugh... <a href="https://github.com/11ty/eleventy/issues/379" target="_blank">it looks like the general strategy in GitHub issues is to copy images to be relative to the folders of the associated posts</a>. That's... meh. I dislike it intensely. What if I want to reuse the image? Now I have multiples. One image, one URL IMHO.</p>
<p>Ok, looks like I'm not the only one fiddling around with this, <a href="https://www.npmjs.com/package/markdown-it-replace-link" target="_blank">someone else wrote all the annoying regexes for me in a markdown-it plugin</a>.</p>
<p>There's <a href="https://www.11ty.dev/docs/data-eleventy-supplied/" target="_blank">no way to really get the base URL</a>, but at least I can do it <a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself" target="_blank">DRY</a>.</p>
<aside>
<p>(I also saw <a href="https://www.11ty.dev/docs/quicktips/eliminate-js/" target="_blank">how 11ty pulls from the Github API on build</a>, which may be useful if I need to use <a href="https://docs.github.com/en/rest/reference/repos#get" target="_blank">that sort of info</a> for cachebreaking later.)</p>
</aside>
<div style="border: 2px black solid">
<p><img src="https://fightwithtools.dev/img/links-and-not-links.png" alt="Links look bad inside the text." /></p>
</div>
<p>This comes from that whole annoying school of &quot;native link styles are ugly so let's change them as much as possible and try to use some other thing to indicate they are links.&quot;</p>
<p>That school is one I do not attend. Clear and legible UX has to build on top of standards of design the user is familiar with lest a site confuse the reader. I can give any theme some room, you can remove underlines, or change the color to something other than close-to-link-blue, but both?! Nien.</p>
<p>Huh... first things first... that Sass folder should really be in <code>src</code>.</p>
<p>Ok, now to set up a <code>user</code> overwrite to be the last file in the Sass compile process, and t/f the one that overrides general site-level stuff. Let's fix it to a blue color and remove that <em>very</em> annoying light weight on the font.</p>
<p>Much better.</p>
<p>Oh, I want to make those checkboxes show up correctly. Bet there's a markdown-it plugin I can use. It looks like there are 2 possible node modules, <a href="https://www.npmjs.com/package/markdown-it-task-checkbox" target="_blank">a more used one with some unresolved PRs and ignored issues</a> and <a href="https://www.npmjs.com/package/markdown-it-todo" target="_blank">a barely used one that correctly makes checkboxes readonly</a>. It might be less popular, but I'm going with the version that works the way I want right out of the box. It also happens to be a very simple plugin, so if it goes wrong, I can always hack at it.</p>
<p>Looks good!</p>
<p><code>git commit -am &quot;Adding days 4 and 5 progress and notes&quot;</code></p>
]]></content:encoded>
	</item>
	
	<item>
		<title>Hello World Devblog - Pt. 6</title>
		<link>https://fightwithtools.dev/posts/hello-day-6/?source=rss</link>
		<pubDate>Wed, 23 Jun 2021 14:14:04 GMT</pubDate>
		<dc:creator>Aram Zucker-Scharff</dc:creator>
		<guid isPermaLink="true">https://fightwithtools.dev/posts/hello-day-6/</guid>
		<description></description>
		<content:encoded><![CDATA[<ol>
<li>Static Site Generator that can build the blog and let me host it on Github Pages</li>
<li>I want to write posts in Markdown because I'm lazy, it's easy, and it is how I take notes now.</li>
<li>I don't want to spend a ton of time doing design work. I'm doing complicated designs for other projects, so I want to pull a theme I like that I can rely on someone else to keep up.</li>
<li>Once it gets going, I want template changes to be easy.</li>
<li>It should be as easy as Jekyll, so I need to be able to build it using GitHub Actions, where I can just commit a template change or Markdown file and away it goes. If I can't figure this out than fk it, just use Jekyll.</li>
<li>I require it to be used by a significant percent of my professional peers so I can get easy answers when something goes wrong.</li>
<li>I want source maps. This is a dev log site which means whatever I do with it should be easy for other developers to read.</li>
</ol>
<ul class="task-list">
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Also <a href="https://www.npmjs.com/package/@quasibit/eleventy-plugin-sitemap" target="_blank">the sitemap plugin</a> looks cool. Should grab that later.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> So does the <a href="https://www.npmjs.com/package/eleventy-plugin-reading-time" target="_blank">reading time one</a>.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Also <a href="https://github.com/jdsteinbach/eleventy-plugin-toc/blob/master/src/BuildTOC.js" target="_blank">this TOC plugin</a> mby?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Use <a href="https://www.11ty.dev/docs/data-deep-merge/" target="_blank">Data Deep Merge</a> in this blog.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Decide if I want to render the CSS fancier than just a base file and do per-template splitting.</p>
</li>
</ul>
<s>
<ul class="task-list">
<li class="task-list-item"><input disabled="true" type="checkbox" class="markdown-todo" /> Can I use the template inside of dinky that already exists instead of copy/pasting it?</li>
</ul>
</s>
<ul class="task-list">
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Is there a way to have permalinks to posts contain metadata without organizing them into subfolders?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> How do I cachebreak files on the basis of new build events? Datetime? <code>site.github.build_revision</code> is how Jekyll accomplishes this, but is there a way to push that into the build process for 11ty?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo" /> Make link text look less shitty. It looks like it is a whole, lighter, font.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo" /> Code blocks do not have good syntax highlighting. I want good syntax highlighting.</p>
</li>
</ul>
<h1>Day 6</h1>
<p>Ok, here we go on day 6. Today I write code on a Delta flight.</p>
<p>I've resolved some of the very basic blockers that were absolute need-to-haves from a design perspective. There is more work to be done on the design side (obviously, I still don't have a home page) but I think I need to answer questions about the GitHub Pages deployment process before I go any further. I know I can make an 11ty blog that satisfies me now, but can I do so while also satisfying the ease of deployment and management that comes with Jekyll-style Github Pages deployment? Luckily the internet is free today, so I can find out at no added cost to my flight.</p>
<p>The most upvoted solution I saw for Github Pages deployment was <a href="https://www.linkedin.com/pulse/eleventy-github-pages-lea-tortay/" target="_blank">the LinkedIn post by Lea Tortay</a> I found earlier. While I've managed a number of other deploy approaches, I actually have never written my own Github Pages deployment process, so figuring that out was one of my goals with this project. Let's start with that.</p>
<p>Oh, lol the wifi was only free for the first 5 minutes I guess? Ok, I'll pay.</p>
<p>Hmmmmm Captive Portal problems. Time to reboot.</p>
<p>Had to reboot, find the captive portal URL, cycle my DHCP lease and then pay for the privlige, but on the interwebs again. Payed to get on.</p>
<p>Ok, implimented the Github actions file with a few small changes, I went ahead and updated <code>node-version</code> to match my latest version and switched by branch from master to main. Took care of the keys as specified. The action ran... but no joy. Maybe the problem is a lack of index page? Let's try putting one together.</p>
<p>Huh... it build from the file at <code>src/index.njk</code> once... and now it hasn't again. I made my defaults layout the same as my posts layout, so it should work. But after I wiped it out one time, it hasn't built again.</p>
<p>Is it possible to have the docs content not committed on <code>main</code> but only on <code>gh-pages</code>? That would seem to be a good solution, but let's see.</p>
<p>Ooops, I was fiddling with trying to build a useful gitignore file for docs and passing it through and accidentally deleted all my layouts.</p>
<p>Let me pull those files back in from the last good commit: <code>git checkout 32e6206c0680d9009a316b85e33461479058d81d src/_layouts/*</code></p>
<p>Yup that did it. My Index file is back.</p>
<p>Build still isn't working. Hmmm where are the logs for this?</p>
<p>Ok, <a href="https://github.com/AramZS/devblog/actions" target="_blank">in the Actions tab</a>, not in settings.</p>
<p>Looks like it isn't pulling in Dinky properly as a submodule because <a href="https://docs.github.com/en/pages/getting-started-with-github-pages/using-submodules-with-github-pages" target="_blank">Github Pages needs the https url for the repo in .gitsubmodules</a>.</p>
<p>Hmmm, still not working.</p>
<p>Ah, the issue is that the default configuration of Jekyll github pages pulls in submodules, but <a href="https://github.com/actions/checkout" target="_blank">the default configuration of the checkout action doesn't</a>. I just need to add that property to the yml file.</p>
<p>Oh, and fix my <code>.editorconfig</code> to work better with yml files.</p>
<p><code>git commit -am &quot;Get submodules working for github actions hopefully&quot;</code></p>
<p>Good news, a new error!</p>
<pre class="language-bash"><code class="language-bash">Run peaceiris/actions-gh-pages@v3<br /><span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> Usage https://github.com/peaceiris/actions-gh-pages<span class="token comment">#readme</span><br />Dump inputs<br />Setup auth token<br />  Error: Action failed with <span class="token string">"not found deploy key or tokens"</span></code></pre>
<p>Oops, but the secret in a custom environment instead of the <code>github-pages</code> <a href="https://github.com/AramZS/devblog/settings/environments" target="_blank">environment</a>.</p>
<p>Hmmm... deploy was a success this time, but no-go on seeing any pages? Looks like it just deleted everything but the nojekyll file? I should prob look a little deeper into what is going on with these GitHub actions.</p>
<p>Ooooh. I should make a markdown code to expand my little typing shortcuts!</p>
<p>[ ] Build a Markdown-it plugin to take my typing shortcuts <code>[prob, b/c, ...?]</code> and expand them on build.</p>
<p><code>git commit -am &quot;Have I got the secret now?&quot;</code></p>
]]></content:encoded>
	</item>
	
	<item>
		<title>Hello World Devblog - Pt. 7</title>
		<link>https://fightwithtools.dev/posts/hello-day-7/?source=rss</link>
		<pubDate>Wed, 23 Jun 2021 14:14:04 GMT</pubDate>
		<dc:creator>Aram Zucker-Scharff</dc:creator>
		<guid isPermaLink="true">https://fightwithtools.dev/posts/hello-day-7/</guid>
		<description></description>
		<content:encoded><![CDATA[<ol>
<li>Static Site Generator that can build the blog and let me host it on Github Pages</li>
<li>I want to write posts in Markdown because I'm lazy, it's easy, and it is how I take notes now.</li>
<li>I don't want to spend a ton of time doing design work. I'm doing complicated designs for other projects, so I want to pull a theme I like that I can rely on someone else to keep up.</li>
<li>Once it gets going, I want template changes to be easy.</li>
<li>It should be as easy as Jekyll, so I need to be able to build it using GitHub Actions, where I can just commit a template change or Markdown file and away it goes. If I can't figure this out than fk it, just use Jekyll.</li>
<li>I require it to be used by a significant percent of my professional peers so I can get easy answers when something goes wrong.</li>
<li>I want source maps. This is a dev log site which means whatever I do with it should be easy for other developers to read.</li>
</ol>
<ul class="task-list">
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Also <a href="https://www.npmjs.com/package/@quasibit/eleventy-plugin-sitemap" target="_blank">the sitemap plugin</a> looks cool. Should grab that later.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> So does the <a href="https://www.npmjs.com/package/eleventy-plugin-reading-time" target="_blank">reading time one</a>.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Also <a href="https://github.com/jdsteinbach/eleventy-plugin-toc/blob/master/src/BuildTOC.js" target="_blank">this TOC plugin</a> mby?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Use <a href="https://www.11ty.dev/docs/data-deep-merge/" target="_blank">Data Deep Merge</a> in this blog.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Decide if I want to render the CSS fancier than just a base file and do per-template splitting.</p>
</li>
</ul>
<s>
<ul class="task-list">
<li class="task-list-item"><input disabled="true" type="checkbox" class="markdown-todo" /> Can I use the template inside of dinky that already exists instead of copy/pasting it?</li>
</ul>
</s>
<ul class="task-list">
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Is there a way to have permalinks to posts contain metadata without organizing them into subfolders?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> How do I cachebreak files on the basis of new build events? Datetime? <code>site.github.build_revision</code> is <a href="https://github.com/jekyll/github-metadata/blob/master/docs/site.github.md" target="_blank">how Jekyll accomplishes this</a>, but is there a way to push <a href="https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context" target="_blank">that</a> <a href="https://stackoverflow.com/questions/54310050/how-to-version-build-artifacts-using-github-actions" target="_blank">into the build process</a> for 11ty?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo" /> Make link text look less shitty. It looks like it is a whole, lighter, font.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo" /> Code blocks do not have good syntax highlighting. I want good syntax highlighting.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Build a Markdown-it plugin to take my typing shortcuts <code>[prob, b/c, ...?]</code> and expand them on build.</p>
</li>
</ul>
<h1>Day 7</h1>
<p>Ok, after struggling with the plane wifi and spending some time talking to my row-mate about us both being web engineers, I didn't get quite as much as I had planned done on the plane. So we're back with an empty build branch.</p>
<p>Time to get back to it. I think the first thing is to check the various GitHub actions. I'd hoped they'd work right out of the box but no-go (maybe?). The LinkedIn post was helpful, but the fact that the author's project is no longer public makes it a pain to make sure I'm following directions properly.</p>
<p>First is <a href="https://github.com/actions/setup-node" target="_blank">setup-node</a>. And some immediate things pop out at me. First I'd set up with Node 15 locally. But it looks like this action is only able to use up to and including Node 14. So, let's use nvm and rebuild the node_modules and package-lock.json files with Node 14. Deleting them both, changing the value in <code>.nvmrc</code> and rebooting my terminal.</p>
<p>Oh, NVM doesn't automatically use the latest node version huh? Ok, I'll specify the version to match the action on Github. Downloading and installing it now.</p>
<p><code>npm install</code></p>
<p>Ok. Everything still works, so that is good!</p>
<p>But what could be the issue, it must be me gitignoring the docs folder, I guess it has to commit the folder? I still don't want the docs folder on my main branch if I can avoid it. What if I just remove the docs gitignore during the build process?</p>
<p>I'll add the line to the top of the commands run, it basically echoes the contents of .gitignore starting at the 2nd line back into the .gitignore file:</p>
<p><code>- run: echo &quot;$(tail -n +2 .gitignore)&quot; &gt; .gitignore</code></p>
<p><code>git commit -am &quot;Update build process and attempt to commit the docs folder in the build process&quot;</code></p>
<p>Hmmm still no go. Let's read <a href="https://github.com/peaceiris/actions-gh-pages#github-actions-for-github-pages" target="_blank">the actions-gh-pages docs</a> from zero instead.</p>
<p>It looks like <code>publish_dir:</code> in the build task says is the <em>source</em> folder to publish onto the gh-pages branch. A good lesson to read the docs right here because literally line 2 is</p>
<blockquote>
<p>The next example step will deploy ./public directory to the remote gh-pages branch.</p>
</blockquote>
<p><code>git commit -am &quot;Is the issue the docs directory needs to be the public_dir?&quot;</code></p>
<p>Interesting, now the content is properly in the gh-pages branch! I might not even need the gitignore change?</p>
<p><code>git commit -am &quot;Remove the gitignore rewrite&quot;</code></p>
<p>I also originally had the folder set for Github Pages to be <code>/docs</code> but that's not how this works, the action publishes the content inside the docs folder to the root of the <code>gh-pages</code> branch. I have to fix that in the repo settings.</p>
<p>Sweet, I see a page now! Just have to fix how the stylesheet works in the build environment!</p>
<p>While I'm here I should <a href="https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/managing-a-custom-domain-for-your-github-pages-site" target="_blank">map my apex domain to the Github Site</a>. Easy enough, create a bunch of A records in GoDaddy's DNS controls and then direct my <code>www</code> record CNAME to my <a href="http://github.io/" target="_blank">github.io</a> user page.</p>
<p>I'll create the correct CNAME file and set up 11ty to pass it through to the build process.</p>
<p><code>eleventyConfig.addPassthroughCopy(&quot;./CNAME&quot;);</code></p>
<p>And I'm going to set up my site data using <a href="https://www.npmjs.com/package/dotenv" target="_blank">dotenv</a> in order to have my local <code>http://localhost:8080</code> server used for the site domain when local and otherwise have it use my domain.</p>
<p><code>git commit -am &quot;Setting up dotenv to have proper site data and domain use&quot;</code></p>
<p>Oops, swapped my prod and local domains.</p>
<p><code>git commit -am &quot;Ooops mixed up my local and prod urls&quot;</code></p>
<p>Ok, it looks like it is all working for my my base level requirements 1-6. I still want a source map for my CSS and that isn't done yet, but that is a Sass task.</p>
<p>I still have some other major tasks... like building a real home page, including serious SE/MO and a few other things, but now I can move forward on that work confident that this system hits my baseline requirements and I can invest more time into it.</p>
<p>Finishing off my requirements means handling some Sass to get mapping to work. I can define <code>sourceMap</code> and write the file appropriately, but it looks like I'll need handle two complications, first the relative paths to the source file will have to be passed through so the Sass files can be exposed on the front end. That's easy enough with a few functions in <code>.eleventy.js</code>. But it also apparently will need to have a full, not relative, url.</p>
<p>I thought I might be able to use <a href="https://www.11ty.dev/docs/data-global-custom/" target="_blank">global data added at the config level, but it looks like that isn't available yet</a>. Didn't see that on my first run through as it isn't super obviously called out.</p>
<p>I decided to use a combination of dotenv and setting some internal Node-level variables here to set up the domain name once and reuse it elsewhere.</p>
<p>Hmmm, while trying to debug I noticed my image rewrite method was also applying to all links. Oops. I'll need to pass in a smarter function.</p>
<pre class="language-javascript"><code class="language-javascript">		<span class="token function-variable function">replaceLink</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">link<span class="token punctuation">,</span> env</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br />			<span class="token comment">// console.log("env:", env);</span><br />			<span class="token keyword">var</span> imageLinkRegex <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^..\/img\/</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span><br />			<span class="token keyword">if</span> <span class="token punctuation">(</span>link <span class="token operator">&amp;&amp;</span> imageLinkRegex<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br />				<span class="token keyword">return</span> <span class="token punctuation">(</span><br />					env<span class="token punctuation">.</span>site<span class="token punctuation">.</span>site_url <span class="token operator">+</span><br />					<span class="token string">"/img/"</span> <span class="token operator">+</span><br />					link<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>imageLinkRegex<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><br />				<span class="token punctuation">)</span><span class="token punctuation">;</span><br />			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br />				<span class="token keyword">return</span> link<span class="token punctuation">;</span><br />			<span class="token punctuation">}</span><br />		<span class="token punctuation">}</span></code></pre>
<p>While I'm fiddling with markdown-it, I should also <a href="https://github.com/markdown-it/markdown-it/blob/master/docs/architecture.md#renderer" target="_blank">add <code>target=&quot;_blank&quot;</code> to all my links</a>.</p>
<p>Still looking at how to get <a href="https://developer.mozilla.org/en-US/docs/Tools/Debugger/How_to/Use_a_source_map" target="_blank">sourcemaps</a> working.</p>
<p><code>git commit -am &quot;Fixing a number of path and link issues, still trying to get Sass working with sourcemaps&quot;</code></p>
<ul class="task-list">
<li class="task-list-item"><input disabled="true" type="checkbox" class="markdown-todo" /> See if we can start Markdown's interpretation of H tags to <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/Heading_Elements#multiple_h1" target="_blank">start at 2, since H1</a> is always pulled from the page title metadata. If it isn't easy, I just have to change my pattern of writing in the MD documents.</li>
</ul>
]]></content:encoded>
	</item>
	
	<item>
		<title>Hello World Devblog - Pt. 8</title>
		<link>https://fightwithtools.dev/posts/hello-day-8/?source=rss</link>
		<pubDate>Wed, 23 Jun 2021 14:14:04 GMT</pubDate>
		<dc:creator>Aram Zucker-Scharff</dc:creator>
		<guid isPermaLink="true">https://fightwithtools.dev/posts/hello-day-8/</guid>
		<description></description>
		<content:encoded><![CDATA[<ol>
<li>Static Site Generator that can build the blog and let me host it on Github Pages</li>
<li>I want to write posts in Markdown because I'm lazy, it's easy, and it is how I take notes now.</li>
<li>I don't want to spend a ton of time doing design work. I'm doing complicated designs for other projects, so I want to pull a theme I like that I can rely on someone else to keep up.</li>
<li>Once it gets going, I want template changes to be easy.</li>
<li>It should be as easy as Jekyll, so I need to be able to build it using GitHub Actions, where I can just commit a template change or Markdown file and away it goes. If I can't figure this out than fk it, just use Jekyll.</li>
<li>I require it to be used by a significant percent of my professional peers so I can get easy answers when something goes wrong.</li>
<li>I want source maps. This is a dev log site which means whatever I do with it should be easy for other developers to read.</li>
</ol>
<ul class="task-list">
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo" /> Also <a href="https://www.npmjs.com/package/@quasibit/eleventy-plugin-sitemap" target="_blank">the sitemap plugin</a> looks cool. Should grab that later.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> So does the <a href="https://www.npmjs.com/package/eleventy-plugin-reading-time" target="_blank">reading time one</a>.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Also <a href="https://github.com/jdsteinbach/eleventy-plugin-toc/blob/master/src/BuildTOC.js" target="_blank">this TOC plugin</a> mby?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo" /> Use <a href="https://www.11ty.dev/docs/data-deep-merge/" target="_blank">Data Deep Merge</a> in this blog.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Decide if I want to render the CSS fancier than just a base file and do per-template splitting.</p>
</li>
</ul>
<s>
<ul class="task-list">
<li class="task-list-item"><input disabled="true" type="checkbox" class="markdown-todo" /> Can I use the template inside of dinky that already exists instead of copy/pasting it?</li>
</ul>
</s>
<ul class="task-list">
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Is there a way to have permalinks to posts contain metadata without organizing them into subfolders?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo" /> How do I cachebreak files on the basis of new build events? Datetime? <code>site.github.build_revision</code> is <a href="https://github.com/jekyll/github-metadata/blob/master/docs/site.github.md" target="_blank">how Jekyll accomplishes this</a>, but is there a way to push <a href="https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context" target="_blank">that</a> <a href="https://stackoverflow.com/questions/54310050/how-to-version-build-artifacts-using-github-actions" target="_blank">into the build process</a> for 11ty?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo" /> Make link text look less shitty. It looks like it is a whole, lighter, font.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo" /> Code blocks do not have good syntax highlighting. I want good syntax highlighting.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Build a Markdown-it plugin to take my typing shortcuts <code>[prob, b/c, ...?]</code> and expand them on build.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> See if we can start Markdown's interpretation of H tags to <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/Heading_Elements#multiple_h1" target="_blank">start at 2, since H1</a> is always pulled from the page title metadata. If it isn't easy, I just have to change my pattern of writing in the MD documents.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo" /> Should I <a href="https://www.madebymike.com.au/writing/11ty-filters-data-shortcodes/" target="_blank">explore some shortcodes</a>?</p>
</li>
</ul>
<h2>Day 8</h2>
<p>So, the Sass source-map is still giving me file:// URLs. This is apparently some sort of weird error in the dart-sass implementation? I found a few issues, all of which seem to point at <a href="https://github.com/sass/libsass/issues/908#issuecomment-76452477" target="_blank">one issue's set of solutions</a>. But none of these worked for me. I'm not really sure why. I think because dart-sass assumes source maps are only used for local development, not also for public-facing examples like I want. But the top of that thread pointed me <a href="https://github.com/joliss/node-sass-source-map-example/blob/master/better-output.js" target="_blank">at a useful build script example</a>.</p>
<p>On the basis of that (which still uses dirname for local file paths) I altered it to match my reality of running a local server&quot;</p>
<pre class="language-javascript"><code class="language-javascript">	<span class="token keyword">const</span> outFile <span class="token operator">=</span> <span class="token string">"/assets/css/style.css"</span><span class="token punctuation">;</span><br />	<span class="token keyword">var</span> result <span class="token operator">=</span> sass<span class="token punctuation">.</span><span class="token function">renderSync</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br />		includePaths<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"**/*.{scss,sass}"</span><span class="token punctuation">,</span> <span class="token string">"!node_modules/**"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br />		file<span class="token operator">:</span> <span class="token string">"src/_sass/_index.sass"</span><span class="token punctuation">,</span><br />		outputStyle<span class="token operator">:</span> <span class="token string">"compressed"</span><span class="token punctuation">,</span><br />		sourceMap<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br />		sourceMapContents<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br />		outFile<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> path<span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span>outFile<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br />	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Sass renderSync result"</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span><br />	<span class="token keyword">var</span> fullCSS <span class="token operator">=</span> result<span class="token punctuation">.</span>css<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />	<span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span><br />	map<span class="token punctuation">.</span>sourceRoot <span class="token operator">=</span> domain<span class="token punctuation">;</span><br />	result<span class="token punctuation">.</span>map <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">"\t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />	<span class="token keyword">var</span> fullMap <span class="token operator">=</span> result<span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>I understand everything that my code is doing here, but the use of <code>process.cwd</code> here is very confusing. It works, for sure! I now have:</p>
<pre class="language-json"><code class="language-json">	<span class="token property">"version"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span><br />	<span class="token property">"sourceRoot"</span><span class="token operator">:</span> <span class="token string">"http://localhost:8080"</span><span class="token punctuation">,</span><br />	<span class="token property">"sources"</span><span class="token operator">:</span> <span class="token punctuation">[</span><br />		<span class="token string">"dinky/_sass/jekyll-theme-dinky.scss"</span><span class="token punctuation">,</span><br />		<span class="token string">"dinky/_sass/rouge-github.scss"</span><span class="token punctuation">,</span><br />		<span class="token string">"src/_sass/base-syntax-highlighting.scss"</span><span class="token punctuation">,</span><br />		<span class="token string">"src/_sass/syntax-highlighting.scss"</span><span class="token punctuation">,</span><br />		<span class="token string">"src/_sass/user.sass"</span><br />	<span class="token punctuation">]</span><span class="token punctuation">,</span></code></pre>
<p>The code sample says &quot;HACK 1: Force all &quot;sources&quot; to be relative to project root&quot; but it apparently does this so that dart-sass... gets rid of the project root? I find this process very confusing, I'm adding the project root so Sass can remove the project root? This is fking baffling to me and apparently hits some process that is very badly documented in dart-sass. The other hack &quot;node-sass does not support sourceRoot, but we can add it&quot; at least makes sense. Seems like something you should support! It looks like some iteration of Node-based Sass takes the <code>sourceMapRoot</code> configuration property, but not dart-sass. The documentation and debugging process is very confusing for this because dart-sass links to node-sass for most of its documentation, but node-sass clearly has some features that dart-sass does not, and the fact that issues are often in node-sass that are actually about dart-sass is just a <em>mess</em>.</p>
<p>Anyway, this works now... and it gives me a really useful insight into how the source map is built. I can hack better paths for sources! The paths themselves are useful for the project, but having them at the base of the website sort of irks me. Now I can put them all in a nice <code>sass</code> folder, makes it neat.</p>
<pre class="language-javascript"><code class="language-javascript">	<span class="token keyword">var</span> newSources <span class="token operator">=</span> map<span class="token punctuation">.</span>sources<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br />		<span class="token keyword">return</span> <span class="token string">"sass/"</span> <span class="token operator">+</span> source<span class="token punctuation">;</span><br />	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />	map<span class="token punctuation">.</span>sources <span class="token operator">=</span> newSources<span class="token punctuation">;</span></code></pre>
<p>And I can also change my passthroughs in <code>.eleventy.js</code>.</p>
<pre class="language-javascript"><code class="language-javascript">	eleventyConfig<span class="token punctuation">.</span><span class="token function">addPassthroughCopy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br />		<span class="token string">"dinky/_sass"</span><span class="token operator">:</span> <span class="token string">"sass/dinky/_sass"</span><span class="token punctuation">,</span><br />	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />	eleventyConfig<span class="token punctuation">.</span><span class="token function">addPassthroughCopy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br />		<span class="token string">"src/_sass"</span><span class="token operator">:</span> <span class="token string">"sass/src/_sass"</span><span class="token punctuation">,</span><br />	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>If this works correctly on publish, it will resolve the last of my base requirements!</p>
<p>Ok, I was thinking about how to handle build-time cache-breaking and realized that there's likely a way to handle getting a cache-break variable at the build stage. There's <a href="https://github.com/jekyll/github-metadata" target="_blank">a plugin for Jekyll to do it</a>, it looks like <a href="https://github.com/jekyll/github-metadata/blob/master/docs/authentication.md" target="_blank">it does so at least partially via the Github API</a>. It gets <a href="https://github.com/jekyll/github-metadata/blob/master/docs/site.github.md" target="_blank">a pretty good list of data too</a>. There's also <a href="https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context" target="_blank">the &quot;Github Context&quot; which is available to GitHub actions</a>. I could call the API during build time, which is what it appears that Jekyll is doing (I didn't really look too deeply into the plugin). But if this data is available in the Actions context... couldn't I export it as a environment variable? Why not try adding that to the Github Actions script?</p>
<pre class="language-yaml"><code class="language-yaml">        <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> export GITHUB_HEAD_SHA=$</code></pre>
<p>Now I should be able to call this in my site data, right? So I'll update the file at <code>src/_data/site.js</code>.</p>
<pre class="language-javascript"><code class="language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">info</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br />	<span class="token keyword">return</span> <span class="token punctuation">{</span><br />		lang<span class="token operator">:</span> <span class="token string">"en-US"</span><span class="token punctuation">,</span><br />		github<span class="token operator">:</span> <span class="token punctuation">{</span><br />			build_revision<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">GITHUB_HEAD_SHA</span> <span class="token operator">||</span> <span class="token number">1.0</span><span class="token punctuation">,</span><br />		<span class="token punctuation">}</span><span class="token punctuation">,</span><br />		site_url<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">DOMAIN</span><span class="token punctuation">,</span><br />	<span class="token punctuation">}</span><span class="token punctuation">;</span><br /><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>Huh... about to try this but a thought occurs... should I just export the whole <code>github</code> object? Would that work? Wait... <a href="https://docs.github.com/en/actions/reference/environment-variables" target="_blank">is it already there</a>? Let me try that both ways and see what I get.</p>
<p><code>git commit -am &quot;Set up new Sass build process and new build vars in use&quot; </code></p>
<p>Well... the Sass sitemaps built properly, but none of the Github Actions env stuff seemed to have gone off. For some reason calling <code>process.env.GITHUB_JOB</code> just got me <code>deploy</code>. Which is the job name, not a job-run ID. But a step in the right direction, just me mistakenly reading the docs.</p>
<p>What if I set the <code>env</code> at the level of job? I think this means I could prob use <code>GITHUB_SHA</code>, but I want to see what works.</p>
<pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">jobs</span><span class="token punctuation">:</span><br />  <span class="token key atrule">deploy</span><span class="token punctuation">:</span><br />    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest<br />    <span class="token key atrule">env</span><span class="token punctuation">:</span><br />      <span class="token key atrule">MY_GITHUB_RUN_ID</span><span class="token punctuation">:</span> $</code></pre>
<p>Ah, that did it, so now I know how to use both!</p>
<p>The sitemap plugin looks easy to implement. Let's try that!</p>
<p>Looks good! A little basic as sitemaps go, and if this site gets extensive I may have to figure out file splitting, but there's a lot of flexibility and options in the plugin so I'm not too worried.</p>
<p><code>git commit -am &quot;Set up sitemap&quot;</code></p>
<p>Just checking off stuff in this post!</p>
<p>Looks like the Deep Data Merge is up and running already. I'll do a quick double check and it does appear to work fine!</p>
<p>RSS feed next. Need to add the collection tag to my <code>posts.json</code> in <code>src/posts</code> in order to have it properly in a <code>posts</code> collection.</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br />	<span class="token property">"layout"</span><span class="token operator">:</span> <span class="token string">"post.njk"</span><span class="token punctuation">,</span><br />	<span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Aram is talking about code"</span><span class="token punctuation">,</span><br />	<span class="token property">"tags"</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">"posts"</span> <span class="token punctuation">]</span><br /><span class="token punctuation">}</span></code></pre>
<p>Huh, I'm getting this in the output now: <code>Benchmark (Configuration): &quot;htmlToAbsoluteUrls&quot; Nunjucks Async Filter took 40ms (8.9%, called 8Ã—, 5.0ms each)</code> and the domain name is wrong in the RSS feed. Found some info on building permalinks that may be useful for my more dynamic link urls, but doesn't seem to be for this. Huh, looks like this generates an Atom feed, not an RSS standard one. Going to rename the file accordingly.</p>
<p>Still no go on getting those URLs set up properly. I need to pass the calculated domain in to the page metadata, but using template tags or JS functions doesn't seem to be doing it. The domain data just isn't going through.</p>
<p>Ok, I had thought the functions in the <code>js</code> layout-based front matter would execute themselves, but it looks like I have to write them to execute in the context of the front matter itself. So now the front matter looks like this:</p>
<pre class="language-liquid"><code class="language-liquid"><span class="token operator">--</span><span class="token operator">-</span>js<br />{<br />  "permalink"<span class="token operator">:</span> "feed.xml",<br />  "eleventyExcludeFromCollections"<span class="token operator">:</span> true,<br />  "metadata"<span class="token operator">:</span> {<br />    "title"<span class="token operator">:</span> "Feed <span class="token keyword">for</span> Fight With Tools <span class="token operator">-</span> Aram's Dev Blog",<br />    "subtitle"<span class="token operator">:</span> "Notes on various projects",<br />    "url"<span class="token operator">:</span> (function(){ return process.env.DOMAIN <span class="token operator">+</span> "<span class="token operator">/</span>" })(),<br />    "feedUrl"<span class="token operator">:</span> (function(){ return process.env.DOMAIN <span class="token operator">+</span> "<span class="token operator">/</span>feed.xml" })(),<br />    "author"<span class="token operator">:</span> {<br />      "name"<span class="token operator">:</span> "Aram Zucker<span class="token operator">-</span>Scharff",<br />      "email"<span class="token operator">:</span> "aramdevblog@aramzs.me"<br />    }<br />  },<br />  "internalPageTypes"<span class="token operator">:</span> [ "feed" ]<br />}<br /><span class="token operator">--</span><span class="token operator">-</span></code></pre>
<p>Looks like the solution was to use a immediately-invoked function there. Working well now!</p>
<p>Looks like <a href="https://obsolete29.com/posts/ogp-seo-favicons-eleventy/" target="_blank">there is a straightforward way to handle building a good robots.txt</a> file.</p>
<p>I'll hand build an RSS template so I have an RSS2 feed as well.</p>
<p><code>git commit -am &quot;Set up various feeds and crawling tools&quot;</code></p>
]]></content:encoded>
	</item>
	</channel>
</rss>
