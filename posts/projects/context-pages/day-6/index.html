<!doctype html>
    <html lang="en-US" id="template-post" class="base">
        <head>
        
        <script defer data-domain="fightwithtools.dev" src="https://plausible.io/js/plausible.js"></script>
        <link rel="alternate" type="application/rss+xml" title="Fight With Tools: A Dev Blog RSS" href="https://fightwithtools.dev/rss/" />
    	<link rel="alternate" type="application/atom+xml" title="Fight With Tools: A Dev Blog Feed" href="https://fightwithtools.dev/feed/" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Day 6: Looking into Memento and Readability processing</title>
        
            <!-- Sub Template: post -->
        
        
            <link rel="preload" as="font">
            <link href="https://fightwithtools.dev/assets/prism-okaidia.css" rel="preload" as="style" />
            <link href="https://fightwithtools.dev/assets/prism-okaidia.css" rel="stylesheet" />
            <!-- <link rel="stylesheet" href="https://fightwithtools.dev/assets/css/style.css?v=12623264905" /> -->
            <link rel="stylesheet" href="https://fightwithtools.dev/assets/css/style.css?v=12623264905" id=""></link>

            
                <!-- <link rel="stylesheet" href="https://fightwithtools.dev/assets/css/template-post.css?v=12623264905" /> -->
                <link rel="stylesheet" href="https://fightwithtools.dev/assets/css/template-post.css?v=12623264905" id=""></link>

            
            <!-- Build Revision: 12623264905 & Sha: a43035da8e766094bcd56248adc247ce2dfaff9b -->
            <script src="https://fightwithtools.dev/assets/js/scale.fix.js" async></script>
            <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
            <!--[if lt IE 9]>
                <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
            <![endif]-->
        
        
            <!-- The Author meta propagates the byline in a number of social networks -->
<meta name="author" content="Aram Zucker-Scharff" />

<meta property="og:title"
    content="Day 6: Looking into Memento and Readability processing">

<meta property="og:description"
    content="I want to share lists of links, but make them readable and archived">


<meta property="og:url"
    content="https://fightwithtools.dev/posts/projects/context-pages/day-6/" />

<meta property="og:site_name" content="Fight With Tools: A Dev Blog" />

<meta property="og:locale" content="en_US" />

<meta name="twitter:site" content="@chronotope" />

<meta name="twitter:description" content="I want to share lists of links, but make them readable and archived" />

<meta name="description" content="I want to share lists of links, but make them readable and archived">

<!-- I prefer the summary_large_image Twitter card for posts. -->
<meta name="twitter:card" content="summary_large_image" />
<!-- You, you're the creator. -->
<meta name="twitter:creator" content="@chronotope" />
<!-- This property is for the article title, not site title. -->
<meta name="twitter:title" content="Day 6: Looking into Memento and Readability processing" />



<meta property="og:image" content="https://fightwithtools.dev/img/memento.png" />
<meta name="twitter:image" content="https://fightwithtools.dev/img/memento.png" />




    <!-- Article specific OG data -->
    <!-- The OG:Type dictates a number of other tags on posts. -->
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="Mon, 17 Jan 2022 02:59:43 GMT" />

    <!-- page.modified isn't a natural Jekyll property, but it can be added. -->
    

    <!-- Here my author and publisher tags are the same (yay self-publishing) -->
    <meta property="article:author" content="http://facebook.com/aramzs" />
    <!-- But if your site has its own page, this is where to put it. -->
    <meta property="article:publisher" content="https://www.facebook.com/aramzs" />

    
    <!-- Article section isn't a required property, but it can be good to have -->
    <meta property="article:section" content="Context Pages" />
    

    
        <!-- I use the page.categories property for OG tags. -->
        
        <meta property="article:tag" content="posts" />
        
        <meta property="article:tag" content="projects" />
        
        <meta property="article:tag" content="11ty" />
        
        <meta property="article:tag" content="Node" />
        
        <meta property="article:tag" content="WiP" />
        
        <meta property="article:tag" content="archiving" />
        
        <meta property="article:tag" content="Internet Archive" />
        
        <meta property="article:tag" content="research" />
        
        <meta property="article:tag" content="Memento API" />
        
        <meta property="article:tag" content="Memento" />
        
        <meta name="keywords" content="posts, projects, 11ty, Node, WiP, archiving, Internet Archive, research, Memento API, Memento">
    



            <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Blog",
        "url": "https://fightwithtools.dev/posts/projects/context-pages/day-6/",
        "headline": "Day 6: Looking into Memento and Readability processing",
        "about": "I want to share lists of links, but make them readable and archived",
        "image": [
            "https://41.media.tumblr.com/709bb3c371b9924add351bfe3386e946/tumblr_nxdq8uFdx81qzocgko1_1280.jpg"
        ],
        "isAccessibleForFree": "True",
        "isPartOf": {
            "@type": ["CreativeWork", "Product"],
            "name": "Fight With Tools",
            "productID": "fightwithtools.dev"
        },
        "discussionUrl": "https://twitter.com/search?q=to%3AChronotope%20%23dev&src=typed_query&f=top",
        "author": {
    "@type": "Person",
    "name": {
        "@type": "PronounceableText",
        "inLanguage": "en-US",
        "textValue": "Aram Zucker-Scharff",
        "speechToTextMarkup": "IPA",
        "phoneticText": "/ˌæ.ɹəm ˈt͡sʊ.kɚ 'ʃɑɹf/"
    },
    "description": "Aram Zucker-Scharff is Lead Privacy Engineer at The Washington Post, lead dev for PressForward and a consultant. Tech solutions for journo problems.",
    "disambiguatingDescription": "A media-focused developer and strategist.",
    "sameAs": "http://aramzs.github.io/aramzs/",
    "image": {
        "@type": "ImageObject",
        "url": "https://raw.githubusercontent.com/AramZS/aramzs.github.io/master/_includes/Aram-Zucker-Scharff-square.jpg"
    },
    "givenName": "Aram",
    "familyName": "Zucker-Scharff",
    "alternateName": "AramZS",
    "publishingPrinciples": "http://aramzs.github.io/about/"
}, 
        "editor": {
    "@type": "Person",
    "name": {
        "@type": "PronounceableText",
        "inLanguage": "en-US",
        "textValue": "Aram Zucker-Scharff",
        "speechToTextMarkup": "IPA",
        "phoneticText": "/ˌæ.ɹəm ˈt͡sʊ.kɚ 'ʃɑɹf/"
    },
    "description": "Aram Zucker-Scharff is Lead Privacy Engineer at The Washington Post, lead dev for PressForward and a consultant. Tech solutions for journo problems.",
    "disambiguatingDescription": "A media-focused developer and strategist.",
    "sameAs": "http://aramzs.github.io/aramzs/",
    "image": {
        "@type": "ImageObject",
        "url": "https://raw.githubusercontent.com/AramZS/aramzs.github.io/master/_includes/Aram-Zucker-Scharff-square.jpg"
    },
    "givenName": "Aram",
    "familyName": "Zucker-Scharff",
    "alternateName": "AramZS",
    "publishingPrinciples": "http://aramzs.github.io/about/"
},
        "inLanguage": "en-US",
        "license": "http://creativecommons.org/licenses/by-sa/4.0/",
        "additionalType": "CreativeWork",
        "alternateName": "Fight With Tools Dev",
        "publisher": {
            "@type": "Organization",
            "name": "Fight With Tools",
            "description": "A site discussing how to imagine, build, analyze and use cool code and web tools. Better websites, better stories, better developers. Technology won't save the world, but you can.",
            "sameAs": "https://fightwithtools.dev/",
            "logo": {
                "@type": "ImageObject",
                "url": "https://41.media.tumblr.com/709bb3c371b9924add351bfe3386e946/tumblr_nxdq8uFdx81qzocgko1_1280.jpg"
            },
            "publishingPrinciples": "http://aramzs.github.io/about/"
        }
    }
</script>

        
        
        
<link rel="canonical" href="https://fightwithtools.dev/posts/projects/context-pages/day-6/" />

        </head>
        <body itemscope itemtype="https://schema.org/Blog">
            <div class="wrapper">
                <header>
                    
                        
                            <div id="site-name-subhead">
                                <a href="https://fightwithtools.dev">Fight With Tools: A Dev Blog</a>
                                
                                    > <a id="project-link" href="https://fightwithtools.dev/projects/context-pages">Context Pages</a>
                                
                            </div>
                        
                        
                            <!-- post mode -->
                            <time>Mon Jan 17 2022</time>
                            <!-- front matter dates made in format at https://yaml.org/type/timestamp.html -->
                        
                        
                            <!-- projects mode -->
                        
                        <h1 class="header">
                            Day 6: Looking into Memento and Readability processing
                        </h1>
                        
                        
                    
                    
    <h5 itemprop="author" itemscope itemtype="https://schema.org/Person">
    <link itemprop="sameAs" href="http://aramzs.github.io/aramzs/" />
    By <span itemprop="name"><a href="http://aramzs.github.io/aramzs/" target="_blank">Aram Zucker-Scharff</a></span>
</h5>

                </header>
                <main>
                    
    <section id="precontent">
        <aside id="toc-container">
            <div id="toc-container__inner">
                <h2>Contents</h2>
                <nav class="toc" >
        <ol><li><a href="#project-scope-and-todos">Project Scope and ToDos</a></li><li><a href="#day-6">Day 6</a><ol><li><a href="#examining-memento">Examining Memento</a></li><li><a href="#adding-readability-to-the-link-object">Adding Readability to the Link Object</a></li><li><a href="#trying-out-grab-site">Trying out grab-site</a></li></ol></li></ol>
      </nav>
            </div>
        </aside>
        <div id="post-description">I want to share lists of links, but make them readable and archived</div>

        
    <figure class="figure preview-image">
        <img src="https://fightwithtools.dev/img/memento.png" alt="Chart of the Memento architecture">
        
            <figcaption class="figcaption">
                
                 | <em>
                        <a href="http://mementoweb.org/guide/quick-intro/" target="_blank">From: Memento Guide - Introduction to Memento</a>
                    </em> | 
            </figcaption>
        
    </figure>


    </section>

                    <section id="maincontent" class="maincontent">
                    
                        <h2 id="project-scope-and-todos" tabindex="-1">Project Scope and ToDos</h2>
<ol>
<li>Take a link and turn it into an oEmbed/Open Graph style share card</li>
<li>Take a link and archive it in the most reliable way</li>
<li>When the link is a tweet, display the tweet but also the whole tweet thread.</li>
<li>When the link is a tweet, archive the tweets, and display them if the live ones are not available.</li>
<li>Capture any embedded retweets in the thread. Capture their thread if one exists</li>
<li>Capture any links in the Tweet</li>
<li>Create the process as an abstract function that returns the data in a savable way</li>
</ol>
<ul class="task-list">
<li class="task-list-item"><input disabled="true" type="checkbox" class="markdown-todo"></input> Archive links on <a href="http://Archive.org" target="_blank">Archive.org</a> and save the resulting archival links</li>
<li class="task-list-item"><input disabled="true" type="checkbox" class="markdown-todo"></input> Create link IDs that can be used to cache related content</li>
<li class="task-list-item"><input disabled="true" type="checkbox" class="markdown-todo"></input> Integrate it into the site to be able to make context pages here.</li>
<li class="task-list-item"><input disabled="true" type="checkbox" class="markdown-todo"></input> Check if a link is still available at build time and rebuild the block with links to an archived link</li>
</ul>
<h2 id="day-6" tabindex="-1">Day 6</h2>
<p>It looks like if I want to get any more complicated than the basics of the Wayback Machine's <code>/save/</code> URL, I'll likely need to explore the Memento API structure. So, we'll <a href="http://mementoweb.org/guide/quick-intro/" target="_blank">start with the Memento intro</a>.</p>
<h3 id="examining-memento" tabindex="-1">Examining Memento</h3>
<p>Ok the main points here are that there are three Memento entities joined over a link-based time map:</p>
<ul>
<li>TimeGate</li>
<li>TimeMap</li>
<li>Memento</li>
</ul>
<p>It seems that whoever builds the site would be responsible for the first two entities, so I want to really (at least for now) drill down into the Mementos. There is <a href="http://mementoweb.org/guide/rfc/#overview" target="_blank">a spec for Mementos</a> as well and <a href="https://www.slideshare.net/hvdsomp/memento-101" target="_blank">a useful slideshow</a>. But most of this is looking at the access protocol, not the actual process of creating the archive.</p>
<p>Let's look for some guidance from the Archive Team projects. There are a few places that might be useful starts. There's <a href="https://github.com/ArchiveTeam/grab-site" target="_blank">grab-site</a> and <a href="https://github.com/ArchiveTeam/wpull" target="_blank">wpull</a>.</p>
<p>I think the place to start is running a little test of <code>grab-site</code> locally. Let's try it out.</p>
<h3 id="adding-readability-to-the-link-object" tabindex="-1">Adding Readability to the Link Object</h3>
<p>I also wonder if it makes sense to have a less complex archive shipped in this initial package, like taking the already downloaded HTML document and processing it <a href="https://github.com/mozilla/readability" target="_blank">with Readability</a>.</p>
<p>I'll start with <code>npm install @mozilla/readability</code> and incorporate it into building my link object.</p>
<p>Like I did with the other sources of metadata, I'll add it to the core object so people can do what they wish with it when they pull in this package. Let's make sure that this new property is properly covered with unit tests.</p>
<p><a target="_blank" href="https://github.com/AramZS/contexter/commit/7571ed989d9a6287894b2254bac14dfa990d9915" class="git-commit-link"><code>git commit -am &quot;Add readability object to output&quot;</code></a></p>
<p>Ok. I got that working!</p>
<h3 id="trying-out-grab-site" tabindex="-1">Trying out grab-site</h3>
<p>I want to switch back--now that I've installed it--to <code>grab-site</code> and see how it works.</p>
<p>Hmmm, it does not. It appears I have some missing libraries here. I'll <a href="https://stackoverflow.com/questions/63972113/big-sur-clang-invalid-version-error-due-to-macosx-deployment-target" target="_blank">have to run some system level updates</a>. Let's see if that works.</p>
<p>It looks like the key was running <code>softwareupdate --all --install --force</code> and then <code>sudo xcode-select --switch /Applications/Xcode.app/</code> on my OSX machine. Yup, that got it working!</p>
<p>Wow, when I archive a page with no additional actions it crawls way deep into every related page and link huh? I was thinking it might be possible to run this <a href="https://github.com/actions/virtual-environments" target="_blank">in a Github Action virtual machine</a>. But if I even want to try that I'll have to think about <a href="https://github.com/ArchiveTeam/grab-site#grab-site-options-ordered-by-importance" target="_blank">ways to limit it</a>. And on top of everything else, <code>grab-site</code> at least creates WARC files, which aren't ready to deploy to a static site that can then be browsed in a normal browser the way I would want to have this work. I'd either have to find different tools or some way to transform the WARC file into a browser accessible website. I'm sure there's a way, perhaps <a href="https://replayweb.page/docs/embedding" target="_blank">this ReplayWeb package</a> or some <a href="https://github.com/webrecorder/wabac.js" target="_blank">other</a> method, but I'll have to dig into it.</p>
<p>As I'm starting to examine <code>grab-site</code> and <code>wpull</code> and I'm wondering if building a Memento of a site is something that is going to be easy to do in Node. There are some utilities that it looks like have been adapted from Python into node that I can explore: <a href="https://github.com/webrecorder/warcio.js" target="_blank">warcio.js</a> and <a href="https://github.com/N0taN3rd/node-warc" target="_blank">node-warc</a>. At least if I do go down that route it will be a major project. It looks like I can also <a href="https://archiveweb.page/guide" target="_blank">look at ArchiveWeb as a possible tool to emulate</a> or <a href="https://webrecorder.net/tools" target="_blank">some related tools</a>? It might make more sense to handle it in another way. It's still worth digging into, but I'm wondering if I need to put a more complex archiving process aside to work on some other components. Let's put a pin in it for now.</p>
<p>Ok, I think it's a good place to stop for tonight!</p>

                    
                    </section>
                    <section id="postcontent">
                    
    <script src="https://utteranc.es/client.js"
            repo="AramZS/fightwithtools-comments"
            issue-term="title"
            theme="github-dark"
            crossorigin="anonymous"
            async>
    </script>
    
        
        
        <div class="pagination">
            <a href="/posts/projects/context-pages/day-5/" class="pagination-link cursor-pointer ">Previous Day</a>

            <a href="/posts/projects/context-pages/day-7/" class="pagination-link cursor-pointer ">Next Day</a>
        </div>
    
    <div class="social-icons-block">
    <div class="a-social-icon">
        <a href="https://github.com/AramZS/" target="_blank">
            <svg role="img" viewBox="0 0 24 24" class="twitter-icon social-icon" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>


<!-- https://simpleicons.org/?q=github -->

        </a>
    </div>
    <div class="a-social-icon">
        <a href="https://bit.ly/aramzs" target="_blank">
            <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>


<!-- https://simpleicons.org/?q=linked -->

        </a>
    </div>
    <div class="a-social-icon">
        <a href="https://twitter.com/Chronotope" target="_blank">
            <svg role="img" class="twitter-icon social-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Twitter</title><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/></svg>

<!-- https://simpleicons.org/?q=tw -->

        </a>
    </div>
    
    <div class="a-social-icon">
        <a href="https://indieweb.social/@Chronotope" rel="me" target="_blank">
            <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Mastodon</title><path d="M23.193 7.88c0-5.207-3.411-6.733-3.411-6.733C18.062.357 15.108.025 12.041 0h-.076c-3.069.025-6.02.357-7.74 1.147 0 0-3.412 1.526-3.412 6.732 0 1.193-.023 2.619.015 4.13.124 5.092.934 10.11 5.641 11.355 2.17.574 4.034.695 5.536.612 2.722-.15 4.25-.972 4.25-.972l-.09-1.975s-1.945.613-4.13.54c-2.165-.075-4.449-.234-4.799-2.892a5.5 5.5 0 0 1-.048-.745s2.125.52 4.818.643c1.646.075 3.19-.097 4.758-.283 3.007-.359 5.625-2.212 5.954-3.905.517-2.665.475-6.508.475-6.508zm-4.024 6.709h-2.497v-6.12c0-1.29-.543-1.944-1.628-1.944-1.2 0-1.802.776-1.802 2.313v3.349h-2.484v-3.35c0-1.537-.602-2.313-1.802-2.313-1.085 0-1.628.655-1.628 1.945v6.119H4.831V8.285c0-1.29.328-2.314.987-3.07.68-.759 1.57-1.147 2.674-1.147 1.278 0 2.246.491 2.886 1.474L12 6.585l.622-1.043c.64-.983 1.608-1.474 2.886-1.474 1.104 0 1.994.388 2.674 1.146.658.757.986 1.781.986 3.07v6.305z"/></svg>

<!-- https://simpleicons.org/?q=mastodon -->

        </a>
    </div>

</div>


                    </section>
                </main>
                <footer>
                    
    <div id="taglist">
        <h6>Tags: </h6>
        <ul><li>
                    <a href="https://fightwithtools.dev/tag/11ty">11ty</a>
                </li><li>
                    <a href="https://fightwithtools.dev/tag/node">Node</a>
                </li><li>
                    <a href="https://fightwithtools.dev/tag/wip">WiP</a>
                </li><li>
                    <a href="https://fightwithtools.dev/tag/archiving">archiving</a>
                </li><li>
                    <a href="https://fightwithtools.dev/tag/internet-archive">Internet Archive</a>
                </li><li>
                    <a href="https://fightwithtools.dev/tag/research">research</a>
                </li><li>
                    <a href="https://fightwithtools.dev/tag/memento-api">Memento API</a>
                </li><li>
                    <a href="https://fightwithtools.dev/tag/memento">Memento</a>
                </li></ul>
    </div>

                    
                        <p>
                            <small>Hosted on <a href="https://pages.github.com" target="_blank">GitHub Pages</a> based on <a href="https://github.com/pages-themes/dinky" target="_blank">the Dinky theme</a>. <a href="https://github.com/AramZS/devblog" target="_blank">See the code</a>.</small>
                        </p>
                    
                    
                </footer>
            </div>
            <!--[if !IE]><script>fixScale(document);</script><![endif]-->
        </body>
    </html>
