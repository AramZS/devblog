<!doctype html>
    <html lang="en-US" id="template-post" class="base">
        <head>
        
        <script defer data-domain="fightwithtools.dev" src="https://plausible.io/js/plausible.js"></script>
        <link rel="alternate" type="application/rss+xml" title="Fight With Tools: A Dev Blog RSS" href="https://fightwithtools.dev/rss/" />
    	<link rel="alternate" type="application/atom+xml" title="Fight With Tools: A Dev Blog Feed" href="https://fightwithtools.dev/feed/" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Part 34: In Which I Really Dig Into Markdown It</title>
        
            <!-- Sub Template: post -->
        
        
            <link rel="preload" as="font">
            <link href="https://fightwithtools.dev/assets/prism-okaidia.css" rel="preload" as="style" />
            <link href="https://fightwithtools.dev/assets/prism-okaidia.css" rel="stylesheet" />
            <!-- <link rel="stylesheet" href="https://fightwithtools.dev/assets/css/style.css?v=4994421814" /> -->
            <link rel="stylesheet" href="https://fightwithtools.dev/assets/css/style.css?v=4994421814" id=""></link>

            
                <!-- <link rel="stylesheet" href="https://fightwithtools.dev/assets/css/template-post.css?v=4994421814" /> -->
                <link rel="stylesheet" href="https://fightwithtools.dev/assets/css/template-post.css?v=4994421814" id=""></link>

            
            <!-- Build Revision: 4994421814 & Sha: 3f8dd15a0519816a5cd99c8c7adb43561b5db6c5 -->
            <script src="https://fightwithtools.dev/assets/js/scale.fix.js" async></script>
            <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
            <!--[if lt IE 9]>
                <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
            <![endif]-->
        
        
            <!-- The Author meta propagates the byline in a number of social networks -->
<meta name="author" content="Aram Zucker-Scharff" />

<meta property="og:title"
    content="Part 34: In Which I Really Dig Into Markdown It">

<meta property="og:description"
    content="More devblog">


<meta property="og:url"
    content="https://fightwithtools.dev/posts/projects/devblog/hello-day-34/" />

<meta property="og:site_name" content="Fight With Tools: A Dev Blog" />

<meta property="og:locale" content="en_US" />

<meta name="twitter:site" content="@chronotope" />

<meta name="twitter:description" content="More devblog" />

<meta name="description" content="More devblog">

<!-- I prefer the summary_large_image Twitter card for posts. -->
<meta name="twitter:card" content="summary_large_image" />
<!-- You, you're the creator. -->
<meta name="twitter:creator" content="@chronotope" />
<!-- This property is for the article title, not site title. -->
<meta name="twitter:title" content="Part 34: In Which I Really Dig Into Markdown It" />



<meta property="og:image" content="https://fightwithtools.dev/img/close-up-keys.jpg" />
<meta name="twitter:image" content="https://fightwithtools.dev/img/close-up-keys.jpg" />




    <!-- Article specific OG data -->
    <!-- The OG:Type dictates a number of other tags on posts. -->
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="Sat, 13 Nov 2021 02:59:43 GMT" />

    <!-- page.modified isn't a natural Jekyll property, but it can be added. -->
    

    <!-- Here my author and publisher tags are the same (yay self-publishing) -->
    <meta property="article:author" content="http://facebook.com/aramzs" />
    <!-- But if your site has its own page, this is where to put it. -->
    <meta property="article:publisher" content="https://www.facebook.com/aramzs" />

    
    <!-- Article section isn't a required property, but it can be good to have -->
    <meta property="article:section" content="Dev Blog" />
    

    
        <!-- I use the page.categories property for OG tags. -->
        
        <meta property="article:tag" content="posts" />
        
        <meta property="article:tag" content="projects" />
        
        <meta property="article:tag" content="Starters" />
        
        <meta property="article:tag" content="11ty" />
        
        <meta property="article:tag" content="Node" />
        
        <meta property="article:tag" content="WiP" />
        
        <meta property="article:tag" content="Markdown-It" />
        
        <meta name="keywords" content="posts, projects, Starters, 11ty, Node, WiP, Markdown-It">
    



            <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Blog",
        "url": "https://fightwithtools.dev/posts/projects/devblog/hello-day-34/",
        "headline": "Part 34: In Which I Really Dig Into Markdown It",
        "about": "More devblog",
        "image": [
            "https://41.media.tumblr.com/709bb3c371b9924add351bfe3386e946/tumblr_nxdq8uFdx81qzocgko1_1280.jpg"
        ],
        "isAccessibleForFree": "True",
        "isPartOf": {
            "@type": ["CreativeWork", "Product"],
            "name": "Fight With Tools",
            "productID": "fightwithtools.dev"
        },
        "discussionUrl": "https://twitter.com/search?q=to%3AChronotope%20%23dev&src=typed_query&f=top",
        "author": {
    "@type": "Person",
    "name": {
        "@type": "PronounceableText",
        "inLanguage": "en-US",
        "textValue": "Aram Zucker-Scharff",
        "speechToTextMarkup": "IPA",
        "phoneticText": "/ˌæ.ɹəm ˈt͡sʊ.kɚ 'ʃɑɹf/"
    },
    "description": "Aram Zucker-Scharff is Lead Privacy Engineer at The Washington Post, lead dev for PressForward and a consultant. Tech solutions for journo problems.",
    "disambiguatingDescription": "A media-focused developer and strategist.",
    "sameAs": "http://aramzs.github.io/aramzs/",
    "image": {
        "@type": "ImageObject",
        "url": "https://raw.githubusercontent.com/AramZS/aramzs.github.io/master/_includes/Aram-Zucker-Scharff-square.jpg"
    },
    "givenName": "Aram",
    "familyName": "Zucker-Scharff",
    "alternateName": "AramZS",
    "publishingPrinciples": "http://aramzs.github.io/about/"
}, 
        "editor": {
    "@type": "Person",
    "name": {
        "@type": "PronounceableText",
        "inLanguage": "en-US",
        "textValue": "Aram Zucker-Scharff",
        "speechToTextMarkup": "IPA",
        "phoneticText": "/ˌæ.ɹəm ˈt͡sʊ.kɚ 'ʃɑɹf/"
    },
    "description": "Aram Zucker-Scharff is Lead Privacy Engineer at The Washington Post, lead dev for PressForward and a consultant. Tech solutions for journo problems.",
    "disambiguatingDescription": "A media-focused developer and strategist.",
    "sameAs": "http://aramzs.github.io/aramzs/",
    "image": {
        "@type": "ImageObject",
        "url": "https://raw.githubusercontent.com/AramZS/aramzs.github.io/master/_includes/Aram-Zucker-Scharff-square.jpg"
    },
    "givenName": "Aram",
    "familyName": "Zucker-Scharff",
    "alternateName": "AramZS",
    "publishingPrinciples": "http://aramzs.github.io/about/"
},
        "inLanguage": "en-US",
        "license": "http://creativecommons.org/licenses/by-sa/4.0/",
        "additionalType": "CreativeWork",
        "alternateName": "Fight With Tools Dev",
        "publisher": {
            "@type": "Organization",
            "name": "Fight With Tools",
            "description": "A site discussing how to imagine, build, analyze and use cool code and web tools. Better websites, better stories, better developers. Technology won't save the world, but you can.",
            "sameAs": "https://fightwithtools.dev/",
            "logo": {
                "@type": "ImageObject",
                "url": "https://41.media.tumblr.com/709bb3c371b9924add351bfe3386e946/tumblr_nxdq8uFdx81qzocgko1_1280.jpg"
            },
            "publishingPrinciples": "http://aramzs.github.io/about/"
        }
    }
</script>

        
        
        
<link rel="canonical" href="https://fightwithtools.dev/posts/projects/devblog/hello-day-34/" />

        </head>
        <body itemscope itemtype="https://schema.org/Blog">
            <div class="wrapper">
                <header>
                    
                        
                            <div id="site-name-subhead">
                                <a href="https://fightwithtools.dev">Fight With Tools: A Dev Blog</a>
                                
                                    > <a id="project-link" href="https://fightwithtools.dev/projects/devblog">Dev Blog</a>
                                
                            </div>
                        
                        
                            <!-- post mode -->
                            <time>Sat Nov 13 2021</time>
                            <!-- front matter dates made in format at https://yaml.org/type/timestamp.html -->
                        
                        
                            <!-- projects mode -->
                        
                        <h1 class="header">
                            Part 34: In Which I Really Dig Into Markdown It
                        </h1>
                        
                        
                    
                    
    <h5 itemprop="author" itemscope itemtype="https://schema.org/Person">
    <link itemprop="sameAs" href="http://aramzs.github.io/aramzs/" />
    By <span itemprop="name"><a href="http://aramzs.github.io/aramzs/" target="_blank">Aram Zucker-Scharff</a></span>
</h5>

                </header>
                <main>
                    
    <section id="precontent">
        <aside id="toc-container">
            <div id="toc-container__inner">
                <h2>Contents</h2>
                <nav class="toc">
        <ol><li><a href="#project-scope-and-todos">Project Scope and ToDos</a></li><li><a href="#day-34">Day 34</a><ol><li><a href="#modifying-the-markdown-it-plugin">Modifying the Markdown-It Plugin</a></li><li><a href="#better-replacement-of-words">Better replacement of words</a><ol><li><a href="#a-more-complex-markdown-it-token">A More Complex Markdown-It Token</a></li></ol></li><li><a href="#handle-each-token-child">Handle each token child</a></li><li><a href="#replacing-the-word-with-punctuation">Replacing the word with punctuation</a></li></ol></li><li><a href="#a-few-notes-on-touch-up">A few notes on touch up</a></li></ol></nav>
            </div>
        </aside>
        <div id="post-description">More devblog</div>

        
    <figure class="figure preview-image">
        <img src="https://fightwithtools.dev/img/close-up-keys.jpg" alt="Close up photo of keyboard keys.">
        
            <figcaption class="figcaption">
                
                 | <em>
                        <a href="https://www.flickr.com/photos/40393390@N00/2386752252" target="_blank">'TYPE' by SarahDeer is licensed with CC BY 2.0</a>
                    </em> | 
            </figcaption>
        
    </figure>


    </section>

                    <section id="maincontent" class="maincontent">
                    
                        <h2 id="project-scope-and-todos" tabindex="-1">Project Scope and ToDos</h2>
<ol>
<li>Static Site Generator that can build the blog and let me host it on Github Pages</li>
<li>I want to write posts in Markdown because I'm lazy, it's easy, and it is how I take notes now.</li>
<li>I don't want to spend a ton of time doing design work. I'm doing complicated designs for other projects, so I want to pull a theme I like that I can rely on someone else to keep up.</li>
<li>Once it gets going, I want template changes to be easy.</li>
<li>It should be as easy as Jekyll, so I need to be able to build it using GitHub Actions, where I can just commit a template change or Markdown file and away it goes. If I can't figure this out than fk it, just use Jekyll.</li>
<li>I require it to be used by a significant percent of my professional peers so I can get easy answers when something goes wrong.</li>
<li>I want source maps. This is a dev log site which means whatever I do with it should be easy for other developers to read.</li>
</ol>
<ul class="task-list">
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Also <a href="https://www.npmjs.com/package/@quasibit/eleventy-plugin-sitemap" target="_blank">the sitemap plugin</a> looks cool. Should grab that later.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo"></input> So does the <a href="https://www.npmjs.com/package/eleventy-plugin-reading-time" target="_blank">reading time one</a>.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Also <a href="https://github.com/jdsteinbach/eleventy-plugin-toc/" target="_blank">this TOC plugin</a> mby?</p>
</li>
<li class="task-list-item">
<p data-wordfix="true"><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Use <a href="https://www.11ty.dev/docs/data-deep-merge/" target="_blank">Data Deep Merge</a> in this blog.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Decide if I want to render the CSS fancier than just a base file and do per-template splitting.</p>
</li>
</ul>
<s>
<ul class="task-list">
<li class="task-list-item"><input disabled="true" type="checkbox" class="markdown-todo"></input> Can I use the template inside of dinky that already exists instead of copy/pasting it?</li>
</ul>
</s>
<s>
<ul class="task-list">
<li class="task-list-item"><input disabled="true" type="checkbox" class="markdown-todo"></input> Is there a way to have permalinks to posts contain metadata without organizing them into subfolders?</li>
</ul>
</s>
<ul class="task-list">
<li class="task-list-item">
<p data-wordfix="true"><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> How do I cachebreak files on the basis of new build events? Datetime? <code>site.github.build_revision</code> is <a href="https://github.com/jekyll/github-metadata/blob/master/docs/site.github.md" target="_blank">how Jekyll accomplishes this</a>, but is there a way to push <a href="https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context" target="_blank">that</a> <a href="https://stackoverflow.com/questions/54310050/how-to-version-build-artifacts-using-github-actions" target="_blank">into the build process</a> for Eleventy?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Make link text look less shitty. It looks like it is a whole, lighter, font.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Code blocks do not have good syntax highlighting. I want good syntax highlighting.</p>
</li>
<li class="task-list-item">
<p data-wordfix="true"><input disabled="true" type="checkbox" class="markdown-todo"></input> Build a Markdown-it plugin to take my typing shortcuts <code>[prob, b/c, ...?]</code> and expand them on build.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo"></input> See if we can start Markdown's interpretation of H tags to <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/Heading_Elements#multiple_h1" target="_blank">start at 2, since H1</a> is always pulled from the page title metadata. If it isn't easy, I just have to change my pattern of writing in the MD documents.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Should I <a href="https://www.madebymike.com.au/writing/11ty-filters-data-shortcodes/" target="_blank">explore some shortcodes</a>?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Order projects listing by last posted blog in that project</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Limit the output of home page post lists to a specific number of posts</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Show the latest post below the site intro on the homepage.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Tags pages with Pagination</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo"></input> Posts should be able to support a preview header image that can also be shown on post lists.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo"></input> Create a Markdown-It plugin that reads the project's repo URL off the folder data file and renders commit messages with <a href="https://stackoverflow.com/questions/15919635/on-github-api-what-is-the-best-way-to-get-the-last-commit-message-associated-w" target="_blank">links to the referenced commit</a>. (Is this even possible?) (Is there a way to do it with eleventy instead?)</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Create Next Day/Previous Day links on each post / Next/Previous post on post templates from projects</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Tags should be in the sidebar of articles and link to tag pages</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Create a skiplink for the todo section (or would this be better served with the ToC plugin?) - Yes it would be!</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Add a Things I Learned section to the project pages that are the things I learned from that specific project.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Add a technical reading log to the homepage</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/:empty" target="_blank">Hide</a> empty sections.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Add byline to post pages</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Have table of contents attach to sidebar bottom on mobile</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Support dark mode</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Social Icons</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> SEO/Social/JSON-LD HEAD data</p>
</li>
</ul>
<h2 id="day-34" tabindex="-1">Day 34</h2>
<p>Ok, took some real vacation time, so on the flight back and back to work on trying to build my own markdown-it plugin.</p>
<h3 id="modifying-the-markdown-it-plugin" tabindex="-1">Modifying the Markdown-It Plugin</h3>
<p>Ok, dealing with some errors when it does processing. But I made a good choice this time before getting on the flight, I loaded up the documentation page on Markdown-It. The problem is I needed to give my rule a unique (non-overlapping name with the to-do rule).</p>
<p>Changed it to <code>md.core.ruler.after(&quot;inline&quot;, &quot;short-phrase-fixer&quot;, (state) =&gt; {</code> and now the plugin isn't crashing the build process!</p>
<p>But it isn't doing what I want either.</p>
<p>Ok, it's advancing to the point in the while loop where it is executing my function. That's good, it means my check to find valid language to replace <code>isMyWords</code> is working properly I think.</p>
<p>Ah, ok, it looks like I am absolutely required to change the content of both the token and it's first child. Interesting, I'm not sure why Markdown-it works that way, but good to know. Ok, basic functionality is working! Looks like this now:</p>
<p class="skip-link-graf">
<a href="#code-skip-hello-day-34-10" id="skip-to-code-skip-hello-day-34-10" class="skip-link">Skip code block ▼</a></p>
<pre class="language-javascript"><code class="language-javascript"><br><span class="token keyword">const</span> <span class="token function-variable function">isInline</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">token</span><span class="token punctuation">)</span> <span class="token operator">=></span> token <span class="token operator">&amp;&amp;</span> token<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">"inline"</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token function-variable function">isParagraph</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">token</span><span class="token punctuation">)</span> <span class="token operator">=></span> token <span class="token operator">&amp;&amp;</span> token<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">"paragraph_open"</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token function-variable function">hasMyWords</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">token</span><span class="token punctuation">)</span> <span class="token operator">=></span> token <span class="token operator">&amp;&amp;</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex"> 11ty | prob </span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">function</span> <span class="token function">setAttr</span><span class="token punctuation">(</span><span class="token parameter">token<span class="token punctuation">,</span> name<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>	<span class="token keyword">const</span> index <span class="token operator">=</span> token<span class="token punctuation">.</span><span class="token function">attrIndex</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">const</span> attr <span class="token operator">=</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> value<span class="token punctuation">]</span><span class="token punctuation">;</span><br><br>	<span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>		token<span class="token punctuation">.</span><span class="token function">attrPush</span><span class="token punctuation">(</span>attr<span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>		token<span class="token punctuation">.</span>attrs<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> attr<span class="token punctuation">;</span><br>	<span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">function</span> <span class="token function">isMyWords</span><span class="token punctuation">(</span><span class="token parameter">tokens<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>	<span class="token keyword">return</span> <span class="token punctuation">(</span><br>		<span class="token function">isInline</span><span class="token punctuation">(</span>tokens<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span><br>		<span class="token function">hasMyWords</span><span class="token punctuation">(</span>tokens<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span><br>	<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">function</span> <span class="token function">fixMyWords</span><span class="token punctuation">(</span><span class="token parameter">token<span class="token punctuation">,</span> TokenConstructor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>	<span class="token keyword">let</span> wordChoice <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span><br>	<span class="token keyword">const</span> betterWord <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TokenConstructor</span><span class="token punctuation">(</span><span class="token string">"inline"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex"> 11ty </span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>		betterWord<span class="token punctuation">.</span>content <span class="token operator">=</span> <span class="token string">" Eleventy "</span><span class="token punctuation">;</span><br>		wordChoice <span class="token operator">=</span> <span class="token string">" 11ty "</span><span class="token punctuation">;</span><br>	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex"> prob </span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>		betterWord<span class="token punctuation">.</span>content <span class="token operator">=</span> <span class="token string">" probably "</span><span class="token punctuation">;</span><br>		wordChoice <span class="token operator">=</span> <span class="token string">" prob "</span><span class="token punctuation">;</span><br>	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>		<span class="token keyword">return</span> <span class="token punctuation">{</span> betterWord<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> wordChoice<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>	<span class="token punctuation">}</span><br><br>	<span class="token keyword">return</span> <span class="token punctuation">{</span> betterWord<span class="token punctuation">,</span> wordChoice <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">function</span> <span class="token function">fixWordify</span><span class="token punctuation">(</span><span class="token parameter">token<span class="token punctuation">,</span> TokenConstructor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>	<span class="token keyword">const</span> <span class="token punctuation">{</span> betterWord<span class="token punctuation">,</span> wordChoice <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">fixMyWords</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> TokenConstructor<span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>betterWord<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><br>	token<span class="token punctuation">.</span>content <span class="token operator">=</span> token<span class="token punctuation">.</span>content<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>wordChoice<span class="token punctuation">,</span> betterWord<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">const</span> fixedContent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TokenConstructor</span><span class="token punctuation">(</span><span class="token string">"inline"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>	fixedContent<span class="token punctuation">.</span>content <span class="token operator">=</span> token<span class="token punctuation">.</span>content<span class="token punctuation">;</span><br>	token<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>content <span class="token operator">=</span> fixedContent<span class="token punctuation">.</span>content<span class="token punctuation">;</span><br>	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"token:"</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">md</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>	md<span class="token punctuation">.</span>core<span class="token punctuation">.</span>ruler<span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span><span class="token string">"inline"</span><span class="token punctuation">,</span> <span class="token string">"short-phrase-fixer"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>		<span class="token keyword">const</span> tokens <span class="token operator">=</span> state<span class="token punctuation">.</span>tokens<span class="token punctuation">;</span><br>		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><br>			<span class="token string">"Walking through possible words to fix3"</span><span class="token punctuation">,</span><br>			state<span class="token punctuation">.</span>tokens<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">token</span><span class="token punctuation">)</span> <span class="token operator">=></span> token<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">"text"</span><span class="token punctuation">)</span><br>		<span class="token punctuation">)</span><span class="token punctuation">;</span><br>		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> tokens<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tokens<span class="token punctuation">,</span> <span class="token function">isMyWords</span><span class="token punctuation">(</span>tokens<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Trying to fix some words!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>				<span class="token function">fixWordify</span><span class="token punctuation">(</span>tokens<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> state<span class="token punctuation">.</span>Token<span class="token punctuation">)</span><span class="token punctuation">;</span><br>				<span class="token function">setAttr</span><span class="token punctuation">(</span>tokens<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"data-wordfix"</span><span class="token punctuation">,</span> <span class="token string">"true"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>			<span class="token punctuation">}</span><br>		<span class="token punctuation">}</span><br>	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p id="code-skip-hello-day-34-10">But what if more than one word that I need to correct is in the paragraph? I'll need to set it up to run more than once on any piece of content, or do a smarter replace process.</p>
<h3 id="better-replacement-of-words" tabindex="-1">Better replacement of words</h3>
<p>So what if I want to use both <code>prob</code> and <code>11ty</code> in a sentence or if I want to use <code>11ty</code> twice? I need to set it up so I can use both.</p>
<p>Ok, so my instinct here is to set up a set of patterns and their replacements than walk through it. Only, I'm getting an error <code>token.content.replaceAll is not a function</code>. Ok, is this applying to everything or is there some weird edge case?</p>
<p>I'm going to try this for the new <code>fixWordify</code> setup.</p>
<p class="skip-link-graf">
<a href="#code-skip-hello-day-34-9" id="skip-to-code-skip-hello-day-34-9" class="skip-link">Skip code block ▼</a></p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> replaceMe <span class="token operator">=</span> <span class="token punctuation">[</span><br>		<span class="token punctuation">{</span> pattern<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex"> 11ty </span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> replace<span class="token operator">:</span> <span class="token string">" Eleventy "</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>		<span class="token punctuation">{</span> pattern<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex"> prob </span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> replace<span class="token operator">:</span> <span class="token string">" probably "</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>		<span class="token punctuation">{</span> pattern<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex"> graf </span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> replace<span class="token operator">:</span> <span class="token string">" paragraph "</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>	<span class="token punctuation">]</span><span class="token punctuation">;</span><br>	<span class="token keyword">try</span> <span class="token punctuation">{</span><br>		replaceMe<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">wordReplace</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>			<span class="token keyword">const</span> betterWord <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TokenConstructor</span><span class="token punctuation">(</span><span class="token string">"inline"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>			betterWord<span class="token punctuation">.</span>content <span class="token operator">=</span> token<span class="token punctuation">.</span>content<span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><br>				wordReplace<span class="token punctuation">.</span>pattern<span class="token punctuation">,</span><br>				wordReplace<span class="token punctuation">.</span>replace<br>			<span class="token punctuation">)</span><span class="token punctuation">;</span><br>			token<span class="token punctuation">.</span>content <span class="token operator">=</span> betterWord<span class="token punctuation">.</span>content<span class="token punctuation">;</span><br>			token<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>content <span class="token operator">=</span> betterWord<span class="token punctuation">.</span>content<span class="token punctuation">;</span><br>			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"token:"</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span><span class="token punctuation">;</span><br>		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Could not replace content in token: "</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span><span class="token punctuation">;</span><br>		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token punctuation">}</span></code></pre>
<p id="code-skip-hello-day-34-9">Ok, now build continues, but notably the replacements don't seem to be happening. So it looks like it is breaking every time. Some of the tokens are indeed very complex like:</p>
<h4 id="a-more-complex-markdown-it-token" tabindex="-1">A More Complex Markdown-It Token</h4>
<p class="skip-link-graf">
<a href="#code-skip-hello-day-34-8" id="skip-to-code-skip-hello-day-34-8" class="skip-link">Skip code block ▼</a></p>
<pre class="language-javascript"><code class="language-javascript">Token <span class="token punctuation">{</span><br>  type<span class="token operator">:</span> <span class="token string">'inline'</span><span class="token punctuation">,</span><br>  tag<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>  attrs<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>  map<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token number">83</span> <span class="token punctuation">]</span><span class="token punctuation">,</span><br>  nesting<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span><br>  level<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span><br>  children<span class="token operator">:</span> <span class="token punctuation">[</span><br>    Token <span class="token punctuation">{</span><br>      type<span class="token operator">:</span> <span class="token string">'text'</span><span class="token punctuation">,</span><br>      tag<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>      attrs<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      map<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      nesting<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span><br>      level<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span><br>      children<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      content<span class="token operator">:</span> <span class="token string">"First of all, I want a chunk of that page that shows my various Work in Progress posts. I've tagged the posts themselves correctly "</span><span class="token punctuation">,</span><br>      markup<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>      info<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>      meta<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      block<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><br>      hidden<span class="token operator">:</span> <span class="token boolean">false</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    Token <span class="token punctuation">{</span><br>      type<span class="token operator">:</span> <span class="token string">'link_open'</span><span class="token punctuation">,</span><br>      tag<span class="token operator">:</span> <span class="token string">'a'</span><span class="token punctuation">,</span><br>      attrs<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      map<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      nesting<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span><br>      level<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span><br>      children<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      content<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>      markup<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>      info<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>      meta<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      block<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><br>      hidden<span class="token operator">:</span> <span class="token boolean">false</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    Token <span class="token punctuation">{</span><br>      type<span class="token operator">:</span> <span class="token string">'text'</span><span class="token punctuation">,</span><br>      tag<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>      attrs<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      map<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      nesting<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span><br>      level<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span><br>      children<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      content<span class="token operator">:</span> <span class="token string">'to create an 11ty collection'</span><span class="token punctuation">,</span><br>      markup<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>      info<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>      meta<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      block<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><br>      hidden<span class="token operator">:</span> <span class="token boolean">false</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    Token <span class="token punctuation">{</span><br>      type<span class="token operator">:</span> <span class="token string">'link_close'</span><span class="token punctuation">,</span><br>      tag<span class="token operator">:</span> <span class="token string">'a'</span><span class="token punctuation">,</span><br>      attrs<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      map<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      nesting<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><br>      level<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span><br>      children<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      content<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>      markup<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>      info<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>      meta<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      block<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><br>      hidden<span class="token operator">:</span> <span class="token boolean">false</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    Token <span class="token punctuation">{</span><br>      type<span class="token operator">:</span> <span class="token string">'text'</span><span class="token punctuation">,</span><br>      tag<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>      attrs<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      map<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      nesting<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span><br>      level<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span><br>      children<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      content<span class="token operator">:</span> <span class="token string">", but I need to figure out how to call it. And I may want to display it elsewhere, so I'm going to create a component I can easily include that walks through the WiP tag."</span><span class="token punctuation">,</span><br>      markup<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>      info<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>      meta<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>      block<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><br>      hidden<span class="token operator">:</span> <span class="token boolean">false</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">]</span><span class="token punctuation">,</span><br>  content<span class="token operator">:</span> <span class="token string">"First of all, I want a chunk of that page that shows my various Work in Progress posts. I've tagged the posts themselves correctly [to create an 11ty collection](https://www.11ty.dev/docs/collections/), but I need to figure out how to call it. And I may want to display it elsewhere, so I'm going to create a component I can easily include that walks through the WiP tag."</span><span class="token punctuation">,</span><br>  markup<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>  info<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>  meta<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>  block<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>  hidden<span class="token operator">:</span> <span class="token boolean">false</span><br><span class="token punctuation">}</span></code></pre>
<p id="code-skip-hello-day-34-8">But some are simple. And they all have content I can replace.</p>
<p>Ok, let's add more detail to the log.</p>
<p class="skip-link-graf">
<a href="#code-skip-hello-day-34-7" id="skip-to-code-skip-hello-day-34-7" class="skip-link">Skip code block ▼</a></p>
<pre class="language-javascript"><code class="language-javascript">		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><br>			<span class="token string">"Could not replace content in token: "</span><span class="token punctuation">,</span><br>			token<span class="token punctuation">.</span>content<span class="token punctuation">,</span><br>			token<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>content<span class="token punctuation">,</span><br>			token<br>		<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p id="code-skip-hello-day-34-7">I'm still not seeing what could go wrong. These things are strings and should have <code>replaceAll</code>? I double checked and indeed, <code>replace</code> works just fine. I guess we can just use <code>replace</code> if I have the right configuration for the regex, ending it with <code>/gi</code>.</p>
<p>Ok, that's working! Now let's remove my potential future human error opportunity by keeping the patterns I'm walking through in a single place:</p>
<p class="skip-link-graf">
<a href="#code-skip-hello-day-34-6" id="skip-to-code-skip-hello-day-34-6" class="skip-link">Skip code block ▼</a></p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">myWords</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>	<span class="token keyword">return</span> <span class="token punctuation">[</span><br>		<span class="token punctuation">{</span> pattern<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex"> 11ty </span><span class="token regex-delimiter">/</span><span class="token regex-flags">gi</span></span><span class="token punctuation">,</span> replace<span class="token operator">:</span> <span class="token string">" Eleventy "</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>		<span class="token punctuation">{</span> pattern<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex"> prob </span><span class="token regex-delimiter">/</span><span class="token regex-flags">gi</span></span><span class="token punctuation">,</span> replace<span class="token operator">:</span> <span class="token string">" probably "</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>		<span class="token punctuation">{</span> pattern<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex"> graf </span><span class="token regex-delimiter">/</span><span class="token regex-flags">gi</span></span><span class="token punctuation">,</span> replace<span class="token operator">:</span> <span class="token string">" paragraph "</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>	<span class="token punctuation">]</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p id="code-skip-hello-day-34-6">and now my check is a little more complex:</p>
<p class="skip-link-graf">
<a href="#code-skip-hello-day-34-5" id="skip-to-code-skip-hello-day-34-5" class="skip-link">Skip code block ▼</a></p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">hasMyWords</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">token</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>	<span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>		<span class="token comment">// myWords().forEach((word) => {</span><br>		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">myWords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">myWords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pattern<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Word Replacement Time"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>				<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><br>			<span class="token punctuation">}</span><br>		<span class="token punctuation">}</span><br>	<span class="token punctuation">}</span><br>	<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p id="code-skip-hello-day-34-5">Ok. Looking good. But it turns out this method doesn't handle the more complicated objects like the one above, instead of expecting only one child, we'll need to walk through all the children and do their replacements individually.</p>
<h3 id="handle-each-token-child" tabindex="-1">Handle each token child</h3>
<p>Ok, let's turn the <code>token.content</code> process into its own function I can use during the interation of token children:</p>
<p class="skip-link-graf">
<a href="#code-skip-hello-day-34-4" id="skip-to-code-skip-hello-day-34-4" class="skip-link">Skip code block ▼</a></p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">fixMyWords</span><span class="token punctuation">(</span><span class="token parameter">wordReplace<span class="token punctuation">,</span> token<span class="token punctuation">,</span> TokenConstructor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>	<span class="token keyword">const</span> betterWord <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TokenConstructor</span><span class="token punctuation">(</span><span class="token string">"inline"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">const</span> replaced <span class="token operator">=</span> token<span class="token punctuation">.</span>content<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><br>		wordReplace<span class="token punctuation">.</span>pattern<span class="token punctuation">,</span><br>		wordReplace<span class="token punctuation">.</span>replace<br>	<span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">if</span> <span class="token punctuation">(</span>replaced<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>		betterWord<span class="token punctuation">.</span>content <span class="token operator">=</span> replaced<span class="token punctuation">;</span><br>		token<span class="token punctuation">.</span>content <span class="token operator">=</span> betterWord<span class="token punctuation">.</span>content<span class="token punctuation">;</span><br>	<span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p id="code-skip-hello-day-34-4">Now we can use a simpler version of <code>replaceMe</code> that works with walking over the children!</p>
<p class="skip-link-graf">
<a href="#code-skip-hello-day-34-3" id="skip-to-code-skip-hello-day-34-3" class="skip-link">Skip code block ▼</a></p>
<pre class="language-javascript"><code class="language-javascript">replaceMe<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">wordReplace</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>	<span class="token function">fixMyWords</span><span class="token punctuation">(</span>wordReplace<span class="token punctuation">,</span> token<span class="token punctuation">,</span> TokenConstructor<span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> token<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>		<span class="token function">fixMyWords</span><span class="token punctuation">(</span>wordReplace<span class="token punctuation">,</span> token<span class="token punctuation">.</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> TokenConstructor<span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p id="code-skip-hello-day-34-3">That works!</p>
<p>Last thing I want to do... make sure this works if one of my replacement words is at the end of a sentence or has a comma after it and still needs to be replaced. I forgot about this case.</p>
<p><a target="_blank" href="https://github.com/AramZS/devblog/commit/e71045edccd9dcbeabb4828137b287a855a37a78" class="git-commit-link"><code>git commit -am &quot;Get replacement working with complex tokens&quot;</code></a></p>
<h3 id="replacing-the-word-with-punctuation" tabindex="-1">Replacing the word with punctuation</h3>
<p>This one should be pretty easy, I just need to add a look ahead for a variety of eligible punctuation. <code>(?=[\?\.\,\s\! ])</code> should do it.</p>
<p>Now the <code>myWords</code> function looks like this:</p>
<p class="skip-link-graf">
<a href="#code-skip-hello-day-34-2" id="skip-to-code-skip-hello-day-34-2" class="skip-link">Skip code block ▼</a></p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">myWords</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>	<span class="token keyword">return</span> <span class="token punctuation">[</span><br>		<span class="token punctuation">{</span> pattern<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex"> 11ty(?=[\?\.\,\s\! ])</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gi</span></span><span class="token punctuation">,</span> replace<span class="token operator">:</span> <span class="token string">" Eleventy"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>		<span class="token punctuation">{</span> pattern<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex"> prob(?=[\?\.\,\s\! ])</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gi</span></span><span class="token punctuation">,</span> replace<span class="token operator">:</span> <span class="token string">" probably"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>		<span class="token punctuation">{</span> pattern<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex"> graf(?=[\?\.\,\s\! ])</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gi</span></span><span class="token punctuation">,</span> replace<span class="token operator">:</span> <span class="token string">" paragraph"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>	<span class="token punctuation">]</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p id="code-skip-hello-day-34-2">I specifically don't want to include quotes in this But what about parenthesis? It looks like <code>Markdown-It</code> does indeed break out the chunks of text in such a way that I don't have to worry about breaking Markdown links. Should be easy enough. Just need a lookbehind. Also, I can add in new lines or tabs as characters as well.</p>
<p>Now it looks like this:</p>
<p class="skip-link-graf">
<a href="#code-skip-hello-day-34-1" id="skip-to-code-skip-hello-day-34-1" class="skip-link">Skip code block ▼</a></p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">myWords</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>	<span class="token keyword">return</span> <span class="token punctuation">[</span><br>		<span class="token punctuation">{</span><br>			pattern<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;=[\t\s\S\( ])11ty(?=[\?\.\,\s\r\n\!\) ])</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gi</span></span><span class="token punctuation">,</span><br>			replace<span class="token operator">:</span> <span class="token string">"Eleventy"</span><span class="token punctuation">,</span><br>		<span class="token punctuation">}</span><span class="token punctuation">,</span><br>		<span class="token punctuation">{</span><br>			pattern<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;=[\t\s\( ])prob(?=[\?\.\,\s\r\n\!\) ])</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gi</span></span><span class="token punctuation">,</span><br>			replace<span class="token operator">:</span> <span class="token string">"probably"</span><span class="token punctuation">,</span><br>		<span class="token punctuation">}</span><span class="token punctuation">,</span><br>		<span class="token punctuation">{</span><br>			pattern<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;=[\t\s\( ])graf(?=[\?\.\,\s\r\n\!\) ])</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gi</span></span><span class="token punctuation">,</span><br>			replace<span class="token operator">:</span> <span class="token string">"paragraph"</span><span class="token punctuation">,</span><br>		<span class="token punctuation">}</span><span class="token punctuation">,</span><br>	<span class="token punctuation">]</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p id="code-skip-hello-day-34-1">Looking good! I can test and add more words later, landing now.</p>
<ul class="task-list">
<li class="task-list-item"><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Build a Markdown-it plugin to take my typing shortcuts <code>[prob, b/c, ...?]</code> and expand them on build.</li>
</ul>
<p><a target="_blank" href="https://github.com/AramZS/devblog/commit/08a817d45c3cd5d9e888b640326159c8f3023c4f" class="git-commit-link"><code>git commit -am &quot;Finish day 34&quot;</code></a></p>
<h2 id="a-few-notes-on-touch-up" tabindex="-1">A few notes on touch up</h2>
<p>Just noting on here that I touched up the above Regex which had a few bad errors I didn't want anyone to repeat. Most importantly, I removed my use of <code>\S</code>.</p>
<p><a target="_blank" href="https://github.com/AramZS/devblog/commit/a901930b83fe4006c4f5759b0041f9192312585d" class="git-commit-link"><code>git commit -am &quot;Touch up day 34 stuff&quot;</code></a></p>

                    
                    </section>
                    <section id="postcontent">
                    
    
        
        
        <div class="pagination">
            <a href="/posts/projects/devblog/hello-day-33/" class="pagination-link cursor-pointer ">Previous Day</a>

            <a href="/posts/projects/devblog/hello-day-35/" class="pagination-link cursor-pointer ">Next Day</a>
        </div>
    
    <div class="social-icons-block">
    <div class="a-social-icon">
        <a href="https://github.com/AramZS/" target="_blank">
            <svg role="img" viewBox="0 0 24 24" class="twitter-icon social-icon" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>


<!-- https://simpleicons.org/?q=github -->

        </a>
    </div>
    <div class="a-social-icon">
        <a href="https://bit.ly/aramzs" target="_blank">
            <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>


<!-- https://simpleicons.org/?q=linked -->

        </a>
    </div>
    <div class="a-social-icon">
        <a href="https://twitter.com/Chronotope" target="_blank">
            <svg role="img" class="twitter-icon social-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Twitter</title><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/></svg>

<!-- https://simpleicons.org/?q=tw -->

        </a>
    </div>
    
    <div class="a-social-icon">
        <a href="https://indieweb.social/@Chronotope" rel="me" target="_blank">
            <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Mastodon</title><path d="M23.193 7.88c0-5.207-3.411-6.733-3.411-6.733C18.062.357 15.108.025 12.041 0h-.076c-3.069.025-6.02.357-7.74 1.147 0 0-3.412 1.526-3.412 6.732 0 1.193-.023 2.619.015 4.13.124 5.092.934 10.11 5.641 11.355 2.17.574 4.034.695 5.536.612 2.722-.15 4.25-.972 4.25-.972l-.09-1.975s-1.945.613-4.13.54c-2.165-.075-4.449-.234-4.799-2.892a5.5 5.5 0 0 1-.048-.745s2.125.52 4.818.643c1.646.075 3.19-.097 4.758-.283 3.007-.359 5.625-2.212 5.954-3.905.517-2.665.475-6.508.475-6.508zm-4.024 6.709h-2.497v-6.12c0-1.29-.543-1.944-1.628-1.944-1.2 0-1.802.776-1.802 2.313v3.349h-2.484v-3.35c0-1.537-.602-2.313-1.802-2.313-1.085 0-1.628.655-1.628 1.945v6.119H4.831V8.285c0-1.29.328-2.314.987-3.07.68-.759 1.57-1.147 2.674-1.147 1.278 0 2.246.491 2.886 1.474L12 6.585l.622-1.043c.64-.983 1.608-1.474 2.886-1.474 1.104 0 1.994.388 2.674 1.146.658.757.986 1.781.986 3.07v6.305z"/></svg>

<!-- https://simpleicons.org/?q=mastodon -->

        </a>
    </div>

</div>


                    </section>
                </main>
                <footer>
                    
    <div id="taglist">
        <h6>Tags: </h6>
        <ul><li>
                    <a href="https://fightwithtools.dev/tag/starters">Starters</a>
                </li><li>
                    <a href="https://fightwithtools.dev/tag/11ty">11ty</a>
                </li><li>
                    <a href="https://fightwithtools.dev/tag/node">Node</a>
                </li><li>
                    <a href="https://fightwithtools.dev/tag/wip">WiP</a>
                </li><li>
                    <a href="https://fightwithtools.dev/tag/markdown-it">Markdown-It</a>
                </li></ul>
    </div>

                    
                        <p>
                            <small>Hosted on <a href="https://pages.github.com" target="_blank">GitHub Pages</a> based on <a href="https://github.com/pages-themes/dinky" target="_blank">the Dinky theme</a>. <a href="https://github.com/AramZS/devblog" target="_blank">See the code</a>.</small>
                        </p>
                    
                    
                </footer>
            </div>
            <!--[if !IE]><script>fixScale(document);</script><![endif]-->
        </body>
    </html>
