

<!doctype html>
    <html lang="en-US" id="template-archives" class="base">
        <head>
        
        <script defer data-domain="fightwithtools.dev" src="https://plausible.io/js/plausible.js"></script>
        <link rel="alternate" type="application/rss+xml" title="Fight With Tools: A Dev Blog RSS" href="https://fightwithtools.dev/rss/" />
    	<link rel="alternate" type="application/atom+xml" title="Fight With Tools: A Dev Blog Feed" href="https://fightwithtools.dev/feed/" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Regex Tutorial - Lookahead and Lookbehind Zero-Length Assertions</title>
        
            <!-- Sub Template: archives -->
        
        <link rel="original" http-equiv href="https://www.regular-expressions.info/lookaround.html" />
        
            
                <!-- <link rel="stylesheet" href="https://fightwithtools.dev/assets/css/template-archives.css?v=11966512017" /> -->
                <link rel="stylesheet" href="https://fightwithtools.dev/assets/css/template-archives.css?v=11966512017" id=""></link>

            
        
        
            <link rel="canonical" href="https://www.regular-expressions.info/lookaround.html" />
            

            <meta property="og:title"
                content="Regex Tutorial - Lookahead and Lookbehind Zero-Length Assertions">

            <meta property="og:description"
                content="Test for a match, or test for failure, without actually consuming any characters.">


            <meta property="og:url"
                content="https://www.regular-expressions.info/lookaround.html" />

            <meta property="og:site_name" content="Fight With Tools: A Dev Blog" />

            <meta property="og:locale" content="en_US" />

            <meta name="twitter:site" content="@chronotope" />

            <meta name="twitter:description" content="Test for a match, or test for failure, without actually consuming any characters." />

            <!-- I prefer the summary_large_image Twitter card for posts. -->
            <meta name="twitter:card" content="summary_large_image" />
            <!-- You, you're the creator. -->
            <meta name="twitter:creator" content="@chronotope" />
            <!-- This property is for the article title, not site title. -->
            <meta name="twitter:title" content="Regex Tutorial - Lookahead and Lookbehind Zero-Length Assertions" />

            

            <meta property="og:type" content="website" />

            <script type="application/ld+json">
                {
                    "@context": "http://schema.org",
                    "@type": "WebPage",
                    "url": "https://www.regular-expressions.info/lookaround.html",
                    "headline": "Regex Tutorial - Lookahead and Lookbehind Zero-Length Assertions",
                    "about": "Test for a match, or test for failure, without actually consuming any characters.",

                    "image": [
                        
                        
                    ],
                    "isAccessibleForFree": "True",
                    "isPartOf": {
                        "@type": ["CreativeWork", "Product"],
                        "name": "Fight With Tools",
                        "productID": "fightwithtools.dev"
                    },
                    "license": "http://creativecommons.org/licenses/by-sa/4.0/",
                    "archivedAt": "https://fightwithtools.dev/timegate/https:/www.regular-expressions.info/lookaround.html/",
                    "sameAs": "https://www.regular-expressions.info/lookaround.html",
                }
            </script>


        
        
        </head>
        <body >
            <div class="wrapper">
                <header>
                    <div class="left">
                        <h1>Archived: Regex Tutorial - Lookahead and Lookbehind Zero-Length Assertions</h1>
                        <p>This is a simplified archive of the page at <a href="https://www.regular-expressions.info/lookaround.html" target="_blank">https://www.regular-expressions.info/lookaround.html</a></p>
                    </div>

                            <div id="share-embed">
                                <span>Use this page embed on your own site:</span>
                                <textarea id="html-embed" name="story" rows="8" cols="40">
                                    <script>window.contexterSetup=window.contexterSetup||function(){window.contexterSetupComplete=!0;class ContexterLink extends HTMLAnchorElement{constructor(){super()}connectedCallback(){this.setAttribute("target","_blank")}}customElements.define("contexter-link",ContexterLink,{extends:"a"}),customElements.define("contexter-inner",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className="contexter-box__inner"}}),customElements.define("contexter-thumbnail",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className="contexter-box__thumbnail"}}),customElements.define("contexter-byline",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className="contexter-box__byline"}}),customElements.define("contexter-keywordset",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className="contexter-box__keywordset"}}),customElements.define("contexter-linkset",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className="contexter-box__linkset"}}),customElements.define("contexter-meta",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className="contexter-box__meta"}}),customElements.define("contexter-summary",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className="p-summary entry-summary"}}),customElements.define("contexter-box-head",class extends HTMLElement{constructor(){super()}connectedCallback(){this.className="contexter-box__head"}}),customElements.define("contexter-box-inner",class extends HTMLElement{constructor(){super()}connectedCallback(){}});class ContexterBox extends HTMLElement{constructor(){super(),this.first=!0,this.shadow=this.attachShadow({mode:"open"})}connectedCallback(){if(this.first){this.first=!1;var style=document.createElement("style"),lightDomStyle=(style.innerHTML=`:host {--background: #f5f6f7;--border: darkblue;--blue: #0000ee;--font-color: black;--inner-border: black;font-family: Franklin,Arial,Helvetica,sans-serif;font-size: 14px;background: var(--background);width: 600px;color: var(--font-color);min-height: 90px;display: block;padding: 8px;border: 1px solid var(--border);cursor: pointer;box-sizing: border-box;margin: 6px;contain: content;margin: 6px auto;}// can only select top-level nodes with slotted::slotted(*) {max-width: 100%;display:block;}::slotted([slot=thumbnail]) {max-width: 100%;display:block;}::slotted([slot=header]) {width: 100%;font-size: 1.25rem;font-weight: bold;display:block;margin-bottom: 6px;}::slotted([slot=author]) {max-width: 50%;font-size: 12px;display:inline-block;float: left;}::slotted([slot=time]) {max-width: 50%;font-size: 12px;display:inline-block;float: right;}::slotted([slot=summary]) {width: 100%;margin-top: 6px;padding: 10px 2px;border-top: 1px solid var(--inner-border);font-size: 15px;display:inline-block;margin-bottom: 6px;}contexter-meta {height: auto;margin-bottom: 4px;width: 100%;display: grid;position: relative;min-height: 16px;grid-template-columns: repeat(2, 1fr);}::slotted([slot=keywords]) {width: 80%;padding: 2px 4px;border-top: 1px solid var(--inner-border);font-size: 11px;display: block;float: right;font-style: italic;text-align: right;grid-column: 2/2;grid-row: 1;align-self: end;justify-self: end;}::slotted([slot=keywords]):empty {border-top: 0px solid var(--inner-border);}::slotted([slot=archive-link]) {font-size: 1em;display: inline;}::slotted([slot=archive-link])::after {content: "|";display: inline;color: var(--font-color);text-decoration: none;margin: 0 .5em;}::slotted([slot=read-link]) {font-size: 1em;display: inline;}contexter-linkset {width: 80%;padding: 2px 4px;font-size: 13px;float: left;font-weight: bold;grid-row: 1;grid-column: 1/2;align-self: end;justify-self: start;}/* Extra small devices (phones, 600px and down) */@media only screen and (max-width: 600px) {:host {width: 310px;}}/* Small devices (portrait tablets and large phones, 600px and up) */@media only screen and (min-width: 600px) {...}/* Medium devices (landscape tablets, 768px and up) */@media only screen and (min-width: 768px) {...}/* Large devices (laptops/desktops, 992px and up) */@media only screen and (min-width: 992px) {...}/* Extra large devices (large laptops and desktops, 1200px and up) */@media only screen and (min-width: 1200px) {...}@media (prefers-color-scheme: dark){:host {--background: #354150;--border: #1f2b37;--blue: #55b0ff;--font-color: #ffffff;--inner-border: #787a7c;background: var(--background);border: 1px solid var(--border)}}`,document.createElement("style"));lightDomStyle.innerHTML=`contexter-box {contain: content;}contexter-box .read-link {font-weight: bold;}contexter-box a {color: #0000ee;}contexter-box img {width: 100%;border: 0;padding: 0;margin: 0;}/* Extra small devices (phones, 600px and down) */@media only screen and (max-width: 600px) {...}/* Small devices (portrait tablets and large phones, 600px and up) */@media only screen and (min-width: 600px) {...}/* Medium devices (landscape tablets, 768px and up) */@media only screen and (min-width: 768px) {...}/* Large devices (laptops/desktops, 992px and up) */@media only screen and (min-width: 992px) {...}/* Extra large devices (large laptops and desktops, 1200px and up) */@media only screen and (min-width: 1200px) {...}@media (prefers-color-scheme: dark){contexter-box a {color: #55b0ff;}}`,this.appendChild(lightDomStyle),this.shadow.appendChild(style);const innerContainer=document.createElement("contexter-box-inner"),innerSlotThumbnail=(this.shadow.appendChild(innerContainer),document.createElement("slot")),innerSlotHeader=(innerSlotThumbnail.name="thumbnail",innerContainer.appendChild(innerSlotThumbnail),document.createElement("slot")),innerSlotAuthor=(innerSlotHeader.name="header",innerContainer.appendChild(innerSlotHeader),document.createElement("slot")),innerSlotTime=(innerSlotAuthor.name="author",innerContainer.appendChild(innerSlotAuthor),document.createElement("slot")),innerSlotSummary=(innerSlotTime.name="time",innerContainer.appendChild(innerSlotTime),document.createElement("slot")),metaContainer=(innerSlotSummary.name="summary",innerContainer.appendChild(innerSlotSummary),document.createElement("contexter-meta")),innerSlotInfo=(innerContainer.appendChild(metaContainer),document.createElement("slot")),linkContainer=(innerSlotInfo.name="keywords",metaContainer.appendChild(innerSlotInfo),document.createElement("contexter-linkset")),innerSlotArchiveLink=(metaContainer.appendChild(linkContainer),document.createElement("slot")),innerSlotReadLink=(innerSlotArchiveLink.name="archive-link",linkContainer.appendChild(innerSlotArchiveLink),document.createElement("slot"));innerSlotReadLink.name="read-link",linkContainer.appendChild(innerSlotReadLink),this.className="contexter-box",this.onclick=e=>{if(!e.target.className.includes("read-link")&&!e.target.className.includes("title-link")){const mainLinks=this.querySelectorAll("a.main-link");mainLinks[0].click()}}}}}customElements.define("contexter-box",ContexterBox)},window.contexterSetupComplete||window.contexterSetup();</script><contexter-box class="link-card h-entry hentry" itemscope="" itemtype="https://schema.org/CreativeWork"><contexter-thumbnail class="thumbnail" slot="thumbnail"></contexter-thumbnail><contexter-box-head slot="header" class="p-name entry-title" itemprop="headline"><contexter-box-head slot="header" class="p-name entry-title" itemprop="headline"><a is="contexter-link" href="https://www.regular-expressions.info/lookaround.html" itemprop="url">Regex Tutorial - Lookahead and Lookbehind Zero-Length Assertions</a></contexter-box-head></contexter-box-head><contexter-byline class="p-author author" slot="author"><span class="p-name byline" rel="author" itemprop="author">Jan Goyvaerts</span></contexter-byline><time class="dt-published published" slot="time" itemprop="datePublished" datetime="2022-02-21T18:33:50.428Z">1/21/2022</time><contexter-summary class="p-summary entry-summary" itemprop="abstract" slot="summary"><p>Test for a match, or test for failure, without actually consuming any characters.</p></contexter-summary><contexter-keywordset itemprop="keywords" slot="keywords"><span rel="category tag" class="p-category" itemprop="keywords"></span></contexter-keywordset><a href="https://web.archive.org/web/20220220011445/https://www.regular-expressions.info/lookaround.html" is="contexter-link" target="_blank" class="read-link archive-link" itemprop="archivedAt" slot="archive-link">Archived</a><a is="contexter-link" href="https://www.regular-expressions.info/lookaround.html" class="read-link main-link" itemprop="sameAs" slot="read-link">Read</a></contexter-box>
                                </textarea><br />
                                <button onclick="(function(e){ navigator.clipboard.writeText(document.getElementById('html-embed').value); })()">Copy</button>
                            </div>
                            
                            <script>window.contexterSetup=window.contexterSetup||function(){window.contexterSetupComplete=!0;class ContexterLink extends HTMLAnchorElement{constructor(){super()}connectedCallback(){this.setAttribute("target","_blank")}}customElements.define("contexter-link",ContexterLink,{extends:"a"}),customElements.define("contexter-inner",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className="contexter-box__inner"}}),customElements.define("contexter-thumbnail",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className="contexter-box__thumbnail"}}),customElements.define("contexter-byline",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className="contexter-box__byline"}}),customElements.define("contexter-keywordset",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className="contexter-box__keywordset"}}),customElements.define("contexter-linkset",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className="contexter-box__linkset"}}),customElements.define("contexter-meta",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className="contexter-box__meta"}}),customElements.define("contexter-summary",class extends HTMLElement{constructor(){super()}attributeChangedCallback(name,oldValue,newValue){}connectedCallback(){this.className="p-summary entry-summary"}}),customElements.define("contexter-box-head",class extends HTMLElement{constructor(){super()}connectedCallback(){this.className="contexter-box__head"}}),customElements.define("contexter-box-inner",class extends HTMLElement{constructor(){super()}connectedCallback(){}});class ContexterBox extends HTMLElement{constructor(){super(),this.first=!0,this.shadow=this.attachShadow({mode:"open"})}connectedCallback(){if(this.first){this.first=!1;var style=document.createElement("style"),lightDomStyle=(style.innerHTML=`:host {--background: #f5f6f7;--border: darkblue;--blue: #0000ee;--font-color: black;--inner-border: black;font-family: Franklin,Arial,Helvetica,sans-serif;font-size: 14px;background: var(--background);width: 600px;color: var(--font-color);min-height: 90px;display: block;padding: 8px;border: 1px solid var(--border);cursor: pointer;box-sizing: border-box;margin: 6px;contain: content;margin: 6px auto;}// can only select top-level nodes with slotted::slotted(*) {max-width: 100%;display:block;}::slotted([slot=thumbnail]) {max-width: 100%;display:block;}::slotted([slot=header]) {width: 100%;font-size: 1.25rem;font-weight: bold;display:block;margin-bottom: 6px;}::slotted([slot=author]) {max-width: 50%;font-size: 12px;display:inline-block;float: left;}::slotted([slot=time]) {max-width: 50%;font-size: 12px;display:inline-block;float: right;}::slotted([slot=summary]) {width: 100%;margin-top: 6px;padding: 10px 2px;border-top: 1px solid var(--inner-border);font-size: 15px;display:inline-block;margin-bottom: 6px;}contexter-meta {height: auto;margin-bottom: 4px;width: 100%;display: grid;position: relative;min-height: 16px;grid-template-columns: repeat(2, 1fr);}::slotted([slot=keywords]) {width: 80%;padding: 2px 4px;border-top: 1px solid var(--inner-border);font-size: 11px;display: block;float: right;font-style: italic;text-align: right;grid-column: 2/2;grid-row: 1;align-self: end;justify-self: end;}::slotted([slot=keywords]):empty {border-top: 0px solid var(--inner-border);}::slotted([slot=archive-link]) {font-size: 1em;display: inline;}::slotted([slot=archive-link])::after {content: "|";display: inline;color: var(--font-color);text-decoration: none;margin: 0 .5em;}::slotted([slot=read-link]) {font-size: 1em;display: inline;}contexter-linkset {width: 80%;padding: 2px 4px;font-size: 13px;float: left;font-weight: bold;grid-row: 1;grid-column: 1/2;align-self: end;justify-self: start;}/* Extra small devices (phones, 600px and down) */@media only screen and (max-width: 600px) {:host {width: 310px;}}/* Small devices (portrait tablets and large phones, 600px and up) */@media only screen and (min-width: 600px) {...}/* Medium devices (landscape tablets, 768px and up) */@media only screen and (min-width: 768px) {...}/* Large devices (laptops/desktops, 992px and up) */@media only screen and (min-width: 992px) {...}/* Extra large devices (large laptops and desktops, 1200px and up) */@media only screen and (min-width: 1200px) {...}@media (prefers-color-scheme: dark){:host {--background: #354150;--border: #1f2b37;--blue: #55b0ff;--font-color: #ffffff;--inner-border: #787a7c;background: var(--background);border: 1px solid var(--border)}}`,document.createElement("style"));lightDomStyle.innerHTML=`contexter-box {contain: content;}contexter-box .read-link {font-weight: bold;}contexter-box a {color: #0000ee;}contexter-box img {width: 100%;border: 0;padding: 0;margin: 0;}/* Extra small devices (phones, 600px and down) */@media only screen and (max-width: 600px) {...}/* Small devices (portrait tablets and large phones, 600px and up) */@media only screen and (min-width: 600px) {...}/* Medium devices (landscape tablets, 768px and up) */@media only screen and (min-width: 768px) {...}/* Large devices (laptops/desktops, 992px and up) */@media only screen and (min-width: 992px) {...}/* Extra large devices (large laptops and desktops, 1200px and up) */@media only screen and (min-width: 1200px) {...}@media (prefers-color-scheme: dark){contexter-box a {color: #55b0ff;}}`,this.appendChild(lightDomStyle),this.shadow.appendChild(style);const innerContainer=document.createElement("contexter-box-inner"),innerSlotThumbnail=(this.shadow.appendChild(innerContainer),document.createElement("slot")),innerSlotHeader=(innerSlotThumbnail.name="thumbnail",innerContainer.appendChild(innerSlotThumbnail),document.createElement("slot")),innerSlotAuthor=(innerSlotHeader.name="header",innerContainer.appendChild(innerSlotHeader),document.createElement("slot")),innerSlotTime=(innerSlotAuthor.name="author",innerContainer.appendChild(innerSlotAuthor),document.createElement("slot")),innerSlotSummary=(innerSlotTime.name="time",innerContainer.appendChild(innerSlotTime),document.createElement("slot")),metaContainer=(innerSlotSummary.name="summary",innerContainer.appendChild(innerSlotSummary),document.createElement("contexter-meta")),innerSlotInfo=(innerContainer.appendChild(metaContainer),document.createElement("slot")),linkContainer=(innerSlotInfo.name="keywords",metaContainer.appendChild(innerSlotInfo),document.createElement("contexter-linkset")),innerSlotArchiveLink=(metaContainer.appendChild(linkContainer),document.createElement("slot")),innerSlotReadLink=(innerSlotArchiveLink.name="archive-link",linkContainer.appendChild(innerSlotArchiveLink),document.createElement("slot"));innerSlotReadLink.name="read-link",linkContainer.appendChild(innerSlotReadLink),this.className="contexter-box",this.onclick=e=>{if(!e.target.className.includes("read-link")&&!e.target.className.includes("title-link")){const mainLinks=this.querySelectorAll("a.main-link");mainLinks[0].click()}}}}}customElements.define("contexter-box",ContexterBox)},window.contexterSetupComplete||window.contexterSetup();</script><contexter-box class="link-card h-entry hentry" itemscope="" itemtype="https://schema.org/CreativeWork"><contexter-thumbnail class="thumbnail" slot="thumbnail"></contexter-thumbnail><contexter-box-head slot="header" class="p-name entry-title" itemprop="headline"><contexter-box-head slot="header" class="p-name entry-title" itemprop="headline"><a is="contexter-link" href="https://www.regular-expressions.info/lookaround.html" itemprop="url">Regex Tutorial - Lookahead and Lookbehind Zero-Length Assertions</a></contexter-box-head></contexter-box-head><contexter-byline class="p-author author" slot="author"><span class="p-name byline" rel="author" itemprop="author">Jan Goyvaerts</span></contexter-byline><time class="dt-published published" slot="time" itemprop="datePublished" datetime="2022-02-21T18:33:50.428Z">1/21/2022</time><contexter-summary class="p-summary entry-summary" itemprop="abstract" slot="summary"><p>Test for a match, or test for failure, without actually consuming any characters.</p></contexter-summary><contexter-keywordset itemprop="keywords" slot="keywords"><span rel="category tag" class="p-category" itemprop="keywords"></span></contexter-keywordset><a href="https://web.archive.org/web/20220220011445/https://www.regular-expressions.info/lookaround.html" is="contexter-link" target="_blank" class="read-link archive-link" itemprop="archivedAt" slot="archive-link">Archived</a><a is="contexter-link" href="https://www.regular-expressions.info/lookaround.html" class="read-link main-link" itemprop="sameAs" slot="read-link">Read</a></contexter-box>
                            


                </header>
                <main>
                
                    <div id="readability-page-1" class="page"><div><div><a href="https://www.regexbuddy.com/create.html" target="_top"><picture><source media="(max-width: 370px)" srcset="ads/320/rxbtutorial100.png 1x, ads/320/rxbtutorial150.png 1.5x, ads/320/rxbtutorial200.png 2x, ads/320/rxbtutorial250.png 2.5x, ads/320/rxbtutorial300.png 3x, ads/320/rxbtutorial350.png 3.5x, ads/320/rxbtutorial400.png 4x"><source media="(max-width: 500px)" srcset="ads/360/rxbtutorial100.png 1x, ads/360/rxbtutorial150.png 1.5x, ads/360/rxbtutorial200.png 2x, ads/360/rxbtutorial250.png 2.5x, ads/360/rxbtutorial300.png 3x, ads/360/rxbtutorial350.png 3.5x, ads/360/rxbtutorial400.png 4x"><source media="(max-width: 660px)" srcset="ads/480/rxbtutorial100.png 1x, ads/480/rxbtutorial150.png 1.5x, ads/480/rxbtutorial200.png 2x, ads/480/rxbtutorial250.png 2.5x, ads/480/rxbtutorial300.png 3x, ads/480/rxbtutorial350.png 3.5x, ads/480/rxbtutorial400.png 4x"><source media="(max-width: 747px)" srcset="ads/640/rxbtutorial100.png 1x, ads/640/rxbtutorial150.png 1.5x, ads/640/rxbtutorial200.png 2x, ads/640/rxbtutorial250.png 2.5x, ads/640/rxbtutorial300.png 3x, ads/640/rxbtutorial350.png 3.5x, ads/640/rxbtutorial400.png 4x"><img src="ads/728/rxbtutorial100.png" srcset="ads/728/rxbtutorial100.png 1x, ads/728/rxbtutorial125.png 1.25x, ads/728/rxbtutorial150.png 1.5x, ads/728/rxbtutorial175.png 1.75x, ads/728/rxbtutorial200.png 2x, ads/728/rxbtutorial250.png 2.5x, ads/728/rxbtutorial300.png 3x, ads/728/rxbtutorial350.png 3.5x, ads/728/rxbtutorial400.png 4x" alt="RegexBuddy—Better than a regular expression tutorial!"></picture></a></div>  <p>Lookahead and lookbehind, collectively called “lookaround”, are zero-length assertions just like the <a href="anchors.html" target="_top">start and end of line</a>, and <a href="wordboundaries.html" target="_top">start and end of word</a> anchors explained earlier in this tutorial. The difference is that lookaround actually matches characters, but then gives up the match, returning only the result: match or no match. That is why they are called “assertions”. They do not consume characters in the string, but only assert whether a match is possible or not. Lookaround allows you to create regular expressions that are impossible to create without them, or that would get very longwinded without them.</p> <h2>Positive and Negative Lookahead</h2> <p>Negative lookahead is indispensable if you want to match something not followed by something else. When explaining <a href="charclass.html" target="_top">character classes</a>, this tutorial explained why you cannot use a negated character class to match a <tt>q</tt> not followed by a <tt>u</tt>. Negative lookahead provides the solution: <tt><span>q</span><span>(?!</span><span>u</span><span>)</span></tt>. The negative lookahead construct is the pair of parentheses, with the opening parenthesis followed by a question mark and an exclamation point. Inside the lookahead, we have the trivial regex <tt><span>u</span></tt>.</p> <p>Positive lookahead works just the same. <tt><span>q</span><span>(?=</span><span>u</span><span>)</span></tt> matches a q that is followed by a u, without making the u part of the match. The positive lookahead construct is a pair of parentheses, with the opening parenthesis followed by a question mark and an equals sign.</p> <p>You can use any regular expression inside the lookahead (but not lookbehind, as explained below). Any valid regular expression can be used inside the lookahead. If it contains <a href="brackets.html" target="_top">capturing groups</a> then those groups will capture as normal and backreferences to them will work normally, even outside the lookahead. (The only exception is <a href="tcl.html" target="_top">Tcl</a>, which treats all groups inside lookahead as non-capturing.) The lookahead itself is not a capturing group. It is not included in the count towards numbering the backreferences. If you want to store the match of the regex inside a lookahead, you have to put capturing parentheses around the regex inside the lookahead, like this: <tt><span>(?=</span><span>(</span><span>regex</span><span>)</span><span>)</span></tt>. The other way around will not work, because the lookahead will already have discarded the regex match by the time the capturing group is to store its match.</p> <h2>Regex Engine Internals</h2> <p>First, let’s see how the engine applies <tt><span>q</span><span>(?!</span><span>u</span><span>)</span></tt> to the string <tt>Iraq</tt>. The first token in the regex is the <a href="characters.html" target="_top">literal</a> <tt><span>q</span></tt>. As we already know, this causes the engine to traverse the string until the <tt>q</tt> in the string is matched. The position in the string is now the void after the string. The next token is the lookahead. The engine takes note that it is inside a lookahead construct now, and begins matching the regex inside the lookahead. So the next token is <tt><span>u</span></tt>. This does not match the void after the string. The engine notes that the regex inside the lookahead failed. Because the lookahead is negative, this means that the lookahead has successfully matched at the current position. At this point, the entire regex has matched, and <tt>q</tt> is returned as the match.</p> <p>Let’s try applying the same regex to <tt>quit</tt>. <tt><span>q</span></tt> matches <tt>q</tt>. The next token is the <tt><span>u</span></tt> inside the lookahead. The next character is the <tt>u</tt>. These match. The engine advances to the next character: <tt>i</tt>. However, it is done with the regex inside the lookahead. The engine notes success, and discards the regex match. This causes the engine to step back in the string to <tt>u</tt>.</p> <p>Because the lookahead is negative, the successful match inside it causes the lookahead to fail. Since there are no other permutations of this regex, the engine has to start again at the beginning. Since <tt><span>q</span></tt> cannot match anywhere else, the engine reports failure.</p> <p>Let’s take one more look inside, to make sure you understand the implications of the lookahead. Let’s apply <tt><span>q</span><span>(?=</span><span>u</span><span>)</span><span>i</span></tt> to <tt>quit</tt>. The lookahead is now positive and is followed by another token. Again, <tt><span>q</span></tt> matches <tt>q</tt> and <tt><span>u</span></tt> matches <tt>u</tt>. Again, the match from the lookahead must be discarded, so the engine steps back from <tt>i</tt> in the string to <tt>u</tt>. The lookahead was successful, so the engine continues with <tt><span>i</span></tt>. But <tt><span>i</span></tt> cannot match <tt>u</tt>. So this match attempt fails. All remaining attempts fail as well, because there are no more q’s in the string.</p> <p>The regex <tt><span>q</span><span>(?=</span><span>u</span><span>)</span><span>i</span></tt> can never match anything. It tries to match <tt><span>u</span></tt> and <tt><span>i</span></tt> at the same position. If there is a <tt>u</tt> immediately after the <tt>q</tt> then the lookahead succeeds but then <tt><span>i</span></tt> fails to match <tt>u</tt>. If there is anything other than a <tt>u</tt> immediately after the <tt>q</tt> then the lookahead fails.</p> <h2>Positive and Negative Lookbehind</h2> <p>Lookbehind has the same effect, but works backwards. It tells the regex engine to temporarily step backwards in the string, to check if the text inside the lookbehind can be matched there. <tt><span>(?&lt;!</span><span>a</span><span>)</span><span>b</span></tt> matches a “b” that is not preceded by an “a”, using negative lookbehind. It doesn’t match <tt>cab</tt>, but matches the <tt>b</tt> (and only the <tt>b</tt>) in <tt>bed</tt> or <tt>debt</tt>. <tt><span>(?&lt;=</span><span>a</span><span>)</span><span>b</span></tt> (positive lookbehind) matches the <tt>b</tt> (and only the <tt>b</tt>) in <tt>cab</tt>, but does not match <tt>bed</tt> or <tt>debt</tt>.</p> <p>The construct for positive lookbehind is <tt><span>(?&lt;=</span><span>text</span><span>)</span></tt>: a pair of parentheses, with the opening parenthesis followed by a question mark, “less than” symbol, and an equals sign. Negative lookbehind is written as <tt><span>(?&lt;!</span><span>text</span><span>)</span></tt>, using an exclamation point instead of an equals sign.</p> <h2>More Regex Engine Internals</h2> <p>Let’s apply <tt><span>(?&lt;=</span><span>a</span><span>)</span><span>b</span></tt> to <tt>thingamabob</tt>. The engine starts with the lookbehind and the first character in the string. In this case, the lookbehind tells the engine to step back one character, and see if <tt><span>a</span></tt> can be matched there. The engine cannot step back one character because there are no characters before the <tt>t</tt>. So the lookbehind fails, and the engine starts again at the next character, the <tt>h</tt>. (Note that a negative lookbehind would have succeeded here.) Again, the engine temporarily steps back one character to check if an “a” can be found there. It finds a <tt>t</tt>, so the positive lookbehind fails again.</p> <p>The lookbehind continues to fail until the regex reaches the <tt>m</tt> in the string. The engine again steps back one character, and notices that the <tt>a</tt> can be matched there. The positive lookbehind matches. Because it is zero-length, the current position in the string remains at the <tt>m</tt>. The next token is <tt><span>b</span></tt>, which cannot match here. The next character is the second <tt>a</tt> in the string. The engine steps back, and finds out that the <tt>m</tt> does not match <tt><span>a</span></tt>.</p> <p>The next character is the first <tt>b</tt> in the string. The engine steps back and finds out that <tt>a</tt> satisfies the lookbehind. <tt><span>b</span></tt> matches <tt>b</tt>, and the entire regex has been matched successfully. It matches one character: the first <tt>b</tt> in the string.</p> <h2>Important Notes About Lookbehind</h2> <p>The good news is that you can use lookbehind anywhere in the regex, not only at the start. If you want to find a word not ending with an “s”, you could use <tt><span>\b</span><span>\w</span><span>+</span><span>(?&lt;!</span><span>s</span><span>)</span><span>\b</span></tt>. This is definitely not the same as <tt><span>\b</span><span>\w</span><span>+</span><span>[</span><span>^</span><span>s</span><span>]</span><span>\b</span></tt>. When applied to <tt>John's</tt>, the former matches <tt>John</tt> and the latter matches <tt>John'</tt> (including the apostrophe). I will leave it up to you to figure out why. (Hint: <tt><span>\b</span></tt> matches between the apostrophe and the <tt>s</tt>). The latter also doesn’t match single-letter words like “a” or “I”. The correct regex without using lookbehind is <tt><span>\b</span><span>\w</span><span>*</span><span>[</span><span>^</span><span>s</span><span>\W</span><span>]</span><span>\b</span></tt> (star instead of plus, and \W in the character class). Personally, I find the lookbehind easier to understand. The last regex, which works correctly, has a double negation (the \W in the negated character class). Double negations tend to be confusing to humans. Not to regex engines, though. (Except perhaps for Tcl, which treats negated shorthands in negated character classes as an error.)</p> <p>The bad news is that most regex flavors do not allow you to use just any regex inside a lookbehind, because they cannot apply a regular expression backwards. The regular expression engine needs to be able to figure out how many characters to step back before checking the lookbehind. When evaluating the lookbehind, the regex engine determines the length of the regex inside the lookbehind, steps back that many characters in the subject string, and then applies the regex inside the lookbehind from left to right just as it would with a normal regex.</p> <p>Many regex flavors, including those used by <a href="perl.html" target="_top">Perl</a>, <a href="python.html" target="_top">Python</a>, and <a href="boost.html" target="_top">Boost</a> only allow fixed-length strings. You can use <a href="characters.html" target="_top">literal text</a>, <a href="nonprint.html#hex">character escapes</a>, <a href="nonprint.html#hex">Unicode escapes</a> other than <tt><span>\X</span></tt>, and <a href="charclass.html" target="_top">character classes</a>. You cannot use <a href="repeat.html" target="_top">quantifiers</a> or <a href="backref.html" target="_top">backreferences</a>. You can use <a href="alternation.html" target="_top">alternation</a>, but only if all alternatives have the same length. These flavors evaluate lookbehind by first stepping back through the subject string for as many characters as the lookbehind needs, and then attempting the regex inside the lookbehind from left to right.</p> <p>Perl 5.30 supports variable-length lookbehind as an experimental feature. But there are many cases in which it does not work correctly. So in practice, the above is still true for Perl 5.30.</p> <p><a href="pcre.html" target="_top">PCRE</a> is not fully Perl-compatible when it comes to lookbehind. While Perl requires alternatives inside lookbehind to have the same length, PCRE allows alternatives of variable length. <a href="php.html" target="_top">PHP</a>, <a href="delphi.html" target="_top">Delphi</a>, <a href="rlanguage.html" target="_top">R</a>, and <a href="ruby.html" target="_top">Ruby</a> also allow this. Each alternative still has to be fixed-length. Each alternative is treated as a separate fixed-length lookbehind.</p> <p><a href="java.html" target="_top">Java</a> takes things a step further by allowing finite repetition. You can use the <a href="optional.html" target="_top">question mark</a> and the <a href="repeat.html" target="_top">curly braces</a> with the <i>max</i> parameter specified. Java determines the minimum and maximum possible lengths of the lookbehind. The lookbehind in the regex <tt><span>(?&lt;!</span><span>a</span><span>b</span><span>{2,4}</span><span>c</span><span>{3,5}</span><span>d</span><span>)</span><span>test</span></tt> has 5 possible lengths. It can be from 7 through 11 characters long. When Java (version 6 or later) tries to match the lookbehind, it first steps back the minimum number of characters (7 in this example) in the string and then evaluates the regex inside the lookbehind as usual, from left to right. If it fails, Java steps back one more character and tries again. If the lookbehind continues to fail, Java continues to step back until the lookbehind either matches or it has stepped back the maximum number of characters (11 in this example). This repeated stepping back through the subject string kills performance when the number of possible lengths of the lookbehind grows. Keep this in mind. Don’t choose an arbitrarily large maximum number of repetitions to work around the lack of infinite quantifiers inside lookbehind. Java 4 and 5 have bugs that cause lookbehind with alternation or variable quantifiers to fail when it should succeed in some situations. These bugs were fixed in Java 6.</p> <p>Java 13 allows you to use the <a href="repeat.html" target="_top">star</a> and <a href="repeat.html" target="_top">plus</a> inside lookbehind, as well as <a href="repeat.html" target="_top">curly braces</a> without an upper limit. But Java 13 still uses the laborious method of matching lookbehind introduced with Java 6. Java 13 also does not correctly handle lookbehind with multiple quantifiers if one of them is unbounded. In some situations you may get an error. In other situations you may get incorrect matches. So for both correctness and performance, we recommend you only use quantifiers with a low upper bound in lookbehind with Java 6 through 13.</p> <p>The only regex engines that allow you to use a full regular expression inside lookbehind, including infinite repetition and backreferences, are the <a href="jgsoft.html" target="_top">JGsoft engine</a> and the <a href="dotnet.html" target="_top">.NET RegEx classes</a>. These regex engines really apply the regex inside the lookbehind backwards, going through the regex inside the lookbehind and through the subject string from right to left. They only need to evaluate the lookbehind once, regardless of how many different possible lengths it has.</p> <p>Finally, flavors like <a href="stdregex.html" target="_top">std::regex</a> and <a href="tcl.html" target="_top">Tcl</a> do not support lookbehind at all, even though they do support lookahead. <a href="javascript.html" target="_top">JavaScript</a> was like that for the longest time since its inception. But now lookbehind is part of the ECMAScript 2018 specification. As of this writing (late 2019), Google’s Chrome browser is the only popular JavaScript implementation that supports lookbehind. So if cross-browser compatibility matters, you can’t use lookbehind in JavaScript.</p> <h2>Lookaround Is Atomic</h2> <p>The fact that lookaround is zero-length automatically makes it <a href="atomic.html#use">atomic</a>. As soon as the lookaround condition is satisfied, the regex engine forgets about everything inside the lookaround. It will not backtrack inside the lookaround to try different permutations.</p> <p>The only situation in which this makes any difference is when you use <a href="brackets.html" target="_top">capturing groups</a> inside the lookaround. Since the regex engine does not backtrack into the lookaround, it will not try different permutations of the capturing groups.</p> <p>For this reason, the regex <tt><span>(?=</span><span>(</span><span>\d</span><span>+</span><span>)</span><span>)</span><span>\w</span><span>+</span><span>\1</span></tt> never matches <tt>123x12</tt>. First the lookaround captures <tt>123</tt> into <tt><span>\1</span></tt>. <tt><span>\w</span><span>+</span></tt> then matches the whole string and backtracks until it matches only <tt>1</tt>. Finally, <tt><span>\w</span><span>+</span></tt> fails since <tt><span>\1</span></tt> cannot be matched at any position. Now, the regex engine has nothing to backtrack to, and the overall regex fails. The backtracking steps created by <tt><span>\d</span><span>+</span></tt> have been discarded. It never gets to the point where the lookahead captures only <tt>12</tt>.</p> <p>Obviously, the regex engine does try further positions in the string. If we change the subject string, the regex <tt><span>(?=</span><span>(</span><span>\d</span><span>+</span><span>)</span><span>)</span><span>\w</span><span>+</span><span>\1</span></tt> does match <tt>56x56</tt> in <tt>456x56</tt>.</p> <p>If you don’t use capturing groups inside lookaround, then all this doesn’t matter. Either the lookaround condition can be satisfied or it cannot be. In how many ways it can be satisfied is irrelevant.</p>  </div></div>
                
                </main>
                <footer>

                </footer>
            </div>
            <!--[if !IE]><script>fixScale(document);</script><![endif]-->
        </body>
    </html>
