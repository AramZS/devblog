<!doctype html>
    <html lang="en-US" id="template-post" class="base">
        <head>
        
        <script defer data-domain="fightwithtools.dev" src="https://plausible.io/js/plausible.js"></script>
        <link rel="alternate" type="application/rss+xml" title="Fight With Tools: A Dev Blog RSS" href="https://fightwithtools.dev/rss/" />
    	<link rel="alternate" type="application/atom+xml" title="Fight With Tools: A Dev Blog Feed" href="https://fightwithtools.dev/feed/" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Day 15: Working with Eleventy's Compiler </title>
        
            <!-- Sub Template: post -->
        
        
            <link rel="preload" as="font">
            <link href="https://fightwithtools.dev/assets/prism-okaidia.css" rel="preload" as="style" />
            <link href="https://fightwithtools.dev/assets/prism-okaidia.css" rel="stylesheet" />
            <!-- <link rel="stylesheet" href="https://fightwithtools.dev/assets/css/style.css?v=8583920298" /> -->
            <link rel="stylesheet" href="https://fightwithtools.dev/assets/css/style.css?v=8583920298" id=""></link>

            
                <!-- <link rel="stylesheet" href="https://fightwithtools.dev/assets/css/template-post.css?v=8583920298" /> -->
                <link rel="stylesheet" href="https://fightwithtools.dev/assets/css/template-post.css?v=8583920298" id=""></link>

            
            <!-- Build Revision: 8583920298 & Sha: 8b2cd68e6bc462c115ec5f837e59aea19f64b315 -->
            <script src="https://fightwithtools.dev/assets/js/scale.fix.js" async></script>
            <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
            <!--[if lt IE 9]>
                <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
            <![endif]-->
        
        
            <!-- The Author meta propagates the byline in a number of social networks -->
<meta name="author" content="Aram Zucker-Scharff" />

<meta property="og:title"
    content="Day 15: Working with Eleventy's Compiler">

<meta property="og:description"
    content="I want to get the data set up in an HTML block a user can style">


<meta property="og:url"
    content="https://fightwithtools.dev/posts/projects/context-pages/day-15/" />

<meta property="og:site_name" content="Fight With Tools: A Dev Blog" />

<meta property="og:locale" content="en_US" />

<meta name="twitter:site" content="@chronotope" />

<meta name="twitter:description" content="I want to get the data set up in an HTML block a user can style" />

<meta name="description" content="I want to get the data set up in an HTML block a user can style">

<!-- I prefer the summary_large_image Twitter card for posts. -->
<meta name="twitter:card" content="summary_large_image" />
<!-- You, you're the creator. -->
<meta name="twitter:creator" content="@chronotope" />
<!-- This property is for the article title, not site title. -->
<meta name="twitter:title" content="Day 15: Working with Eleventy's Compiler" />



<meta property="og:image" content="https://fightwithtools.dev/img/radial_crosshair.jpg" />
<meta name="twitter:image" content="https://fightwithtools.dev/img/radial_crosshair.jpg" />




    <!-- Article specific OG data -->
    <!-- The OG:Type dictates a number of other tags on posts. -->
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="Fri, 18 Feb 2022 02:59:43 GMT" />

    <!-- page.modified isn't a natural Jekyll property, but it can be added. -->
    

    <!-- Here my author and publisher tags are the same (yay self-publishing) -->
    <meta property="article:author" content="http://facebook.com/aramzs" />
    <!-- But if your site has its own page, this is where to put it. -->
    <meta property="article:publisher" content="https://www.facebook.com/aramzs" />

    
    <!-- Article section isn't a required property, but it can be good to have -->
    <meta property="article:section" content="Context Pages" />
    

    
        <!-- I use the page.categories property for OG tags. -->
        
        <meta property="article:tag" content="posts" />
        
        <meta property="article:tag" content="projects" />
        
        <meta property="article:tag" content="Node" />
        
        <meta property="article:tag" content="WiP" />
        
        <meta property="article:tag" content="archiving" />
        
        <meta property="article:tag" content="embeds" />
        
        <meta property="article:tag" content="Twitter" />
        
        <meta name="keywords" content="posts, projects, Node, WiP, archiving, embeds, Twitter">
    



            <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Blog",
        "url": "https://fightwithtools.dev/posts/projects/context-pages/day-15/",
        "headline": "Day 15: Working with Eleventy's Compiler ",
        "about": "I want to get the data set up in an HTML block a user can style",
        "image": [
            "https://41.media.tumblr.com/709bb3c371b9924add351bfe3386e946/tumblr_nxdq8uFdx81qzocgko1_1280.jpg"
        ],
        "isAccessibleForFree": "True",
        "isPartOf": {
            "@type": ["CreativeWork", "Product"],
            "name": "Fight With Tools",
            "productID": "fightwithtools.dev"
        },
        "discussionUrl": "https://twitter.com/search?q=to%3AChronotope%20%23dev&src=typed_query&f=top",
        "author": {
    "@type": "Person",
    "name": {
        "@type": "PronounceableText",
        "inLanguage": "en-US",
        "textValue": "Aram Zucker-Scharff",
        "speechToTextMarkup": "IPA",
        "phoneticText": "/ˌæ.ɹəm ˈt͡sʊ.kɚ 'ʃɑɹf/"
    },
    "description": "Aram Zucker-Scharff is Lead Privacy Engineer at The Washington Post, lead dev for PressForward and a consultant. Tech solutions for journo problems.",
    "disambiguatingDescription": "A media-focused developer and strategist.",
    "sameAs": "http://aramzs.github.io/aramzs/",
    "image": {
        "@type": "ImageObject",
        "url": "https://raw.githubusercontent.com/AramZS/aramzs.github.io/master/_includes/Aram-Zucker-Scharff-square.jpg"
    },
    "givenName": "Aram",
    "familyName": "Zucker-Scharff",
    "alternateName": "AramZS",
    "publishingPrinciples": "http://aramzs.github.io/about/"
}, 
        "editor": {
    "@type": "Person",
    "name": {
        "@type": "PronounceableText",
        "inLanguage": "en-US",
        "textValue": "Aram Zucker-Scharff",
        "speechToTextMarkup": "IPA",
        "phoneticText": "/ˌæ.ɹəm ˈt͡sʊ.kɚ 'ʃɑɹf/"
    },
    "description": "Aram Zucker-Scharff is Lead Privacy Engineer at The Washington Post, lead dev for PressForward and a consultant. Tech solutions for journo problems.",
    "disambiguatingDescription": "A media-focused developer and strategist.",
    "sameAs": "http://aramzs.github.io/aramzs/",
    "image": {
        "@type": "ImageObject",
        "url": "https://raw.githubusercontent.com/AramZS/aramzs.github.io/master/_includes/Aram-Zucker-Scharff-square.jpg"
    },
    "givenName": "Aram",
    "familyName": "Zucker-Scharff",
    "alternateName": "AramZS",
    "publishingPrinciples": "http://aramzs.github.io/about/"
},
        "inLanguage": "en-US",
        "license": "http://creativecommons.org/licenses/by-sa/4.0/",
        "additionalType": "CreativeWork",
        "alternateName": "Fight With Tools Dev",
        "publisher": {
            "@type": "Organization",
            "name": "Fight With Tools",
            "description": "A site discussing how to imagine, build, analyze and use cool code and web tools. Better websites, better stories, better developers. Technology won't save the world, but you can.",
            "sameAs": "https://fightwithtools.dev/",
            "logo": {
                "@type": "ImageObject",
                "url": "https://41.media.tumblr.com/709bb3c371b9924add351bfe3386e946/tumblr_nxdq8uFdx81qzocgko1_1280.jpg"
            },
            "publishingPrinciples": "http://aramzs.github.io/about/"
        }
    }
</script>

        
        
        
<link rel="canonical" href="https://fightwithtools.dev/posts/projects/context-pages/day-15/" />

        </head>
        <body itemscope itemtype="https://schema.org/Blog">
            <div class="wrapper">
                <header>
                    
                        
                            <div id="site-name-subhead">
                                <a href="https://fightwithtools.dev">Fight With Tools: A Dev Blog</a>
                                
                                    > <a id="project-link" href="https://fightwithtools.dev/projects/context-pages">Context Pages</a>
                                
                            </div>
                        
                        
                            <!-- post mode -->
                            <time>Fri Feb 18 2022</time>
                            <!-- front matter dates made in format at https://yaml.org/type/timestamp.html -->
                        
                        
                            <!-- projects mode -->
                        
                        <h1 class="header">
                            Day 15: Working with Eleventy's Compiler 
                        </h1>
                        
                        
                    
                    
    <h5 itemprop="author" itemscope itemtype="https://schema.org/Person">
    <link itemprop="sameAs" href="http://aramzs.github.io/aramzs/" />
    By <span itemprop="name"><a href="http://aramzs.github.io/aramzs/" target="_blank">Aram Zucker-Scharff</a></span>
</h5>

                </header>
                <main>
                    
    <section id="precontent">
        <aside id="toc-container">
            <div id="toc-container__inner">
                <h2>Contents</h2>
                <nav class="toc">
        <ol><li><a href="#project-scope-and-todos">Project Scope and ToDos</a></li><li><a href="#day-15">Day 15</a></li></ol></nav>
            </div>
        </aside>
        <div id="post-description">I want to get the data set up in an HTML block a user can style</div>

        

    </section>

                    <section id="maincontent" class="maincontent">
                    
                        <h2 id="project-scope-and-todos" tabindex="-1">Project Scope and ToDos</h2>
<ol>
<li>Take a link and turn it into an oEmbed/Open Graph style share card</li>
<li>Take a link and archive it in the most reliable way</li>
<li>When the link is a tweet, display the tweet but also the whole tweet thread.</li>
<li>When the link is a tweet, archive the tweets, and display them if the live ones are not available.</li>
<li>Capture any embedded retweets in the thread. Capture their thread if one exists</li>
<li>Capture any links in the Tweet</li>
<li>Create the process as an abstract function that returns the data in a savable way</li>
</ol>
<ul class="task-list">
<li class="task-list-item"><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Archive links on <a href="http://Archive.org" target="_blank">Archive.org</a> and save the resulting archival links</li>
<li class="task-list-item"><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Create link IDs that can be used to cache related content</li>
<li class="task-list-item"><input disabled="true" type="checkbox" class="markdown-todo"></input> Integrate it into the site to be able to make context pages here.</li>
<li class="task-list-item"><input disabled="true" type="checkbox" class="markdown-todo"></input> Check if a link is still available at build time and rebuild the block with links to an archived link</li>
<li class="task-list-item"><input disabled="true" type="checkbox" class="markdown-todo"></input> Use v1 Twitter API to get Gifs and videos</li>
</ul>
<h2 id="day-15" tabindex="-1">Day 15</h2>
<p>Ok, so I've figured out that I may want to try something different this time, instead of sitting it inside of the markdown-it process, I can use Eleventy. My hope is that at some point I can attach these promises to something that can resolve them within the build process, but I'm not seeing a way yet.</p>
<p>It looks like the right direction is setting up a custom renderer, the original docs said it worked on async, but it <a href="https://github.com/11ty/eleventy/issues/2217" target="_blank">doesn't work on async</a> apparently, at least for now. So I think I'm going to have to pursue the same strategy I did in the past with the Markdown Github links, cache and reprocess opportunistically.</p>
<p>Ok, so the setup as an extension:</p>
<p class="skip-link-graf">
<a href="#code-skip-day-15-7" id="skip-to-code-skip-day-15-7" class="skip-link">Skip code block ▼</a></p>
<pre class="language-javascript"><code class="language-javascript">eleventyConfig<span class="token punctuation">.</span><span class="token function">addExtension</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>extension<span class="token punctuation">,</span> <span class="token punctuation">{</span><br>	read<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>	compile<span class="token operator">:</span> compiler<span class="token punctuation">,</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p id="code-skip-day-15-7">It looks like I can't use the <code>defaultRenderer</code> with the <code>inputContent</code> argument that is the first argument sent into the compiler. So I'm going to need to use the already set-up markdown object.</p>
<p>Hmmm, easiest way to handle it is to pass the Markdown-It object into my plugin's options.</p>
<p class="skip-link-graf">
<a href="#code-skip-day-15-6" id="skip-to-code-skip-day-15-6" class="skip-link">Skip code block ▼</a></p>
<pre class="language-javascript"><code class="language-javascript">eleventyConfig<span class="token punctuation">.</span><span class="token function">addPlugin</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./_custom-plugins/markdown-contexter"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>	existingRenderer<span class="token operator">:</span> markdownSetup<span class="token punctuation">,</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p id="code-skip-day-15-6">Ok, I've got Markdown-It working in my Eleventy extension, but it screwing up my other Markdown extension because it doesn't have anything set into the <code>env</code>. The object I need for my other markdown project in the <code>env</code> property looks like this:</p>
<p class="skip-link-graf">
<a href="#code-skip-day-15-5" id="skip-to-code-skip-day-15-5" class="skip-link">Skip code block ▼</a></p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span><br>    defaults<span class="token operator">:</span> <span class="token punctuation">{</span> layout<span class="token operator">:</span> <span class="token string">'default.njk'</span><span class="token punctuation">,</span> description<span class="token operator">:</span> <span class="token string">'Talking about code'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    description<span class="token operator">:</span> <span class="token string">'I want to get the data set up in an HTML block a user can style'</span><span class="token punctuation">,</span><br>    layout<span class="token operator">:</span> <span class="token string">'post.njk'</span><span class="token punctuation">,</span><br>    projects<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">[</span>Object<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>Object<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>Object<span class="token punctuation">]</span> <span class="token punctuation">]</span><span class="token punctuation">,</span><br>    site<span class="token operator">:</span> <span class="token punctuation">{</span><br>      lang<span class="token operator">:</span> <span class="token string">'en-US'</span><span class="token punctuation">,</span><br>      github<span class="token operator">:</span> <span class="token punctuation">[</span>Object<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      site_url<span class="token operator">:</span> <span class="token string">'http://localhost:8080'</span><span class="token punctuation">,</span><br>      site_name<span class="token operator">:</span> <span class="token string">'Fight With Tools: A Dev Blog'</span><span class="token punctuation">,</span><br>      description<span class="token operator">:</span> <span class="token string">'A site opening up my development process to all.'</span><span class="token punctuation">,</span><br>      featuredImage<span class="token operator">:</span> <span class="token string">'nyc_noir.jpg'</span><span class="token punctuation">,</span><br>      aramPhoto<span class="token operator">:</span> <span class="token string">'https://raw.githubusercontent.com/AramZS/aramzs.github.io/master/_includes/Aram-Zucker-Scharff-square.jpg'</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    eleventy<span class="token operator">:</span> <span class="token punctuation">{</span> env<span class="token operator">:</span> <span class="token punctuation">[</span>Object<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    pkg<span class="token operator">:</span> <span class="token punctuation">{</span><br>      name<span class="token operator">:</span> <span class="token string">'fightwithtooldev'</span><span class="token punctuation">,</span><br>      version<span class="token operator">:</span> <span class="token string">'1.0.0'</span><span class="token punctuation">,</span><br>      description<span class="token operator">:</span> <span class="token string">"This is the repo for Aram ZS's developer notes and log, keeping track of code experiments and decisions."</span><span class="token punctuation">,</span><br>      main<span class="token operator">:</span> <span class="token string">'index.js'</span><span class="token punctuation">,</span><br>      scripts<span class="token operator">:</span> <span class="token punctuation">[</span>Object<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      keywords<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>      author<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><br>      license<span class="token operator">:</span> <span class="token string">'ISC'</span><span class="token punctuation">,</span><br>      devDependencies<span class="token operator">:</span> <span class="token punctuation">[</span>Object<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      dependencies<span class="token operator">:</span> <span class="token punctuation">[</span>Object<span class="token punctuation">]</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    tags<span class="token operator">:</span> <span class="token punctuation">[</span><br>      <span class="token string">'posts'</span><span class="token punctuation">,</span><br>      <span class="token string">'projects'</span><span class="token punctuation">,</span><br>      <span class="token string">'Node'</span><span class="token punctuation">,</span><br>      <span class="token string">'WiP'</span><span class="token punctuation">,</span><br>      <span class="token string">'archiving'</span><span class="token punctuation">,</span><br>      <span class="token string">'embeds'</span><span class="token punctuation">,</span><br>      <span class="token string">'Twitter'</span><br>    <span class="token punctuation">]</span><span class="token punctuation">,</span><br>    date<span class="token operator">:</span> <span class="token number">2022</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">07</span>T02<span class="token operator">:</span><span class="token number">59</span><span class="token operator">:</span><span class="token number">43.100</span>Z<span class="token punctuation">,</span><br>    project<span class="token operator">:</span> <span class="token string">'Context Pages'</span><span class="token punctuation">,</span><br>    repo<span class="token operator">:</span> <span class="token string">'https://github.com/AramZS/contexter'</span><span class="token punctuation">,</span><br>    featuredImage<span class="token operator">:</span> <span class="token string">'radial_crosshair.jpg'</span><span class="token punctuation">,</span><br>    title<span class="token operator">:</span> <span class="token string">'Day 14: Testing the Contexter in action'</span><span class="token punctuation">,</span><br>    page<span class="token operator">:</span> <span class="token punctuation">{</span><br>      date<span class="token operator">:</span> <span class="token number">2022</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">07</span>T02<span class="token operator">:</span><span class="token number">59</span><span class="token operator">:</span><span class="token number">43.100</span>Z<span class="token punctuation">,</span><br>      inputPath<span class="token operator">:</span> <span class="token string">'./src/posts/projects/context-pages/day-14.md'</span><span class="token punctuation">,</span><br>      fileSlug<span class="token operator">:</span> <span class="token string">'day-14'</span><span class="token punctuation">,</span><br>      filePathStem<span class="token operator">:</span> <span class="token string">'/posts/projects/context-pages/day-14'</span><span class="token punctuation">,</span><br>      outputFileExtension<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span><br>      url<span class="token operator">:</span> <span class="token string">'/posts/projects/context-pages/day-14/'</span><span class="token punctuation">,</span><br>      outputPath<span class="token operator">:</span> <span class="token string">'docs/posts/projects/context-pages/day-14/index.html'</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    collections<span class="token operator">:</span> <span class="token punctuation">{</span><br>      all<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      blogroll<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'Personal Blog'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      links<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'Code Reference'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Sass<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'11ty'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token constant">NPM</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'Product Output'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'Tech Critical'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Blockchain<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Cryptocurrency<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      posts<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Writing<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Collaboration<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'Open Source'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'Ad Tech'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'BAd Tech'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'Broken By Design'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      projects<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Node<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      WiP<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Analytics<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Privacy<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Metrics<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      archiving<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Twitter<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      embeds<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      oembed<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      opengraph<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      metadata<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      hcard<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token constant">RDF</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'JSON-LD'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'Schema Dot Org'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'Structured Data'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Markdown<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'Markdown-It'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'Internet Archive'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      fetch<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      research<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'Memento API'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Starters<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      dinky<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      nvm<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'GitHub Pages'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Nunjucks<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Shortcodes<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'GitHub Actions'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token constant">CSS</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token constant">GPC</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'Dart Sass'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token constant">SEO</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token constant">SMO</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token constant">YAML</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Aggregation<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Mustache<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'Code Blocks'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      a11y<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      GitHub<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'GitHub API'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Prism<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'Source Maps'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Sitemaps<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Cachebreak<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Mocha<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token constant">RSS</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'Cache breaking'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      Retros<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token string">'30m'</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      <span class="token constant">SCSS</span><span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      tagList<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      deepLinkPostsList<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      projectsPages<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      deepProjectPostsList<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      postsPages<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span><br>      deepTagList<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p id="code-skip-day-15-5">Ok, where can I get it?</p>
<p>My <code>compiler</code> function only gets the basic data, the file path and content. But of course, the Markdown-It function has to get this data at some point? How does it even get set?</p>
<p>Looks like <a href="https://markdown-it.github.io/markdown-it/#MarkdownIt.render" target="_blank">env gets passed into the Markdown-It render function</a>. Ok, what's the <code>data</code> argument that gets passed into the function I return from the compiler?</p>
<p>Let's log it.</p>
<p>Bingo! Ok, so we're going to have a bit of a complicated set up, the function that handles rendering the contexter output and passing it into the Markdown-It object is going to have to be pre-defined and passed into the returned function.</p>
<p class="skip-link-graf">
<a href="#code-skip-day-15-4" id="skip-to-code-skip-day-15-4" class="skip-link">Skip code block ▼</a></p>
<pre class="language-javascript"><code class="language-javascript">	<span class="token keyword">const</span> <span class="token function-variable function">reMarkdown</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">inputContent<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>		<span class="token keyword">if</span> <span class="token punctuation">(</span><br>			inputContent<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><br>				<span class="token string">"https://twitter.com/Chronotope/status/1402628536121319424"</span><br>			<span class="token punctuation">)</span><br>		<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"inputContent Process"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>			<span class="token keyword">let</span> pContext <span class="token operator">=</span> <span class="token function">contexter</span><span class="token punctuation">(</span><br>				<span class="token string">"https://twitter.com/Chronotope/status/1485620069229027329"</span><br>			<span class="token punctuation">)</span><span class="token punctuation">;</span><br>		<span class="token punctuation">}</span><br>		<span class="token comment">// 2nd argument sets env</span><br>		<span class="token keyword">return</span> options<span class="token punctuation">.</span>existingRenderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>inputContent<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<span class="token punctuation">}</span><span class="token punctuation">;</span><br>	<span class="token keyword">const</span> <span class="token function-variable function">compiler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">inputContent<span class="token punctuation">,</span> inputPath</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>		<span class="token keyword">let</span> remark <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><br>		<span class="token keyword">if</span> <span class="token punctuation">(</span><br>			inputContent <span class="token operator">&amp;&amp;</span><br>			inputPath <span class="token operator">&amp;&amp;</span><br>			inputPath<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>options<span class="token punctuation">.</span>extension<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><br>		<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>			remark <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><br>		<span class="token punctuation">}</span><br>		<span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>			<span class="token keyword">if</span> <span class="token punctuation">(</span>remark <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">.</span>layout <span class="token operator">&amp;&amp;</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">post</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>layout<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>				<span class="token keyword">const</span> rmResult <span class="token operator">=</span> <span class="token function">reMarkdown</span><span class="token punctuation">(</span>inputContent<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span><br>				<span class="token keyword">return</span> rmResult<span class="token punctuation">;</span><br>			<span class="token punctuation">}</span><br>			<span class="token comment">// You can also access the default `markdown-it` renderer here:</span><br>			<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">defaultRenderer</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><br>		<span class="token punctuation">}</span><span class="token punctuation">;</span><br>	<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p id="code-skip-day-15-4">Ok, now to write some files!</p>
<p>Hmmm, to get the file name, I'll need to be able to get the link ID and the sanitized link before initiating the promise. I'll have to restructure the main object to return those functions.</p>
<p><a target="_blank" href="https://github.com/AramZS/contexter/commit/05865c8911487986fde6f6ccd7a58994f1b0d6e1" class="git-commit-link"><code>git commit -am &quot;Small fixes and getting link utils facing out of the module&quot;</code></a></p>
<p>Ok, now to pull the URLs in with the regex. I'm going to name the regex group and use <code>exec</code> to pull just the URL along with the full match to make it possible to replace in the text.</p>
<p>Here's the final regex:</p>
<p class="skip-link-graf">
<a href="#code-skip-day-15-3" id="skip-to-code-skip-day-15-3" class="skip-link">Skip code block ▼</a></p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> urlRegex <span class="token operator">=</span><br>	<span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^(?:[\t\- ]*)(?&lt;main>(\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()&lt;>]+|\(([^\s()&lt;>]+|(\([^\s()&lt;>]+\)))*\))+(?:\(([^\s()&lt;>]+|(\([^\s()&lt;>]+\)))*\)|[^\s`!()\[\]{};:'".,&lt;>?«»“”‘’]))(?=\n|\r)$)+)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gim</span></span><span class="token punctuation">;</span></code></pre>
<hr />
<p id="code-skip-day-15-3">EDIT (3/14/2023): <em>Don't use the above Regex</em>. It turns out to have a <a href="https://www.regular-expressions.info/catastrophic.html" target="_blank">catastrophic</a> <a href="https://javascript.info/regexp-catastrophic-backtracking" target="_blank">backtracking</a> problem caused when the line ends on a space. Here is the Regex I quickly switched to, though I am still testing:</p>
<p class="skip-link-graf">
<a href="#code-skip-day-15-2" id="skip-to-code-skip-day-15-2" class="skip-link">Skip code block ▼</a></p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> urlRegex <span class="token operator">=</span><br>	<span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^([\t\- ]*)*(?&lt;main>(\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()&lt;>]+|\(([^\s()&lt;>]+|(\([^\s()&lt;>]+\)))*\))+(?:\(([^\s()&lt;>]+|(\([^\s()&lt;>]+\)))*\)|[^\s`!()\[\]{};:'".,&lt;>?«»“”‘’])))+)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gim</span></span><span class="token punctuation">;</span></code></pre>
<hr />
<p id="code-skip-day-15-2">Here's how I handled the walkthrough of the regex results:</p>
<p class="skip-link-graf">
<a href="#code-skip-day-15-1" id="skip-to-code-skip-day-15-1" class="skip-link">Skip code block ▼</a></p>
<pre class="language-javascript"><code class="language-javascript">		<span class="token keyword">let</span> matchArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>		<span class="token keyword">let</span> urlsArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>		<span class="token keyword">let</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br>		<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>matchArray <span class="token operator">=</span> urlRegex<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>inputContent<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>			<span class="token keyword">if</span> <span class="token punctuation">(</span>urls<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><br>					<span class="token string">"Found URLs"</span><span class="token punctuation">,</span><br>					matchArray<span class="token punctuation">.</span>groups<span class="token punctuation">.</span>main<span class="token punctuation">,</span><br>					matchArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><br>				<span class="token punctuation">)</span><span class="token punctuation">;</span><br>				urlsArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>					url<span class="token operator">:</span> matchArray<span class="token punctuation">.</span>groups<span class="token punctuation">.</span>main<span class="token punctuation">,</span><br>					replace<span class="token operator">:</span> matchArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>				counter<span class="token operator">++</span><span class="token punctuation">;</span><br>			<span class="token punctuation">}</span><br>		<span class="token punctuation">}</span><br>		<span class="token keyword">if</span> <span class="token punctuation">(</span>urlsArray<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>			urlsArray<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">urlObj</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>				<span class="token keyword">const</span> link <span class="token operator">=</span> urlObj<span class="token punctuation">.</span>url<span class="token punctuation">;</span><br>				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"inputContent Process"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>				<span class="token comment">// console.log("inputContent treated", inputContent);</span><br>				<span class="token keyword">const</span> <span class="token punctuation">{</span> cacheFolder<span class="token punctuation">,</span> cacheFile <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">cacheFilePath</span><span class="token punctuation">(</span><br>					<span class="token string">""</span><span class="token punctuation">,</span><br>					contexter<span class="token punctuation">.</span><span class="token function">uidLink</span><span class="token punctuation">(</span>contexter<span class="token punctuation">.</span><span class="token function">sanitizeLink</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">)</span><br>				<span class="token punctuation">)</span><span class="token punctuation">;</span><br>				<span class="token keyword">try</span> <span class="token punctuation">{</span><br>					fs<span class="token punctuation">.</span><span class="token function">accessSync</span><span class="token punctuation">(</span>cacheFile<span class="token punctuation">,</span> fs<span class="token punctuation">.</span>constants<span class="token punctuation">.</span><span class="token constant">F_OK</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>					<span class="token keyword">const</span> contextString <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>cacheFile<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>					<span class="token keyword">const</span> contextData <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>contextString<span class="token punctuation">)</span><span class="token punctuation">;</span><br>					<span class="token comment">// console.log("contextData", contextData);</span><br>					<span class="token comment">// const contextData = JSON.parse(contextString);</span><br>					inputContent <span class="token operator">=</span> inputContent<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><br>						urlObj<span class="token punctuation">.</span>replace<span class="token punctuation">,</span><br>						contextData<span class="token punctuation">.</span>htmlEmbed<br>					<span class="token punctuation">)</span><span class="token punctuation">;</span><br>				<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>					<span class="token keyword">let</span> pContext <span class="token operator">=</span> contexter<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">;</span><br>					<span class="token comment">// No file yet</span><br>					console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><br>						<span class="token string">"Cached link "</span> <span class="token operator">+</span> cacheFile <span class="token operator">+</span> <span class="token string">" to repo not ready"</span><br>					<span class="token punctuation">)</span><span class="token punctuation">;</span><br>					pContext<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">r</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Context ready"</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span>linkId<span class="token punctuation">)</span><span class="token punctuation">;</span><br>						<span class="token comment">// No file yet</span><br>						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><br>							<span class="token string">"Cached link for "</span> <span class="token operator">+</span> cacheFile <span class="token operator">+</span> <span class="token string">" ready to write."</span><br>						<span class="token punctuation">)</span><span class="token punctuation">;</span><br>						<span class="token keyword">try</span> <span class="token punctuation">{</span><br>							fs<span class="token punctuation">.</span><span class="token function">mkdirSync</span><span class="token punctuation">(</span>cacheFolder<span class="token punctuation">,</span> <span class="token punctuation">{</span> recursive<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>							<span class="token comment">// console.log('write data to file', cacheFile)</span><br>							fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>cacheFile<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>						<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>							console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"writing to cache failed:"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span><br>						<span class="token punctuation">}</span><br>					<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>				<span class="token punctuation">}</span><br>			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>		<span class="token punctuation">}</span></code></pre>
<p id="code-skip-day-15-1">Ok, my treatment here <a href="https://github.com/AramZS/devblog/commit/b76853b38f74735fc7a1783ee176ce65b9bbdf84" target="_blank">looks good</a>! Only, the embeds don't look so good. Ok, looks like we have some work to do in terms of how the HTML can work, but the basic concept is very sound.</p>
<p>The last difficulty is setting up some archive pages that I can generate out of the JSON I cache local to the site on the basis of links. It isn't perfect, but a simple run at this makes sense first, I can have more complex archive pages, or WARCs or both later. This <a href="https://github.com/AramZS/devblog/commit/8a58ec6a9255301dd095694870d37939b2aa1d75" target="_blank">also turns out to be more complicated than I expected</a>. There's some weirdness here. For some reason <code>eleventyComputed</code> doesn't take every property I set up in it, but I can use the object itself. I took a first run at a Twitter object, but <a href="https://github.com/AramZS/devblog/commit/8a58ec6a9255301dd095694870d37939b2aa1d75#diff-2921b80376a7612f0dc51a098f3d81ad1f5d8a94c9955b6e1795313c3f0ca960R108" target="_blank">it doesn't work like I'd hoped</a>.</p>
<p>I am going to need richer user data. Let's give it a try.</p>
<p><a target="_blank" href="https://github.com/AramZS/contexter/commit/a67ff2f63b26e7ae63904ffb2f1f3ee113f1ef08" class="git-commit-link"><code>git commit -am &quot;Just use the data property, like everywhere else, on the main tweet and add in user data&quot;</code></a></p>

                    
                    </section>
                    <section id="postcontent">
                    
    <script src="https://utteranc.es/client.js"
            repo="AramZS/fightwithtools-comments"
            issue-term="title"
            theme="github-dark"
            crossorigin="anonymous"
            async>
    </script>
    
        
        
        <div class="pagination">
            <a href="/posts/projects/context-pages/day-14/" class="pagination-link cursor-pointer ">Previous Day</a>

            <a href="/posts/projects/context-pages/day-16/" class="pagination-link cursor-pointer ">Next Day</a>
        </div>
    
    <div class="social-icons-block">
    <div class="a-social-icon">
        <a href="https://github.com/AramZS/" target="_blank">
            <svg role="img" viewBox="0 0 24 24" class="twitter-icon social-icon" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>


<!-- https://simpleicons.org/?q=github -->

        </a>
    </div>
    <div class="a-social-icon">
        <a href="https://bit.ly/aramzs" target="_blank">
            <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>


<!-- https://simpleicons.org/?q=linked -->

        </a>
    </div>
    <div class="a-social-icon">
        <a href="https://twitter.com/Chronotope" target="_blank">
            <svg role="img" class="twitter-icon social-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Twitter</title><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/></svg>

<!-- https://simpleicons.org/?q=tw -->

        </a>
    </div>
    
    <div class="a-social-icon">
        <a href="https://indieweb.social/@Chronotope" rel="me" target="_blank">
            <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Mastodon</title><path d="M23.193 7.88c0-5.207-3.411-6.733-3.411-6.733C18.062.357 15.108.025 12.041 0h-.076c-3.069.025-6.02.357-7.74 1.147 0 0-3.412 1.526-3.412 6.732 0 1.193-.023 2.619.015 4.13.124 5.092.934 10.11 5.641 11.355 2.17.574 4.034.695 5.536.612 2.722-.15 4.25-.972 4.25-.972l-.09-1.975s-1.945.613-4.13.54c-2.165-.075-4.449-.234-4.799-2.892a5.5 5.5 0 0 1-.048-.745s2.125.52 4.818.643c1.646.075 3.19-.097 4.758-.283 3.007-.359 5.625-2.212 5.954-3.905.517-2.665.475-6.508.475-6.508zm-4.024 6.709h-2.497v-6.12c0-1.29-.543-1.944-1.628-1.944-1.2 0-1.802.776-1.802 2.313v3.349h-2.484v-3.35c0-1.537-.602-2.313-1.802-2.313-1.085 0-1.628.655-1.628 1.945v6.119H4.831V8.285c0-1.29.328-2.314.987-3.07.68-.759 1.57-1.147 2.674-1.147 1.278 0 2.246.491 2.886 1.474L12 6.585l.622-1.043c.64-.983 1.608-1.474 2.886-1.474 1.104 0 1.994.388 2.674 1.146.658.757.986 1.781.986 3.07v6.305z"/></svg>

<!-- https://simpleicons.org/?q=mastodon -->

        </a>
    </div>

</div>


                    </section>
                </main>
                <footer>
                    
    <div id="taglist">
        <h6>Tags: </h6>
        <ul><li>
                    <a href="https://fightwithtools.dev/tag/node">Node</a>
                </li><li>
                    <a href="https://fightwithtools.dev/tag/wip">WiP</a>
                </li><li>
                    <a href="https://fightwithtools.dev/tag/archiving">archiving</a>
                </li><li>
                    <a href="https://fightwithtools.dev/tag/embeds">embeds</a>
                </li><li>
                    <a href="https://fightwithtools.dev/tag/twitter">Twitter</a>
                </li></ul>
    </div>

                    
                        <p>
                            <small>Hosted on <a href="https://pages.github.com" target="_blank">GitHub Pages</a> based on <a href="https://github.com/pages-themes/dinky" target="_blank">the Dinky theme</a>. <a href="https://github.com/AramZS/devblog" target="_blank">See the code</a>.</small>
                        </p>
                    
                    
                </footer>
            </div>
            <!--[if !IE]><script>fixScale(document);</script><![endif]-->
        </body>
    </html>
