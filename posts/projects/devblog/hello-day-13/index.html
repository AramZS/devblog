<!doctype html>

		<html lang="en-US" id="template-base">
		
		<head>
			
				<meta charset="utf-8">
				<meta http-equiv="X-UA-Compatible" content="IE=edge">
				<title>Hello World Devblog - Pt. 13</title>
				<link href="/assets/prism-okaidia.css" rel="preload" as="style">
				<link href="/assets/prism-okaidia.css" rel="stylesheet">
				<link rel="stylesheet" href="/assets/css/style.css?v=1092443760">
				
				<!-- Build Revision: 1092443760 & Sha: 62a347bb11f9ee93692f1af11136a14dde5d0d8d -->
				<script src="/assets/js/scale.fix.js"></script>
				<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
				<!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
			
			
			
		</head>
		<body>
			<div class="wrapper">
				<header>
					
						
							<div id="site-name-subhead">
								<a href="https://fightwithtools.dev">Fight With Tools: A Dev Blog</a>
								
									> <a id="project-link" href="https://fightwithtools.dev/projects/devblog">Dev Blog</a>
								
							</div>
						
						
							<!-- post mode -->
							<script>
								console.log([object Object])
							</script>
							<time>Fri Jul 23 2021</time>
							<!-- front matter dates made in format at https://yaml.org/type/timestamp.html -->
						
						<h1 class="header">
							Hello World Devblog - Pt. 13
						</h1>
						<p class="header">Part 13 of setting up 11ty dev blog.</p>

					
				</header>
				<main>
					<section id="precontent">
						
					</section>
					<section id="contet">
						
							<ol>
<li>Static Site Generator that can build the blog and let me host it on Github Pages</li>
<li>I want to write posts in Markdown because I'm lazy, it's easy, and it is how I take notes now.</li>
<li>I don't want to spend a ton of time doing design work. I'm doing complicated designs for other projects, so I want to pull a theme I like that I can rely on someone else to keep up.</li>
<li>Once it gets going, I want template changes to be easy.</li>
<li>It should be as easy as Jekyll, so I need to be able to build it using GitHub Actions, where I can just commit a template change or Markdown file and away it goes. If I can't figure this out than fk it, just use Jekyll.</li>
<li>I require it to be used by a significant percent of my professional peers so I can get easy answers when something goes wrong.</li>
<li>I want source maps. This is a dev log site which means whatever I do with it should be easy for other developers to read.</li>
</ol>
<ul class="task-list">
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Also <a href="https://www.npmjs.com/package/@quasibit/eleventy-plugin-sitemap" target="_blank">the sitemap plugin</a> looks cool. Should grab that later.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo"></input> So does the <a href="https://www.npmjs.com/package/eleventy-plugin-reading-time" target="_blank">reading time one</a>.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo"></input> Also <a href="https://github.com/jdsteinbach/eleventy-plugin-toc/" target="_blank">this TOC plugin</a> mby?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Use <a href="https://www.11ty.dev/docs/data-deep-merge/" target="_blank">Data Deep Merge</a> in this blog.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo"></input> Decide if I want to render the CSS fancier than just a base file and do per-template splitting.</p>
</li>
</ul>
<s>
<ul class="task-list">
<li class="task-list-item"><input disabled="true" type="checkbox" class="markdown-todo"></input> Can I use the template inside of dinky that already exists instead of copy/pasting it?</li>
</ul>
</s>
<ul class="task-list">
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo"></input> Is there a way to have permalinks to posts contain metadata without organizing them into subfolders?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> How do I cachebreak files on the basis of new build events? Datetime? <code>site.github.build_revision</code> is <a href="https://github.com/jekyll/github-metadata/blob/master/docs/site.github.md" target="_blank">how Jekyll accomplishes this</a>, but is there a way to push <a href="https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context" target="_blank">that</a> <a href="https://stackoverflow.com/questions/54310050/how-to-version-build-artifacts-using-github-actions" target="_blank">into the build process</a> for 11ty?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Make link text look less shitty. It looks like it is a whole, lighter, font.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Code blocks do not have good syntax highlighting. I want good syntax highlighting.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo"></input> Build a Markdown-it plugin to take my typing shortcuts <code>[prob, b/c, ...?]</code> and expand them on build.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo"></input> See if we can start Markdown's interpretation of H tags to <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/Heading_Elements#multiple_h1" target="_blank">start at 2, since H1</a> is always pulled from the page title metadata. If it isn't easy, I just have to change my pattern of writing in the MD documents.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo"></input> Should I <a href="https://www.madebymike.com.au/writing/11ty-filters-data-shortcodes/" target="_blank">explore some shortcodes</a>?</p>
</li>
</ul>
<h2 id="Day-13" tabindex="-1">Day 13</h2>
<p>Ok, I'm trying to create a taxonomy that queries projects so I can list posts by their parent project. I tried to do it with <code>addGlobalData</code> but that's apparently a future feature of 11ty. So I'm headed back from DC now on the Acela (it's been a long time since the last time that was true) so it's coooooooooooooooode time.</p>
<p>The main thing to note here is I want to be able to get:</p>
<ol>
<li>A list of &quot;projects&quot;</li>
<li>A list of posts under each Project.</li>
</ol>
<p>So instead I'm going to use the global data folder <code>_data</code> and move my operation over there.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// In src/_data/projects.js</span><br><span class="token keyword">const</span> <span class="token punctuation">{</span> readdirSync <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token function-variable function">getDirectories</span> <span class="token operator">=</span> <span class="token parameter">source</span> <span class="token operator">=></span><br><span class="token function">readdirSync</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span> <span class="token punctuation">{</span> withFileTypes<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><br>	<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">dirent</span> <span class="token operator">=></span> dirent<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>	<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">dirent</span> <span class="token operator">=></span> dirent<span class="token punctuation">.</span>name<span class="token punctuation">)</span><br><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getDirectories</span><span class="token punctuation">(</span><span class="token string">'src/posts/projects/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">getDirectories</span><span class="token punctuation">(</span><span class="token string">'src/posts/projects/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>And now I have a global data object I can iterate over. Sweet!</p>
<pre class="language-liquid"><code class="language-liquid">		{<span class="token operator">%</span><span class="token operator">-</span> <span class="token keyword">for</span> project <span class="token keyword">in</span> projects <span class="token operator">%</span>}<br>			<span class="token operator">&lt;</span>li class<span class="token operator">=</span>"capitalize<span class="token operator">-</span>first"<span class="token operator">></span>{{project}}<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span><br>		{<span class="token operator">%</span><span class="token operator">-</span> <span class="token keyword">endfor</span> <span class="token operator">%</span>}</code></pre>
<p>Ok, now that I have the list of projects. I need to do something with them. Basically these should link to project pages that work like category pages in WordPress.</p>
<p>But before I get to that, every time I go through a tunnel my local environment dies because it is loading a remote URL for my Prism styles. Let's fix that. I'm going to copy it locally and set up a passthrough.</p>
<p>Ok, and while I'm here, let me add proper categories for the home page.</p>
<p>Oh wait, that didn't work. It doesn't have the capacity to handle empty collections. I thought I'd get an empty array, but apparently not. Ok, I'll write some checks in to my shortcode.</p>
<p><code>git commit -m &quot;Setting up home page structure with local prism css&quot;</code></p>
<p>Ok. That worked. Time to read about <a href="https://www.11ty.dev/docs/pages-from-data/" target="_blank">building Pages from Data with 11ty</a>.</p>
<p>Ok so, let's build it out at <code>project-pages.njk</code>.</p>
<pre class="language-liquid"><code class="language-liquid"><span class="token operator">--</span><span class="token operator">-</span><br>pagination<span class="token operator">:</span><br>    data<span class="token operator">:</span> projects<br>    <span class="token function">size</span><span class="token operator">:</span> <span class="token number">1</span><br>    alias<span class="token operator">:</span> project<br>permalink<span class="token operator">:</span> "projects<span class="token operator">/</span>{{ project <span class="token operator">|</span> slug }}<span class="token operator">/</span>"<br>title<span class="token operator">:</span> "Project<span class="token operator">:</span> {{ project <span class="token operator">|</span> slug }}"<br><span class="token operator">--</span><span class="token operator">-</span><br><br>{<span class="token operator">%</span> block postcontent <span class="token operator">%</span>}<br>	<span class="token operator">&lt;</span>h3 class<span class="token operator">=</span>"capitalize<span class="token operator">-</span>first"<span class="token operator">></span>{{project}}<span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">></span><br><br>	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> post list<span class="token operator">:</span> <span class="token operator">--</span><span class="token operator">></span><br>{<span class="token operator">%</span> endblock <span class="token operator">%</span>}</code></pre>
<p>Alright, the page is getting built, but the title meta isn't populated. How to fix?</p>
<p>Ok, <a href="https://github.com/11ty/eleventy/issues/1061#issuecomment-606217361" target="_blank">it doesn't appear to be clearly documented, but I need to use</a> <code>eleventyComputed</code></p>
<p>So I replace the <code>title</code> property as follows:</p>
<pre class="language-liquid"><code class="language-liquid"><span class="token operator">--</span><span class="token operator">-</span><br>pagination<span class="token operator">:</span><br>    data<span class="token operator">:</span> projects<br>    <span class="token function">size</span><span class="token operator">:</span> <span class="token number">1</span><br>    alias<span class="token operator">:</span> project<br>permalink<span class="token operator">:</span> "projects<span class="token operator">/</span>{{ project <span class="token operator">|</span> slug }}<span class="token operator">/</span>"<br>eleventyComputed<span class="token operator">:</span><br>  title<span class="token operator">:</span> "Project<span class="token operator">:</span> {{ project.title }}"<br><span class="token operator">--</span><span class="token operator">-</span></code></pre>
<p>Ok, I'm getting the title now. But I want to filter the list of project posts by the project metadata.</p>
<p>This is more complicated.</p>
<p>But ok, here's what I ended up doing</p>
<p>First, I needed to make the project global data object even more complicated. It now needs a Title, a slug and a <code>projectName</code>.</p>
<p>To fill out that projectName I need to stop putting the project data in the blog post and instead put it in the<br>
<a href="https://www.11ty.dev/docs/data-template-dir/" target="_blank">directory's data file</a>.</p>
<p>Then I need to pull the content of that data file into my new global object's <code>projectName</code> like so:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> readdirSync <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><br><br><span class="token keyword">const</span> <span class="token function-variable function">getDirectories</span> <span class="token operator">=</span> <span class="token parameter">source</span> <span class="token operator">=></span><br><span class="token function">readdirSync</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span> <span class="token punctuation">{</span> withFileTypes<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><br>	<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">dirent</span> <span class="token operator">=></span> dirent<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>	<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">dirent</span> <span class="token operator">=></span> dirent<span class="token punctuation">.</span>name<span class="token punctuation">)</span><br><br><span class="token keyword">const</span> directorySet <span class="token operator">=</span> <span class="token function">getDirectories</span><span class="token punctuation">(</span><span class="token string">'src/posts/projects/'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><br>	<span class="token punctuation">(</span><span class="token parameter">projectDir</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>		<span class="token keyword">return</span> <span class="token punctuation">{</span><br>			title<span class="token operator">:</span> projectDir<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> projectDir<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>			slug<span class="token operator">:</span> projectDir<span class="token punctuation">,</span><br>			projectName<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./src/posts/projects/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>projectDir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>projectDir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.json</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>project<br>		<span class="token punctuation">}</span><br>	<span class="token punctuation">}</span><br><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Now the pages that I'm generating for individual projects can filter by that value:</p>
<pre class="language-liquid"><code class="language-liquid">	<span class="token operator">&lt;</span>ul<span class="token operator">></span><br>		{<span class="token operator">%</span><span class="token operator">-</span> <span class="token keyword">for</span> post <span class="token keyword">in</span> collections.projects <span class="token operator">-</span><span class="token operator">%</span>}<br>			{<span class="token operator">%</span> <span class="token keyword">if</span> post.data.project <span class="token operator">==</span> project.projectName <span class="token operator">%</span>}<br>				<span class="token operator">&lt;</span>li<span class="token operator">></span><br>					<span class="token operator">&lt;</span>a href<span class="token operator">=</span>"{{ post.url }}"<span class="token operator">></span>{{ post.data.title }}<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><br>				<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span><br>			{<span class="token operator">%</span> <span class="token keyword">endif</span> <span class="token operator">%</span>}<br>		{<span class="token operator">%</span><span class="token operator">-</span> <span class="token keyword">endfor</span> <span class="token operator">-</span><span class="token operator">%</span>}<br>	<span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span></code></pre>
<p>Ok, it works!</p>
<p><code>git commit -am &quot;Project pages&quot;</code></p>
<p>Ok, I'm going to add a description for the overall project and make it available the same way. Looks good.</p>
<p>I want to show tags in the sidebar/footer but the current layout isn't great. I'll have to add CSS to handle it.</p>
<p>Ok, train ride is over!</p>
<p><code>git commit -am &quot;Finishing project pages&quot;</code></p>

						
					</section>
					<section id="postcontent">
						
					</section>
				</main>
				<footer>
					
	<div id="taglist">
		Tags:&nbsp;posts,projects,Starters,11ty,Node,Sass,Github Actions,WiP,</div>

					
						<p>
							<small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small>
						</p>
					
					
				</footer>
			</div>
			<!--[if !IE]><script>fixScale(document);</script><![endif]-->
		</body>
	</html>
