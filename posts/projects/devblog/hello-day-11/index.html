<!doctype html>

		<html lang="en-US" id="template-base">
		
		<head>
			
				<meta charset="utf-8">
				<meta http-equiv="X-UA-Compatible" content="IE=edge">
				<title>Hello World Devblog - Pt. 11</title>
				<link href="/assets/prism-okaidia.css" rel="preload" as="style">
				<link href="/assets/prism-okaidia.css" rel="stylesheet">
				<link rel="stylesheet" href="/assets/css/style.css?v=1063463464">
				
				<!-- Build Revision: 1063463464 & Sha: 7e0f8e6a4cd87b192370375142bbe02d58f56cd9 -->
				<script src="/assets/js/scale.fix.js"></script>
				<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
				<!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
			
			
			
		</head>
		<body>
			<div class="wrapper">
				<header>
					
						
							<div id="site-name-subhead">
								<a href="https://fightwithtools.dev">Fight With Tools: A Dev Blog</a>
								
									> <a id="project-link" href="https://fightwithtools.dev/projects/devblog">Dev Blog</a>
								
							</div>
						
						
							<!-- post mode -->
							<script>
								console.log([object Object])
							</script>
							<time>Tue Jul 06 2021</time>
							<!-- front matter dates made in format at https://yaml.org/type/timestamp.html -->
						
						<h1 class="header">
							Hello World Devblog - Pt. 11
						</h1>
						<p class="header">Part 8 of setting up 11ty dev blog.</p>

					
				</header>
				<main>
					<section id="precontent">
						
					</section>
					<section id="contet">
						
							<ol>
<li>Static Site Generator that can build the blog and let me host it on Github Pages</li>
<li>I want to write posts in Markdown because I'm lazy, it's easy, and it is how I take notes now.</li>
<li>I don't want to spend a ton of time doing design work. I'm doing complicated designs for other projects, so I want to pull a theme I like that I can rely on someone else to keep up.</li>
<li>Once it gets going, I want template changes to be easy.</li>
<li>It should be as easy as Jekyll, so I need to be able to build it using GitHub Actions, where I can just commit a template change or Markdown file and away it goes. If I can't figure this out than fk it, just use Jekyll.</li>
<li>I require it to be used by a significant percent of my professional peers so I can get easy answers when something goes wrong.</li>
<li>I want source maps. This is a dev log site which means whatever I do with it should be easy for other developers to read.</li>
</ol>
<ul class="task-list">
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Also <a href="https://www.npmjs.com/package/@quasibit/eleventy-plugin-sitemap" target="_blank">the sitemap plugin</a> looks cool. Should grab that later.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo"></input> So does the <a href="https://www.npmjs.com/package/eleventy-plugin-reading-time" target="_blank">reading time one</a>.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo"></input> Also <a href="https://github.com/jdsteinbach/eleventy-plugin-toc/" target="_blank">this TOC plugin</a> mby?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Use <a href="https://www.11ty.dev/docs/data-deep-merge/" target="_blank">Data Deep Merge</a> in this blog.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo"></input> Decide if I want to render the CSS fancier than just a base file and do per-template splitting.</p>
</li>
</ul>
<s>
<ul class="task-list">
<li class="task-list-item"><input disabled="true" type="checkbox" class="markdown-todo"></input> Can I use the template inside of dinky that already exists instead of copy/pasting it?</li>
</ul>
</s>
<ul class="task-list">
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo"></input> Is there a way to have permalinks to posts contain metadata without organizing them into subfolders?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> How do I cachebreak files on the basis of new build events? Datetime? <code>site.github.build_revision</code> is <a href="https://github.com/jekyll/github-metadata/blob/master/docs/site.github.md" target="_blank">how Jekyll accomplishes this</a>, but is there a way to push <a href="https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context" target="_blank">that</a> <a href="https://stackoverflow.com/questions/54310050/how-to-version-build-artifacts-using-github-actions" target="_blank">into the build process</a> for 11ty?</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Make link text look less shitty. It looks like it is a whole, lighter, font.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" checked="true" class="markdown-todo"></input> Code blocks do not have good syntax highlighting. I want good syntax highlighting.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo"></input> Build a Markdown-it plugin to take my typing shortcuts <code>[prob, b/c, ...?]</code> and expand them on build.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo"></input> See if we can start Markdown's interpretation of H tags to <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/Heading_Elements#multiple_h1" target="_blank">start at 2, since H1</a> is always pulled from the page title metadata. If it isn't easy, I just have to change my pattern of writing in the MD documents.</p>
</li>
<li class="task-list-item">
<p><input disabled="true" type="checkbox" class="markdown-todo"></input> Should I <a href="https://www.madebymike.com.au/writing/11ty-filters-data-shortcodes/" target="_blank">explore some shortcodes</a>?</p>
</li>
</ul>
<h2>Day 11</h2>
<p>Ok, still not getting Macros working exactly the way I wanted. It would be really useful to have 11ty throw actual errors as part of this, but when I tried to set my own version of the Nunjucks Environment I kept hitting against undocumented settings that 11ty apparently sets up. This is getting way off the main thing I was trying to build. I could dive deeper in, but this site still isn't live and I would like to get it to that point first. So, for now, I'm going to just drop it.</p>
<p>But before I do, I do think this is a major problem and would be useful for eleventy to fix. So, let's check issues one last time, and check if there is something for me to file.</p>
<p>It looks like <a href="https://github.com/11ty/eleventy/issues/895" target="_blank">there is an issue in the right space</a>, but the suggested solution on the issue doesn't work. If I <a href="https://github.com/pdehaan/11ty-blog-ideas/issues/7" target="_blank">follow through the tickets</a> a little more I can <a href="https://github.com/pdehaan/11ty-nunjucks-config/blob/master/.eleventy.js" target="_blank">see another suggested solution</a>. But it doesn't solve the issue with the raw tags no longer working either.</p>
<p>I don't understand. <a href="https://github.com/11ty/eleventy/blob/master/src/Engines/Nunjucks.js#L128" target="_blank">This</a> <em>should</em> work. I even checked to make sure my version of Nunjucks is the same! I even tried removing one of the files, but now my Nunjucks execution is failing on a different chunk of JS in the <code>js</code> front matter block in <code>rss2-feed.njk</code>.</p>
<p>So let's add my voice.</p>
<p><code>git commit -am &quot;Bookmarking attempt to set custom NJK library.&quot;</code></p>
<p>A quick bookmark of the current state of the site to help the Eleventy folks with debugging my issue!</p>
<p>And now <a href="https://github.com/11ty/eleventy/issues/1879" target="_blank">a write up</a>!</p>
<p>Ok, let's move on!</p>
<p>I'm going to give up on Macros for now and instead I'll <a href="https://www.11ty.dev/docs/languages/nunjucks/#single-shortcode" target="_blank">use a Shortcode</a>.</p>
<p>Ok, honestly this is a <strong>ton</strong> easier. I should have just gone this direction in the first place.</p>
<pre class="language-javascript"><code class="language-javascript">	eleventyConfig<span class="token punctuation">.</span><span class="token function">addShortcode</span><span class="token punctuation">(</span><span class="token string">"postList"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">collectionName<span class="token punctuation">,</span> collectionOfPosts</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>		<span class="token keyword">let</span> postList <span class="token operator">=</span> collectionOfPosts<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">post</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>			<span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;li></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>post<span class="token punctuation">.</span>data<span class="token punctuation">.</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/li></span><span class="token template-punctuation string">`</span></span><br>		<span class="token punctuation">}</span><span class="token punctuation">)</span><br>		<span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;p></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>collectionName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/p><br>		&lt;ul><br>			&lt;!-- Collection: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>collectionName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> --><br>			</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>postList<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"><br>		&lt;/ul><br>		</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>and then I can call it easily with 11ty data like this:</p>
<p><code>{% postList &quot;WiP&quot;, collections[&quot;WiP&quot;] %}</code></p>
<p><code>git commit -am &quot;Set up a shortcode for postlist&quot;</code></p>
<p>Ok, now I want to be able to pass the post type I want to list in the Markdown file.</p>
<p>New markdown front matter to make that work:</p>
<pre class="language-yaml"><code class="language-yaml"><span class="token punctuation">---</span><br><span class="token key atrule">layout</span><span class="token punctuation">:</span> index<br><span class="token key atrule">eleventyExcludeFromCollections</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><br><span class="token key atrule">internalPageTypes</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">'home'</span> <span class="token punctuation">]</span><br><span class="token key atrule">postLists</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><br>	<span class="token punctuation">{</span><span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"WiP"</span><span class="token punctuation">,</span> <span class="token key atrule">collection</span><span class="token punctuation">:</span> <span class="token string">"WiP"</span><span class="token punctuation">,</span> <span class="token key atrule">order</span><span class="token punctuation">:</span> <span class="token string">"date"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>	<span class="token punctuation">{</span><span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"Posts"</span><span class="token punctuation">,</span> <span class="token key atrule">collection</span><span class="token punctuation">:</span> <span class="token string">"posts"</span><span class="token punctuation">,</span> <span class="token key atrule">order</span><span class="token punctuation">:</span> <span class="token string">"reverse"</span> <span class="token punctuation">}</span><br>	<span class="token punctuation">]</span><br><span class="token punctuation">---</span></code></pre>
<p>and I'll alter the shortcode to use the new arguments.</p>
<pre class="language-javascript"><code class="language-javascript">	eleventyConfig<span class="token punctuation">.</span><span class="token function">addShortcode</span><span class="token punctuation">(</span><span class="token string">"postList"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">collectionName<span class="token punctuation">,</span> collectionOfPosts<span class="token punctuation">,</span> order</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span>order<span class="token punctuation">)</span><span class="token punctuation">{</span><br>			order <span class="token operator">=</span> <span class="token string">"reverse"</span><br>		<span class="token punctuation">}</span><br>		<span class="token keyword">if</span> <span class="token punctuation">(</span>order <span class="token operator">===</span> <span class="token string">"reverse"</span><span class="token punctuation">)</span><span class="token punctuation">{</span><br>			collectionOfPosts<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>		<span class="token punctuation">}</span><br>		<span class="token keyword">let</span> postList <span class="token operator">=</span> collectionOfPosts<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">post</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>			<span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;li></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>post<span class="token punctuation">.</span>data<span class="token punctuation">.</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/li></span><span class="token template-punctuation string">`</span></span><br>		<span class="token punctuation">}</span><span class="token punctuation">)</span><br>		<span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;p></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>collectionName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/p><br>		&lt;ul><br>			&lt;!-- Collection: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>collectionName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> --><br>			</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>postList<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"><br>		&lt;/ul><br>		</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>and now my <code>index.njk</code> file is reusable for any vertical file I wish to reuse it with.</p>
<pre class="language-liquid"><code class="language-liquid">{<span class="token operator">%</span> extends "base.njk" <span class="token operator">%</span>}<br><br>{<span class="token operator">%</span> block postcontent <span class="token operator">%</span>}<br>	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> post list<span class="token operator">:</span> <span class="token operator">--</span><span class="token operator">></span><br>	{<span class="token operator">%</span><span class="token operator">-</span> <span class="token keyword">for</span> postType <span class="token keyword">in</span> postLists <span class="token operator">%</span>}<br>		{<span class="token operator">%</span> postList postType.name,<br>		collections[postType.collection],<br>		postType.order <span class="token operator">%</span>}<br>	{<span class="token operator">%</span><span class="token operator">-</span> <span class="token keyword">endfor</span> <span class="token operator">%</span>}<br>{<span class="token operator">%</span> endblock <span class="token operator">%</span>}</code></pre>
<p><code>git commit -am &quot;Got shortcode + vertical layout template working&quot;</code></p>

						
					</section>
					<section id="postcontent">
						
					</section>
				</main>
				<footer>
					
	<div id="taglist">
		Tags:&nbsp;posts,projects,Starters,11ty,Node,Sass,Github Actions,WiP,</div>

					
						<p>
							<small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small>
						</p>
					
					
				</footer>
			</div>
			<!--[if !IE]><script>fixScale(document);</script><![endif]-->
		</body>
	</html>
